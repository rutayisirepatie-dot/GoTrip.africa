{"ast":null,"code":"// Go Trip - Complete Professional Tourism System\n(function () {\n  'use strict';\n\n  // ===============================\n  // CONFIGURATION\n  // ===============================\n  const config = {\n    baseUrl: 'http://localhost:3000/api',\n    debug: true,\n    useMockMode: true,\n    endpoints: {\n      newsletter: '/newsletter',\n      contact: '/contact',\n      tripPlan: '/tripPlan',\n      auth: {\n        login: '/auth/login',\n        register: '/auth/register',\n        verify: '/auth/verify'\n      },\n      bookings: {\n        submit: '/bookings',\n        user: '/bookings/user'\n      },\n      guides: '/guides',\n      translators: '/translators',\n      destinations: '/destinations',\n      accommodations: '/accommodations',\n      blog: '/blog',\n      dashboard: {\n        user: '/dashboard/user',\n        admin: '/dashboard/admin',\n        userBookings: '/dashboard/user/bookings',\n        allUsers: '/dashboard/admin/users',\n        allBookings: '/dashboard/admin/bookings',\n        updateProfile: '/dashboard/user/profile',\n        cancelBooking: '/dashboard/bookings'\n      }\n    },\n    prices: {\n      guides: {\n        min: 80,\n        max: 200\n      },\n      translators: {\n        min: 50,\n        max: 150\n      },\n      accommodations: {\n        budget: [50, 150],\n        midrange: [150, 300],\n        luxury: [300, 5000]\n      }\n    }\n  };\n\n  // ===============================\n  // MOCK DATA\n  // ===============================\n  const mockData = {\n    guides: [{\n      _id: 1,\n      name: \"Jean Claude N.\",\n      specialty: \"Gorilla Trekking Expert\",\n      languages: [\"English\", \"French\", \"Kinyarwanda\", \"Swahili\"],\n      experience: \"8 years experience\",\n      rating: 4.9,\n      price: \"$180/day\",\n      dailyRate: 180,\n      image: \"https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?ixlib=rb-4.0.3&auto=format&fit=crop&w=400&q=80\",\n      certifications: [\"RDB Certified\", \"Wildlife First Aid\", \"CPR Certified\"],\n      languageCount: 4,\n      experienceYears: 8,\n      available: true,\n      description: \"Expert guide specializing in gorilla trekking with extensive knowledge of Volcanoes National Park.\"\n    }, {\n      _id: 2,\n      name: \"Marie Aimee K.\",\n      specialty: \"Cultural Tour Guide\",\n      languages: [\"English\", \"Swahili\", \"Kinyarwanda\", \"French\"],\n      experience: \"6 years experience\",\n      rating: 4.8,\n      price: \"$160/day\",\n      dailyRate: 160,\n      image: \"https://images.unsplash.com/photo-1494790108755-2616b612b786?ixlib=rb-4.0.3&auto=format&fit=crop&w=400&q=80\",\n      certifications: [\"Cultural Heritage\", \"Anthropology Degree\", \"RDB Certified\"],\n      languageCount: 4,\n      experienceYears: 6,\n      available: true,\n      description: \"Cultural expert providing deep insights into Rwandan traditions and history.\"\n    }, {\n      _id: 3,\n      name: \"David M.\",\n      specialty: \"Bird Watching Specialist\",\n      languages: [\"English\", \"German\", \"Kinyarwanda\", \"French\"],\n      experience: \"10 years experience\",\n      rating: 4.9,\n      price: \"$200/day\",\n      dailyRate: 200,\n      image: \"https://images.unsplash.com/photo-1500648767791-00dcc994a43e?ixlib=rb-4.0.3&auto=format&fit=crop&w=400&q=80\",\n      certifications: [\"Ornithology Certified\", \"RDB Guide\", \"Photography Expert\"],\n      languageCount: 4,\n      experienceYears: 10,\n      available: true,\n      description: \"Specialized bird watching guide with extensive knowledge of Rwanda's avian species.\"\n    }, {\n      _id: 4,\n      name: \"Sarah T.\",\n      specialty: \"Adventure Hiking Guide\",\n      languages: [\"English\", \"French\", \"Spanish\", \"Kinyarwanda\"],\n      experience: \"7 years experience\",\n      rating: 4.7,\n      price: \"$170/day\",\n      dailyRate: 170,\n      image: \"https://images.unsplash.com/photo-1487412720507-e7ab37603c6f?ixlib=rb-4.0.3&auto=format&fit=crop&w=400&q=80\",\n      certifications: [\"Mountain Guide\", \"Wilderness First Responder\", \"RDB Certified\"],\n      languageCount: 4,\n      experienceYears: 7,\n      available: true,\n      description: \"Experienced hiking guide for mountain trails and adventure tours.\"\n    }, {\n      _id: 5,\n      name: \"Peter K.\",\n      specialty: \"History & Culture Guide\",\n      languages: [\"English\", \"Kinyarwanda\", \"French\"],\n      experience: \"5 years experience\",\n      rating: 4.6,\n      price: \"$140/day\",\n      dailyRate: 140,\n      image: \"https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?ixlib=rb-4.0.3&auto=format&fit=crop&w=400&q=80\",\n      certifications: [\"History Degree\", \"RDB Certified\", \"Cultural Expert\"],\n      languageCount: 3,\n      experienceYears: 5,\n      available: true,\n      description: \"History expert providing comprehensive cultural and historical tours.\"\n    }, {\n      _id: 6,\n      name: \"Grace U.\",\n      specialty: \"Family Tour Specialist\",\n      languages: [\"English\", \"French\", \"Swahili\"],\n      experience: \"4 years experience\",\n      rating: 4.5,\n      price: \"$130/day\",\n      dailyRate: 130,\n      image: \"https://images.unsplash.com/photo-1544725176-7c40e5a71c5e?ixlib=rb-4.0.3&auto=format&fit=crop&w=400&q=80\",\n      certifications: [\"Child Safety Certified\", \"RDB Guide\", \"Family Specialist\"],\n      languageCount: 3,\n      experienceYears: 4,\n      available: true,\n      description: \"Family-friendly guide specializing in tours suitable for all ages.\"\n    }],\n    translators: [{\n      _id: 1,\n      name: \"Patience Rutayisire\",\n      languages: [\"English\", \"German\", \"Spanish\", \"French\", \"Swahili\", \"Chinese\", \"Kinyarwanda\"],\n      specialty: \"Tourism & Business Translation\",\n      rating: 4.9,\n      price: \"$140/day\",\n      dailyRate: 140,\n      image: \"./images/Patie.png\",\n      experience: \"5 years experience\",\n      certifications: [\"Certified Translator\", \"Tourism Diploma\", \"Business Communication\"],\n      languageCount: 7,\n      experienceYears: 5,\n      available: true,\n      description: \"Professional translator specializing in tourism and business communications.\"\n    }, {\n      _id: 2,\n      name: \"Eric M.\",\n      languages: [\"English\", \"German\", \"Chinese\", \"Kinyarwanda\", \"French\"],\n      specialty: \"Medical & Technical Translation\",\n      rating: 4.8,\n      price: \"$150/day\",\n      dailyRate: 150,\n      image: \"https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?ixlib=rb-4.0.3&auto=format&fit=crop&w=400&q=80\",\n      experience: \"8 years experience\",\n      certifications: [\"Medical Translator\", \"Technical Certification\", \"RDB Approved\"],\n      languageCount: 5,\n      experienceYears: 8,\n      available: true,\n      description: \"Specialized in medical and technical translations with government approval.\"\n    }, {\n      _id: 3,\n      name: \"Grace U.\",\n      languages: [\"English\", \"Spanish\", \"Portuguese\", \"Kinyarwanda\", \"French\"],\n      specialty: \"Legal & Government Translation\",\n      rating: 4.7,\n      price: \"$130/day\",\n      dailyRate: 130,\n      image: \"https://images.unsplash.com/photo-1544725176-7c40e5a71c5e?ixlib=rb-4.0.3&auto=format&fit=crop&w=400&q=80\",\n      experience: \"6 years experience\",\n      certifications: [\"Legal Translator\", \"Government Certified\", \"Diplomatic Experience\"],\n      languageCount: 5,\n      experienceYears: 6,\n      available: true,\n      description: \"Expert in legal documents and government communications translation.\"\n    }, {\n      _id: 4,\n      name: \"Robert K.\",\n      languages: [\"English\", \"Arabic\", \"Swahili\", \"Kinyarwanda\", \"French\"],\n      specialty: \"Conference & Event Translation\",\n      rating: 4.8,\n      price: \"$145/day\",\n      dailyRate: 145,\n      image: \"https://images.unsplash.com/photo-1507591064344-4c6ce005-128?ixlib=rb-4.0.3&auto=format&fit=crop&w=400&q=80\",\n      experience: \"7 years experience\",\n      certifications: [\"Conference Interpreter\", \"Event Management\", \"RDB Certified\"],\n      languageCount: 5,\n      experienceYears: 7,\n      available: true,\n      description: \"Specialized in conference interpreting and large event translation services.\"\n    }, {\n      _id: 5,\n      name: \"Alice N.\",\n      languages: [\"English\", \"French\", \"Kinyarwanda\"],\n      specialty: \"General Translation\",\n      rating: 4.6,\n      price: \"$90/day\",\n      dailyRate: 90,\n      image: \"https://images.unsplash.com/photo-1494790108755-2616b612b786?ixlib=rb-4.0.3&auto=format&fit=crop&w=400&q=80\",\n      experience: \"3 years experience\",\n      certifications: [\"Basic Translation\", \"RDB Certified\", \"Tourism Focus\"],\n      languageCount: 3,\n      experienceYears: 3,\n      available: true,\n      description: \"General translator with focus on tourism and everyday communication.\"\n    }, {\n      _id: 6,\n      name: \"Samuel T.\",\n      languages: [\"English\", \"Swahili\", \"Kinyarwanda\", \"French\", \"Spanish\", \"Portuguese\"],\n      specialty: \"Multi-Language Specialist\",\n      rating: 4.9,\n      price: \"$160/day\",\n      dailyRate: 160,\n      image: \"https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?ixlib=rb-4.0.3&auto=format&fit=crop&w=400&q=80\",\n      experience: \"9 years experience\",\n      certifications: [\"Advanced Translator\", \"Language Degree\", \"RDB Certified\"],\n      languageCount: 6,\n      experienceYears: 9,\n      available: true,\n      description: \"Multi-lingual expert translator with extensive international experience.\"\n    }],\n    destinations: [{\n      _id: 1,\n      name: \"Volcanoes National Park\",\n      location: \"Northern Province, Rwanda\",\n      description: \"Home to the endangered mountain gorillas, this UNESCO World Heritage site offers unforgettable gorilla trekking experiences in the Virunga Mountains.\",\n      image: \"./images/mount-bisoke-rwanda.jpg\",\n      features: [\"Gorilla Trekking\", \"Mountain Hiking\", \"Bird Watching\", \"Cultural Villages\"],\n      rating: 4.9,\n      price: \"From $1,500\",\n      basePrice: 1500,\n      duration: \"3-5 days\",\n      bestSeason: [\"June\", \"July\", \"August\", \"September\"]\n    }, {\n      _id: 2,\n      name: \"Lake Kivu\",\n      location: \"Western Province, Rwanda\",\n      description: \"One of Africa's Great Lakes, offering stunning views, water sports, beautiful beaches, and relaxing hot springs along its shores.\",\n      image: \"./images/ruanda-lake-kivu-aussicht.jpg\",\n      features: [\"Beaches\", \"Boating\", \"Swimming\", \"Hot Springs\"],\n      rating: 4.7,\n      price: \"From $300\",\n      basePrice: 300,\n      duration: \"2-3 days\",\n      bestSeason: [\"All year\"]\n    }, {\n      _id: 3,\n      name: \"Nyungwe Forest National Park\",\n      location: \"Southern Province, Rwanda\",\n      description: \"Ancient rainforest with canopy walkway, home to chimpanzees and over 300 bird species. One of Africa's oldest forests.\",\n      image: \"./images/nyungwe-weather.jpg\",\n      features: [\"Canopy Walk\", \"Chimpanzee Tracking\", \"Hiking\", \"Waterfalls\"],\n      rating: 4.8,\n      price: \"From $600\",\n      basePrice: 600,\n      duration: \"2-4 days\",\n      bestSeason: [\"December\", \"January\", \"February\", \"June\", \"July\", \"August\"]\n    }, {\n      _id: 4,\n      name: \"Kigali City\",\n      location: \"Kigali, Rwanda\",\n      description: \"The vibrant capital city known for its cleanliness, safety, and rich cultural experiences including museums, markets, and memorial sites.\",\n      image: \"./images/mount-jali-hike.jpg\",\n      features: [\"City Tours\", \"Cultural Museums\", \"Markets\", \"Nightlife\"],\n      rating: 4.8,\n      price: \"From $100\",\n      basePrice: 100,\n      duration: \"1-3 days\",\n      bestSeason: [\"All year\"]\n    }, {\n      _id: 5,\n      name: \"Akagera National Park\",\n      location: \"Eastern Province, Rwanda\",\n      description: \"Rwanda's only Big Five safari destination, offering game drives, boat safaris, and beautiful landscapes.\",\n      image: \"./images/Akagera-Hippos.jpg\",\n      features: [\"Game Drives\", \"Boat Safaris\", \"Bird Watching\", \"Camping\"],\n      rating: 4.7,\n      price: \"From $700\",\n      basePrice: 700,\n      duration: \"2-3 days\",\n      bestSeason: [\"June\", \"July\", \"August\", \"September\"]\n    }, {\n      _id: 6,\n      name: \"King's Palace Museum\",\n      location: \"Nyanza, Rwanda\",\n      description: \"Traditional royal palace offering insights into Rwanda's pre-colonial history, culture, and monarchy.\",\n      image: \"./images/palace-museum-rwanda.jpg\",\n      features: [\"Cultural History\", \"Traditional Architecture\", \"Royal Grounds\", \"Guided Tours\"],\n      rating: 4.6,\n      price: \"From $200\",\n      basePrice: 200,\n      duration: \"1 day\",\n      bestSeason: [\"All year\"]\n    }],\n    accommodations: [{\n      _id: 1,\n      name: \"Bisate Lodge\",\n      location: \"Volcanoes National Park\",\n      type: \"Luxury Eco-Lodge\",\n      description: \"Award-winning eco-lodge with stunning views of the volcanoes, offering luxury accommodation and direct gorilla trekking access.\",\n      image: \"./images/Bisate-Lodge-Rwanda-Exterior.jpg\",\n      features: [\"Private Villas\", \"Gorilla Views\", \"Spa\", \"Fine Dining\"],\n      price: \"$2,500/night\",\n      dailyRate: 2500,\n      rating: 4.9,\n      category: \"luxury\",\n      capacity: 2,\n      available: true\n    }, {\n      _id: 2,\n      name: \"Lake Kivu Serena Hotel\",\n      location: \"Gisenyi, Lake Kivu\",\n      type: \"5-Star Hotel\",\n      description: \"Luxury resort on the shores of Lake Kivu with private beach, water sports, and panoramic lake views.\",\n      image: \"./images/aeriel-view-serena.jpg\",\n      features: [\"Lake View\", \"Private Beach\", \"Spa\", \"Water Sports\"],\n      price: \"$450/night\",\n      dailyRate: 450,\n      rating: 4.7,\n      category: \"luxury\",\n      capacity: 4,\n      available: true\n    }, {\n      _id: 3,\n      name: \"Kigali Marriott Hotel\",\n      location: \"Kigali City Center\",\n      type: \"Business Hotel\",\n      description: \"Modern luxury hotel in the heart of Kigali, perfect for business travelers and tourists alike.\",\n      image: \"./images/mariot-kigali.png\",\n      features: [\"City Center\", \"Business Center\", \"Pool\", \"Multiple Restaurants\"],\n      price: \"$350/night\",\n      dailyRate: 350,\n      rating: 4.6,\n      category: \"midrange\",\n      capacity: 3,\n      available: true\n    }, {\n      _id: 4,\n      name: \"One&Only Gorilla's Nest\",\n      location: \"Volcanoes National Park\",\n      type: \"Luxury Resort\",\n      description: \"Ultra-luxurious resort offering bespoke gorilla trekking experiences and unparalleled comfort.\",\n      image: \"./images/one-and-only-kinigi.jpg\",\n      features: [\"Butler Service\", \"Private Trekking\", \"Helicopter Transfer\", \"Fine Dining\"],\n      price: \"$3,500/night\",\n      dailyRate: 3500,\n      rating: 4.9,\n      category: \"luxury\",\n      capacity: 2,\n      available: true\n    }, {\n      _id: 5,\n      name: \"One&Only Nyungwe\",\n      location: \"Nyungwe Forest\",\n      type: \"Eco-Lodge\",\n      description: \"Sustainable eco-lodge nestled in the Nyungwe Forest, offering immersive nature experiences.\",\n      image: \"./images/one-only-nyungwe-house.jpg\",\n      features: [\"Forest Views\", \"Bird Watching\", \"Sustainable\", \"Guided Hikes\"],\n      price: \"$280/night\",\n      dailyRate: 280,\n      rating: 4.5,\n      category: \"midrange\",\n      capacity: 2,\n      available: true\n    }, {\n      _id: 6,\n      name: \"Raddison Blu Hotel\",\n      location: \"Kigali\",\n      type: \"4-Star Hotel\",\n      description: \"Contemporary hotel with excellent amenities and convenient city center location.\",\n      image: \"./images/radison-blue.jpg\",\n      features: [\"City Views\", \"Restaurant\", \"Pool\", \"Fitness Center\"],\n      price: \"$220/night\",\n      dailyRate: 220,\n      rating: 4.4,\n      category: \"midrange\",\n      capacity: 2,\n      available: true\n    }],\n    blog: [{\n      _id: 1,\n      title: \"Complete Guide to Gorilla Trekking in Rwanda\",\n      excerpt: \"Everything you need to know about mountain gorilla trekking in Volcanoes National Park, including permits, preparation, and what to expect.\",\n      date: \"May 15, 2024\",\n      category: \"Adventure\",\n      image: \"./images/gorilla-trekk-rwanda.jpg\",\n      readTime: \"8 min read\",\n      author: \"Jean Claude\",\n      content: \"Full article content here...\",\n      tags: [\"Gorilla Trekking\", \"Wildlife\", \"Adventure\", \"Rwanda\"],\n      views: 1250,\n      createdAt: \"2024-05-15T10:00:00.000Z\"\n    }, {\n      _id: 2,\n      title: \"Best Time to Visit Rwanda: Weather & Seasons Guide\",\n      excerpt: \"Planning your trip? Here's when to visit Rwanda for the best wildlife viewing, hiking conditions, and cultural experiences.\",\n      date: \"April 28, 2024\",\n      category: \"Travel Tips\",\n      image: \"https://images.unsplash.com/photo-1469474968028-56623f02e42e?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=80\",\n      readTime: \"6 min read\",\n      author: \"Travel Team\",\n      content: \"Full article content here...\",\n      tags: [\"Travel Tips\", \"Weather\", \"Seasons\", \"Planning\"],\n      views: 980,\n      createdAt: \"2024-04-28T09:30:00.000Z\"\n    }, {\n      _id: 3,\n      title: \"Rwandan Culture: Traditions, Food & Etiquette\",\n      excerpt: \"Discover the rich cultural heritage of Rwanda, from traditional dances and ceremonies to delicious local cuisine.\",\n      date: \"April 15, 2024\",\n      category: \"Culture\",\n      image: \"./images/intore-dancers.jpg\",\n      readTime: \"7 min read\",\n      author: \"Marie Aimee\",\n      content: \"Full article content here...\",\n      tags: [\"Culture\", \"Traditions\", \"Food\", \"Etiquette\"],\n      views: 1120,\n      createdAt: \"2024-04-15T11:15:00.000Z\"\n    }, {\n      _id: 4,\n      title: \"Top 10 Hiking Trails in the Land of a Thousand Hills\",\n      excerpt: \"Explore Rwanda's breathtaking landscapes through these incredible hiking trails suitable for all fitness levels.\",\n      date: \"March 30, 2024\",\n      category: \"Hiking\",\n      image: \"https://images.unsplash.com/photo-1506905925346-21bda4d32df4?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=80\",\n      readTime: \"9 min read\",\n      author: \"Sarah T.\",\n      content: \"Full article content here...\",\n      tags: [\"Hiking\", \"Trails\", \"Outdoors\", \"Adventure\"],\n      views: 890,\n      createdAt: \"2024-03-30T14:20:00.000Z\"\n    }, {\n      _id: 5,\n      title: \"Bird Watching in Rwanda: A Birder's Paradise\",\n      excerpt: \"With over 700 bird species, Rwanda offers incredible bird watching opportunities across its national parks and forests.\",\n      date: \"March 15, 2024\",\n      category: \"Wildlife\",\n      image: \"https://images.unsplash.com/photo-1452570053594-1b985d6ea890?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=80\",\n      readTime: \"5 min read\",\n      author: \"David M.\",\n      content: \"Full article content here...\",\n      tags: [\"Bird Watching\", \"Wildlife\", \"Nature\", \"Photography\"],\n      views: 750,\n      createdAt: \"2024-03-15T13:45:00.000Z\"\n    }, {\n      _id: 6,\n      title: \"Sustainable Tourism in Rwanda: Making a Positive Impact\",\n      excerpt: \"Learn how Rwanda is leading the way in sustainable tourism and how you can travel responsibly in this beautiful country.\",\n      date: \"February 28, 2024\",\n      category: \"Sustainability\",\n      image: \"https://images.unsplash.com/photo-1469474968028-56623f02e42e?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=80\",\n      readTime: \"6 min read\",\n      author: \"Patience R.\",\n      content: \"Full article content here...\",\n      tags: [\"Sustainability\", \"Eco-Tourism\", \"Responsible Travel\", \"Conservation\"],\n      views: 1050,\n      createdAt: \"2024-02-28T16:00:00.000Z\"\n    }]\n  };\n\n  // ===============================\n  // USER MANAGEMENT SYSTEM\n  // ===============================\n  class UserManager {\n    constructor() {\n      this.users = this.loadUsersFromStorage();\n      this.bookings = this.loadBookingsFromStorage();\n      this.tripPlans = this.loadTripPlansFromStorage();\n    }\n    loadUsersFromStorage() {\n      const stored = localStorage.getItem('goTrip_users');\n      if (stored) {\n        return JSON.parse(stored);\n      }\n      return [{\n        _id: 1,\n        name: 'Admin User',\n        email: 'admin@gotrip.africa',\n        password: 'admin123',\n        role: 'admin',\n        phone: '+250 788 100 001',\n        country: 'Rwanda',\n        createdAt: new Date().toISOString(),\n        status: 'active',\n        lastLogin: new Date().toISOString()\n      }, {\n        _id: 2,\n        name: 'Test Customer',\n        email: 'customer@example.com',\n        password: 'customer123',\n        role: 'user',\n        phone: '+250 788 123 456',\n        country: 'USA',\n        createdAt: new Date().toISOString(),\n        status: 'active',\n        lastLogin: new Date().toISOString()\n      }];\n    }\n    loadBookingsFromStorage() {\n      const stored = localStorage.getItem('goTrip_bookings');\n      if (stored) return JSON.parse(stored);\n      return [{\n        _id: 'BOOK-001',\n        userId: 2,\n        serviceType: 'destination',\n        serviceId: 1,\n        serviceName: 'Volcanoes National Park',\n        userEmail: 'customer@example.com',\n        userName: 'Test Customer',\n        date: new Date(Date.now() + 86400000 * 7).toISOString(),\n        endDate: new Date(Date.now() + 86400000 * 9).toISOString(),\n        travelers: 2,\n        duration: 3,\n        status: 'confirmed',\n        totalAmount: 1500,\n        createdAt: new Date().toISOString(),\n        notes: 'Looking forward to gorilla trekking'\n      }, {\n        _id: 'BOOK-002',\n        userId: 2,\n        serviceType: 'guide',\n        serviceId: 1,\n        serviceName: 'Jean Claude N.',\n        userEmail: 'customer@example.com',\n        userName: 'Test Customer',\n        date: new Date(Date.now() + 86400000 * 5).toISOString(),\n        endDate: new Date(Date.now() + 86400000 * 6).toISOString(),\n        travelers: 4,\n        duration: 2,\n        status: 'pending',\n        totalAmount: 360,\n        createdAt: new Date().toISOString(),\n        notes: 'Need a gorilla trekking expert'\n      }];\n    }\n    loadTripPlansFromStorage() {\n      const stored = localStorage.getItem('goTrip_tripPlans');\n      if (stored) return JSON.parse(stored);\n      return [{\n        _id: 'TRIP-001',\n        userId: 2,\n        userName: 'Test Customer',\n        userEmail: 'customer@example.com',\n        startDate: new Date(Date.now() + 86400000 * 14).toISOString(),\n        duration: '6-8 days',\n        travelers: 3,\n        budget: 'midrange',\n        interests: ['gorilla', 'culture', 'hiking'],\n        message: 'Looking for a family adventure with gorilla trekking and cultural experiences',\n        status: 'review',\n        createdAt: new Date().toISOString(),\n        assignedTo: null,\n        itinerary: null\n      }];\n    }\n    saveUsers() {\n      localStorage.setItem('goTrip_users', JSON.stringify(this.users));\n    }\n    saveBookings() {\n      localStorage.setItem('goTrip_bookings', JSON.stringify(this.bookings));\n    }\n    saveTripPlans() {\n      localStorage.setItem('goTrip_tripPlans', JSON.stringify(this.tripPlans));\n    }\n\n    // User methods\n    registerUser(userData) {\n      const existingUser = this.users.find(u => u.email === userData.email);\n      if (existingUser) {\n        throw new Error('User already exists');\n      }\n      const newUser = {\n        _id: Date.now(),\n        ...userData,\n        role: 'user',\n        status: 'active',\n        createdAt: new Date().toISOString(),\n        lastLogin: new Date().toISOString()\n      };\n      this.users.push(newUser);\n      this.saveUsers();\n      return newUser;\n    }\n    authenticateUser(email, password) {\n      const user = this.users.find(u => u.email === email && u.password === password && u.status === 'active');\n      if (user) {\n        user.lastLogin = new Date().toISOString();\n        this.saveUsers();\n        return user;\n      }\n      return null;\n    }\n    updateUser(userId, updates) {\n      const index = this.users.findIndex(u => u._id === userId);\n      if (index !== -1) {\n        this.users[index] = {\n          ...this.users[index],\n          ...updates\n        };\n        this.saveUsers();\n        return this.users[index];\n      }\n      return null;\n    }\n    deleteUser(userId) {\n      this.users = this.users.filter(u => u._id !== userId);\n      this.saveUsers();\n      return true;\n    }\n\n    // Booking methods\n    createBooking(bookingData) {\n      const bookingId = `BOOK-${Date.now().toString().slice(-6)}`;\n      const booking = {\n        _id: bookingId,\n        ...bookingData,\n        createdAt: new Date().toISOString(),\n        status: 'pending'\n      };\n      this.bookings.push(booking);\n      this.saveBookings();\n      return booking;\n    }\n    updateBooking(bookingId, updates) {\n      const index = this.bookings.findIndex(b => b._id === bookingId);\n      if (index !== -1) {\n        this.bookings[index] = {\n          ...this.bookings[index],\n          ...updates\n        };\n        this.saveBookings();\n        return this.bookings[index];\n      }\n      return null;\n    }\n    cancelBooking(bookingId) {\n      return this.updateBooking(bookingId, {\n        status: 'cancelled'\n      });\n    }\n    confirmBooking(bookingId) {\n      return this.updateBooking(bookingId, {\n        status: 'confirmed'\n      });\n    }\n    getUserBookings(userId) {\n      return this.bookings.filter(b => b.userId === userId);\n    }\n\n    // Trip Plan methods\n    createTripPlan(tripData) {\n      const tripId = `TRIP-${Date.now().toString().slice(-6)}`;\n      const trip = {\n        _id: tripId,\n        ...tripData,\n        createdAt: new Date().toISOString(),\n        status: 'review'\n      };\n      this.tripPlans.push(trip);\n      this.saveTripPlans();\n      return trip;\n    }\n    updateTripPlan(tripId, updates) {\n      const index = this.tripPlans.findIndex(t => t._id === tripId);\n      if (index !== -1) {\n        this.tripPlans[index] = {\n          ...this.tripPlans[index],\n          ...updates\n        };\n        this.saveTripPlans();\n        return this.tripPlans[index];\n      }\n      return null;\n    }\n\n    // Analytics methods\n    getStats() {\n      const totalUsers = this.users.length;\n      const totalBookings = this.bookings.length;\n      const activeBookings = this.bookings.filter(b => ['confirmed', 'pending'].includes(b.status)).length;\n      const totalRevenue = this.bookings.filter(b => b.status === 'confirmed').reduce((sum, b) => sum + (b.totalAmount || 0), 0);\n      const pendingTripPlans = this.tripPlans.filter(t => t.status === 'review').length;\n      return {\n        totalUsers,\n        totalBookings,\n        activeBookings,\n        totalRevenue,\n        pendingTripPlans\n      };\n    }\n    getMonthlyRevenue() {\n      const monthlyRevenue = {};\n      const confirmedBookings = this.bookings.filter(b => b.status === 'confirmed');\n      confirmedBookings.forEach(booking => {\n        const date = new Date(booking.createdAt);\n        const monthYear = `${date.getFullYear()}-${String(date.getMonth() + 1).padStart(2, '0')}`;\n        if (!monthlyRevenue[monthYear]) {\n          monthlyRevenue[monthYear] = 0;\n        }\n        monthlyRevenue[monthYear] += booking.totalAmount || 0;\n      });\n      return Object.entries(monthlyRevenue).map(([month, revenue]) => ({\n        month,\n        revenue\n      }));\n    }\n    getRecentActivity() {\n      const allActivities = [...this.users.map(u => ({\n        type: 'user',\n        id: u._id,\n        name: u.name,\n        email: u.email,\n        action: 'registered',\n        timestamp: u.createdAt\n      })), ...this.bookings.map(b => ({\n        type: 'booking',\n        id: b._id,\n        name: b.serviceName,\n        email: b.userEmail,\n        action: b.status,\n        timestamp: b.createdAt\n      })), ...this.tripPlans.map(t => ({\n        type: 'trip_plan',\n        id: t._id,\n        name: t.userName,\n        email: t.userEmail,\n        action: 'requested',\n        timestamp: t.createdAt\n      }))];\n      return allActivities.sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp)).slice(0, 20);\n    }\n  }\n\n  // Initialize User Manager\n  const userManager = new UserManager();\n\n  // ===============================\n  // STATE MANAGEMENT\n  // ===============================\n  let isAuthenticated = false;\n  let currentUser = null;\n  let useMockData = config.useMockMode;\n\n  // ===============================\n  // CORE UTILITIES\n  // ===============================\n\n  // DOM Ready Helper\n  function domReady(callback) {\n    if (document.readyState === 'loading') {\n      document.addEventListener('DOMContentLoaded', callback);\n    } else {\n      callback();\n    }\n  }\n\n  // Validation Functions\n  function validateEmail(email) {\n    const re = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\n    return re.test(email);\n  }\n  function validatePhone(phone) {\n    const re = /^\\+?[\\d\\s\\-\\(\\)]{10,}$/;\n    return re.test(phone);\n  }\n  function validatePassword(password) {\n    return password.length >= 6;\n  }\n\n  // Storage Functions\n  function getAuthToken() {\n    return localStorage.getItem('authToken');\n  }\n  function getUserData() {\n    const userData = localStorage.getItem('userData');\n    return userData ? JSON.parse(userData) : null;\n  }\n  function saveUserData(userData) {\n    localStorage.setItem('userData', JSON.stringify(userData));\n    if (userData.token) {\n      localStorage.setItem('authToken', userData.token);\n    }\n  }\n  function clearUserData() {\n    localStorage.removeItem('authToken');\n    localStorage.removeItem('userData');\n    isAuthenticated = false;\n    currentUser = null;\n  }\n\n  // ===============================\n  // API SERVICE\n  // ===============================\n\n  async function apiRequest(endpoint, options = {}) {\n    const url = `${config.baseUrl}${endpoint}`;\n    const token = getAuthToken();\n    const headers = {\n      'Content-Type': 'application/json',\n      ...options.headers\n    };\n    if (token) {\n      headers['Authorization'] = `Bearer ${token}`;\n    }\n\n    // If using mock mode, simulate response\n    if (useMockData) {\n      return simulateMockResponse(endpoint, options);\n    }\n    try {\n      const controller = new AbortController();\n      const timeoutId = setTimeout(() => controller.abort(), 8000);\n      const response = await fetch(url, {\n        ...options,\n        headers,\n        signal: controller.signal\n      });\n      clearTimeout(timeoutId);\n      if (!response.ok) {\n        const error = await response.json().catch(() => ({}));\n        throw new Error(error.message || `HTTP ${response.status}`);\n      }\n      return await response.json();\n    } catch (error) {\n      console.error('API Error:', error);\n\n      // Fall back to mock data on network error\n      if (!useMockData) {\n        console.log('Falling back to mock data');\n        useMockData = true;\n      }\n      return simulateMockResponse(endpoint, options);\n    }\n  }\n  function simulateMockResponse(endpoint, options) {\n    return new Promise(resolve => {\n      setTimeout(() => {\n        let response = {\n          success: true,\n          data: [],\n          message: 'Mock response'\n        };\n        const method = (options === null || options === void 0 ? void 0 : options.method) || 'GET';\n        const body = options !== null && options !== void 0 && options.body ? JSON.parse(options.body) : {};\n        if (endpoint.includes('/auth')) {\n          if (endpoint.includes('/login') && method === 'POST') {\n            response = {\n              success: true,\n              token: 'mock-jwt-token-' + Date.now(),\n              user: {\n                _id: Date.now(),\n                name: body.email.split('@')[0],\n                email: body.email,\n                role: 'user',\n                phone: '+250 788 123 456',\n                country: 'Rwanda'\n              },\n              message: 'Login successful (demo)'\n            };\n          } else if (endpoint.includes('/register') && method === 'POST') {\n            response = {\n              success: true,\n              token: 'mock-jwt-token-' + Date.now(),\n              user: {\n                _id: Date.now(),\n                name: body.name,\n                email: body.email,\n                role: 'user',\n                phone: body.phone || '+250 788 123 456',\n                country: body.country || 'Rwanda'\n              },\n              message: 'Registration successful (demo)'\n            };\n          } else if (endpoint.includes('/verify')) {\n            const userData = getUserData();\n            response = {\n              success: !!userData,\n              user: userData || null,\n              message: userData ? 'User verified (demo)' : 'Not authenticated'\n            };\n          }\n        } else if (endpoint.includes('/newsletter')) {\n          response = {\n            success: true,\n            data: {\n              email: body.email,\n              subscribed: true\n            },\n            message: 'Subscribed to newsletter (demo)'\n          };\n        } else if (endpoint.includes('/contact')) {\n          response = {\n            success: true,\n            data: {\n              reference: 'CONTACT-' + Date.now(),\n              status: 'received'\n            },\n            message: 'Message received (demo)'\n          };\n        } else if (endpoint.includes('/bookings')) {\n          if (method === 'POST') {\n            response = {\n              success: true,\n              data: {\n                booking_reference: 'BOOK-' + Date.now(),\n                service_name: body.service_name,\n                status: 'confirmed'\n              },\n              message: 'Booking confirmed (demo)'\n            };\n          } else {\n            response = {\n              success: true,\n              data: [{\n                _id: 'mock-1',\n                service_name: 'Gorilla Trekking Tour',\n                booking_reference: 'GT-2024-001',\n                status: 'confirmed',\n                date: new Date().toISOString(),\n                service_type: 'destination'\n              }]\n            };\n          }\n        } else if (endpoint.includes('/tripPlan')) {\n          response = {\n            success: true,\n            data: {\n              trip_reference: 'TRIP-' + Date.now(),\n              status: 'pending'\n            },\n            message: 'Trip plan submitted (demo)'\n          };\n        } else if (endpoint.includes('/guides')) {\n          response = {\n            success: true,\n            data: mockData.guides\n          };\n        } else if (endpoint.includes('/translators')) {\n          response = {\n            success: true,\n            data: mockData.translators\n          };\n        } else if (endpoint.includes('/destinations')) {\n          response = {\n            success: true,\n            data: mockData.destinations\n          };\n        } else if (endpoint.includes('/accommodations')) {\n          response = {\n            success: true,\n            data: mockData.accommodations\n          };\n        } else if (endpoint.includes('/blog')) {\n          response = {\n            success: true,\n            data: mockData.blog\n          };\n        } else if (endpoint.includes('/dashboard')) {\n          if (endpoint.includes('/admin')) {\n            const stats = userManager.getStats();\n            const monthlyRevenue = userManager.getMonthlyRevenue();\n            const recentActivity = userManager.getRecentActivity();\n            const recentUsers = userManager.users.slice(-5).reverse();\n            const recentBookings = userManager.bookings.slice(-5).reverse();\n            response = {\n              success: true,\n              data: {\n                stats,\n                monthlyRevenue,\n                recentActivity,\n                recentUsers,\n                recentBookings\n              }\n            };\n          } else {\n            const userBookings = userManager.getUserBookings(currentUser._id);\n            const userTripPlans = userManager.tripPlans.filter(t => t.userId === currentUser._id);\n            response = {\n              success: true,\n              data: {\n                stats: {\n                  totalBookings: userBookings.length,\n                  upcomingBookings: userBookings.filter(b => ['confirmed', 'pending'].includes(b.status)).length,\n                  completedBookings: userBookings.filter(b => b.status === 'completed').length,\n                  pendingTripPlans: userTripPlans.filter(t => t.status === 'review').length,\n                  totalSpent: [{\n                    total: userBookings.filter(b => b.status === 'confirmed').reduce((sum, b) => sum + (b.totalAmount || 0), 0)\n                  }]\n                },\n                recentBookings: userBookings.slice(-3).reverse(),\n                recentTripPlans: userTripPlans.slice(-2).reverse()\n              }\n            };\n          }\n        }\n        resolve(response);\n      }, 300);\n    });\n  }\n\n  // ===============================\n  // AUTHENTICATION\n  // ===============================\n\n  async function checkAuth() {\n    const token = getAuthToken();\n    if (!token) {\n      updateAuthUI();\n      return false;\n    }\n    try {\n      const result = await apiRequest(config.endpoints.auth.verify);\n      if (result.success && result.user) {\n        isAuthenticated = true;\n        currentUser = result.user;\n        saveUserData(result.user);\n        updateAuthUI(true, result.user);\n        return true;\n      } else {\n        clearUserData();\n        updateAuthUI();\n        return false;\n      }\n    } catch (error) {\n      console.error('Auth check error:', error);\n      updateAuthUI();\n      return false;\n    }\n  }\n  async function login(email, password) {\n    try {\n      const user = userManager.authenticateUser(email, password);\n      if (user) {\n        const {\n          password,\n          ...userWithoutPassword\n        } = user;\n        isAuthenticated = true;\n        currentUser = userWithoutPassword;\n        saveUserData(userWithoutPassword);\n        updateAuthUI(true, userWithoutPassword);\n        showNotification(`âœ… Welcome back, ${user.name}!`, 'success');\n\n        // Redirect to dashboard after login\n        setTimeout(() => {\n          if (user.role === 'admin') {\n            showPage('admin');\n          } else {\n            showPage('dashboard');\n          }\n        }, 1000);\n        return {\n          success: true\n        };\n      } else {\n        throw new Error('Invalid email or password');\n      }\n    } catch (error) {\n      showNotification(`âŒ ${error.message}`, 'error');\n      return {\n        success: false,\n        message: error.message\n      };\n    }\n  }\n  async function register(userData) {\n    try {\n      const newUser = userManager.registerUser(userData);\n\n      // Remove password from user object before storing\n      const {\n        password,\n        ...userWithoutPassword\n      } = newUser;\n      isAuthenticated = true;\n      currentUser = userWithoutPassword;\n      saveUserData(userWithoutPassword);\n      updateAuthUI(true, userWithoutPassword);\n      showNotification('âœ… Registration successful! Welcome to Go Trip!', 'success');\n\n      // Redirect to dashboard after registration\n      setTimeout(() => {\n        showPage('dashboard');\n      }, 1500);\n      return {\n        success: true\n      };\n    } catch (error) {\n      showNotification(`âŒ ${error.message}`, 'error');\n      return {\n        success: false,\n        message: error.message\n      };\n    }\n  }\n  function logout() {\n    clearUserData();\n    updateAuthUI();\n    showNotification('ðŸ‘‹ Logged out successfully', 'info');\n\n    // Redirect to home if on protected pages\n    const currentPage = document.querySelector('.page.active');\n    if (currentPage && (currentPage.id === 'dashboard' || currentPage.id === 'admin')) {\n      showPage('home');\n    }\n  }\n\n  // ===============================\n  // PAGE NAVIGATION SYSTEM\n  // ===============================\n\n  function showPage(pageId, smooth = true) {\n    var _currentUser;\n    console.log('Showing page:', pageId);\n\n    // Authentication checks\n    if ((pageId === 'dashboard' || pageId === 'admin') && !isAuthenticated) {\n      showNotification('Please login to access this page', 'warning');\n      showAuthModal('login');\n      return;\n    }\n    if (pageId === 'admin' && ((_currentUser = currentUser) === null || _currentUser === void 0 ? void 0 : _currentUser.role) !== 'admin') {\n      showNotification('Admin access required', 'error');\n      return;\n    }\n\n    // Hide all pages\n    document.querySelectorAll('.page').forEach(page => {\n      page.classList.remove('active');\n    });\n\n    // Show target page\n    const targetPage = document.getElementById(pageId);\n    if (targetPage) {\n      targetPage.classList.add('active');\n\n      // Update navigation\n      document.querySelectorAll('.nav-link').forEach(link => {\n        link.classList.remove('active');\n        if (link.dataset.page === pageId) {\n          link.classList.add('active');\n        }\n      });\n\n      // Load page content\n      loadPageContent(pageId);\n\n      // Smooth scroll to top\n      if (smooth) {\n        window.scrollTo({\n          top: 0,\n          behavior: 'smooth'\n        });\n      } else {\n        window.scrollTo(0, 0);\n      }\n\n      // Update URL hash\n      if (history.pushState) {\n        history.pushState(null, null, `#${pageId}`);\n      }\n    } else {\n      // Fallback to home\n      showPage('home');\n    }\n  }\n  function loadPageContent(pageId) {\n    console.log('Loading content for:', pageId);\n    switch (pageId) {\n      case 'home':\n        loadHomePage();\n        break;\n      case 'destinations':\n        loadDestinations();\n        break;\n      case 'guides':\n        loadGuides();\n        break;\n      case 'translators':\n        loadTranslators();\n        break;\n      case 'accommodations':\n        loadAccommodations();\n        break;\n      case 'blog':\n        loadBlog();\n        break;\n      case 'dashboard':\n        loadDashboard();\n        break;\n      case 'admin':\n        loadAdminDashboard();\n        break;\n    }\n  }\n\n  // ===============================\n  // ENHANCED DASHBOARD FUNCTIONS\n  // ===============================\n\n  async function loadDashboard() {\n    console.log('Loading enhanced user dashboard...');\n    const dashboard = document.getElementById('dashboard');\n    if (!dashboard) return;\n    if (!isAuthenticated) {\n      showPage('home');\n      showNotification('Please login to access dashboard', 'warning');\n      return;\n    }\n    try {\n      // Get user data\n      const userBookings = userManager.getUserBookings(currentUser._id);\n      const userTripPlans = userManager.tripPlans.filter(t => t.userId === currentUser._id);\n\n      // Calculate user stats\n      const totalBookings = userBookings.length;\n      const upcomingBookings = userBookings.filter(b => ['confirmed', 'pending'].includes(b.status)).length;\n      const completedBookings = userBookings.filter(b => b.status === 'completed').length;\n      const totalSpent = userBookings.filter(b => b.status === 'confirmed').reduce((sum, b) => sum + (b.totalAmount || 0), 0);\n\n      // Render dashboard\n      dashboard.innerHTML = `\n                <div class=\"dashboard\">\n                    <div class=\"dashboard-header\">\n                        <div class=\"container\">\n                            <h1><i class=\"fas fa-tachometer-alt\"></i> Dashboard</h1>\n                            <p>Welcome back, ${currentUser.name}! Manage your travel plans and bookings</p>\n                        </div>\n                    </div>\n                    \n                    <div class=\"container\">\n                        <div class=\"dashboard-grid\">\n                            <div class=\"dashboard-sidebar\">\n                                <div class=\"dashboard-user-profile\">\n                                    <div class=\"dashboard-user-avatar-large\">\n                                        <i class=\"fas fa-user-circle\"></i>\n                                    </div>\n                                    <h3 class=\"dashboard-user-name\">${currentUser.name}</h3>\n                                    <p class=\"dashboard-user-email\">${currentUser.email}</p>\n                                    <p class=\"user-role\"><span class=\"badge badge-${currentUser.role === 'admin' ? 'danger' : 'primary'}\">${currentUser.role.toUpperCase()}</span></p>\n                                    <div class=\"user-stats-mini\">\n                                        <div class=\"stat\">\n                                            <strong>${totalBookings}</strong>\n                                            <span>Bookings</span>\n                                        </div>\n                                        <div class=\"stat\">\n                                            <strong>$${totalSpent}</strong>\n                                            <span>Spent</span>\n                                        </div>\n                                    </div>\n                                </div>\n                                \n                                <ul class=\"dashboard-nav\">\n                                    <li>\n                                        <a href=\"#\" class=\"dashboard-tab-link active\" data-tab=\"overview\">\n                                            <i class=\"fas fa-chart-pie\"></i>\n                                            Overview\n                                        </a>\n                                    </li>\n                                    <li>\n                                        <a href=\"#\" class=\"dashboard-tab-link\" data-tab=\"bookings\">\n                                            <i class=\"fas fa-calendar-check\"></i>\n                                            My Bookings\n                                            <span class=\"nav-badge\">${totalBookings}</span>\n                                        </a>\n                                    </li>\n                                    <li>\n                                        <a href=\"#\" class=\"dashboard-tab-link\" data-tab=\"trip-plans\">\n                                            <i class=\"fas fa-route\"></i>\n                                            Trip Plans\n                                            <span class=\"nav-badge\">${userTripPlans.length}</span>\n                                        </a>\n                                    </li>\n                                    <li>\n                                        <a href=\"#\" class=\"dashboard-tab-link\" data-tab=\"profile\">\n                                            <i class=\"fas fa-user-cog\"></i>\n                                            Profile Settings\n                                        </a>\n                                    </li>\n                                    <li>\n                                        <a href=\"#\" class=\"dashboard-tab-link\" data-tab=\"documents\">\n                                            <i class=\"fas fa-file-alt\"></i>\n                                            Travel Documents\n                                        </a>\n                                    </li>\n                                </ul>\n                                \n                                <div class=\"sidebar-actions\">\n                                    <button class=\"btn btn-primary btn-block mt-3\" id=\"dashboard-new-booking-btn\">\n                                        <i class=\"fas fa-plus\"></i> New Booking\n                                    </button>\n                                    <button class=\"btn btn-outline btn-block mt-2\" id=\"dashboard-plan-trip-btn\">\n                                        <i class=\"fas fa-map-marked-alt\"></i> Plan a Trip\n                                    </button>\n                                </div>\n                            </div>\n                            \n                            <div class=\"dashboard-content\">\n                                <!-- Overview Tab -->\n                                <div id=\"dashboard-overview\" class=\"dashboard-tab-container active\">\n                                    <div class=\"dashboard-stats\">\n                                        <div class=\"dashboard-stat-card\">\n                                            <div class=\"dashboard-stat-icon bookings\">\n                                                <i class=\"fas fa-calendar-alt\"></i>\n                                            </div>\n                                            <div class=\"dashboard-stat-content\">\n                                                <h3>Total Bookings</h3>\n                                                <p class=\"dashboard-stat-number\">${totalBookings}</p>\n                                                <p class=\"dashboard-stat-subtitle\">All-time bookings</p>\n                                            </div>\n                                        </div>\n                                        \n                                        <div class=\"dashboard-stat-card\">\n                                            <div class=\"dashboard-stat-icon pending\">\n                                                <i class=\"fas fa-clock\"></i>\n                                            </div>\n                                            <div class=\"dashboard-stat-content\">\n                                                <h3>Upcoming</h3>\n                                                <p class=\"dashboard-stat-number\">${upcomingBookings}</p>\n                                                <p class=\"dashboard-stat-subtitle\">Active bookings</p>\n                                            </div>\n                                        </div>\n                                        \n                                        <div class=\"dashboard-stat-card\">\n                                            <div class=\"dashboard-stat-icon completed\">\n                                                <i class=\"fas fa-check-circle\"></i>\n                                            </div>\n                                            <div class=\"dashboard-stat-content\">\n                                                <h3>Completed</h3>\n                                                <p class=\"dashboard-stat-number\">${completedBookings}</p>\n                                                <p class=\"dashboard-stat-subtitle\">Past experiences</p>\n                                            </div>\n                                        </div>\n                                        \n                                        <div class=\"dashboard-stat-card\">\n                                            <div class=\"dashboard-stat-icon revenue\">\n                                                <i class=\"fas fa-wallet\"></i>\n                                            </div>\n                                            <div class=\"dashboard-stat-content\">\n                                                <h3>Total Spent</h3>\n                                                <p class=\"dashboard-stat-number\">$${totalSpent}</p>\n                                                <p class=\"dashboard-stat-subtitle\">All transactions</p>\n                                            </div>\n                                        </div>\n                                    </div>\n                                    \n                                    <div class=\"dashboard-section\">\n                                        <div class=\"section-header\">\n                                            <h3><i class=\"fas fa-history\"></i> Recent Bookings</h3>\n                                            <a href=\"#\" class=\"btn-link view-all\" data-tab=\"bookings\">View All</a>\n                                        </div>\n                                        <div id=\"dashboard-recent-bookings\" class=\"dashboard-booking-cards\">\n                                            ${renderRecentBookings(userBookings.slice(0, 3))}\n                                        </div>\n                                    </div>\n                                    \n                                    <div class=\"dashboard-section\">\n                                        <div class=\"section-header\">\n                                            <h3><i class=\"fas fa-route\"></i> Recent Trip Plans</h3>\n                                            <a href=\"#\" class=\"btn-link view-all\" data-tab=\"trip-plans\">View All</a>\n                                        </div>\n                                        <div id=\"dashboard-recent-trip-plans\" class=\"dashboard-booking-cards\">\n                                            ${renderRecentTripPlans(userTripPlans.slice(0, 2))}\n                                        </div>\n                                    </div>\n                                </div>\n                                \n                                <!-- Bookings Tab -->\n                                <div id=\"dashboard-bookings\" class=\"dashboard-tab-container\">\n                                    <div class=\"tab-header\">\n                                        <h2><i class=\"fas fa-calendar-check\"></i> My Bookings</h2>\n                                        <div class=\"tab-filters\">\n                                            <select id=\"dashboard-booking-filter\" class=\"form-select\">\n                                                <option value=\"\">All Status</option>\n                                                <option value=\"pending\">Pending</option>\n                                                <option value=\"confirmed\">Confirmed</option>\n                                                <option value=\"completed\">Completed</option>\n                                                <option value=\"cancelled\">Cancelled</option>\n                                            </select>\n                                            <button class=\"btn btn-primary\" id=\"new-booking-modal-btn\">\n                                                <i class=\"fas fa-plus\"></i> New Booking\n                                            </button>\n                                        </div>\n                                    </div>\n                                    <div class=\"dashboard-section\">\n                                        <div class=\"bookings-table-container\">\n                                            <table class=\"dashboard-table\">\n                                                <thead>\n                                                    <tr>\n                                                        <th>Service</th>\n                                                        <th>Type</th>\n                                                        <th>Date</th>\n                                                        <th>Amount</th>\n                                                        <th>Status</th>\n                                                        <th>Actions</th>\n                                                    </tr>\n                                                </thead>\n                                                <tbody id=\"dashboard-bookings-list\">\n                                                    ${renderBookingsTable(userBookings)}\n                                                </tbody>\n                                            </table>\n                                        </div>\n                                    </div>\n                                </div>\n                                \n                                <!-- Trip Plans Tab -->\n                                <div id=\"dashboard-trip-plans\" class=\"dashboard-tab-container\">\n                                    <div class=\"tab-header\">\n                                        <h2><i class=\"fas fa-route\"></i> My Trip Plans</h2>\n                                        <button class=\"btn btn-primary\" id=\"new-trip-plan-btn\">\n                                            <i class=\"fas fa-plus\"></i> Request New Trip Plan\n                                        </button>\n                                    </div>\n                                    <div class=\"dashboard-section\">\n                                        <div class=\"trip-plans-container\">\n                                            ${renderTripPlans(userTripPlans)}\n                                        </div>\n                                    </div>\n                                </div>\n                                \n                                <!-- Profile Tab -->\n                                <div id=\"dashboard-profile\" class=\"dashboard-tab-container\">\n                                    <div class=\"tab-header\">\n                                        <h2><i class=\"fas fa-user-cog\"></i> Profile Settings</h2>\n                                    </div>\n                                    <div class=\"dashboard-section\">\n                                        <form id=\"dashboard-profile-form\" class=\"dashboard-form-grid\">\n                                            <div class=\"dashboard-form-group\">\n                                                <label><i class=\"fas fa-user\"></i> Full Name</label>\n                                                <input type=\"text\" name=\"name\" value=\"${currentUser.name}\" required>\n                                            </div>\n                                            \n                                            <div class=\"dashboard-form-group\">\n                                                <label><i class=\"fas fa-envelope\"></i> Email</label>\n                                                <input type=\"email\" value=\"${currentUser.email}\" disabled>\n                                                <small class=\"text-muted\">Contact support to change email</small>\n                                            </div>\n                                            \n                                            <div class=\"dashboard-form-group\">\n                                                <label><i class=\"fas fa-phone\"></i> Phone Number</label>\n                                                <input type=\"tel\" name=\"phone\" value=\"${currentUser.phone || ''}\" required>\n                                            </div>\n                                            \n                                            <div class=\"dashboard-form-group\">\n                                                <label><i class=\"fas fa-globe\"></i> Country</label>\n                                                <input type=\"text\" name=\"country\" value=\"${currentUser.country || ''}\" required>\n                                            </div>\n                                            \n                                            <div class=\"dashboard-form-group full-width\">\n                                                <label><i class=\"fas fa-home\"></i> Address</label>\n                                                <textarea name=\"address\" rows=\"2\">${currentUser.address || ''}</textarea>\n                                            </div>\n                                            \n                                            <div class=\"dashboard-form-group\">\n                                                <label><i class=\"fas fa-birthday-cake\"></i> Date of Birth</label>\n                                                <input type=\"date\" name=\"dob\" value=\"${currentUser.dob || ''}\">\n                                            </div>\n                                            \n                                            <div class=\"dashboard-form-group\">\n                                                <label><i class=\"fas fa-passport\"></i> Passport Number</label>\n                                                <input type=\"text\" name=\"passport\" value=\"${currentUser.passport || ''}\">\n                                            </div>\n                                            \n                                            <div class=\"dashboard-form-group full-width\">\n                                                <label><i class=\"fas fa-heart\"></i> Travel Preferences</label>\n                                                <textarea name=\"preferences\" rows=\"3\" placeholder=\"Any specific preferences, dietary requirements, or special needs...\">${currentUser.preferences || ''}</textarea>\n                                            </div>\n                                            \n                                            <div class=\"form-actions\">\n                                                <button type=\"submit\" class=\"btn btn-primary\">\n                                                    <i class=\"fas fa-save\"></i> Update Profile\n                                                </button>\n                                                <button type=\"button\" class=\"btn btn-outline\" id=\"change-password-btn\">\n                                                    <i class=\"fas fa-key\"></i> Change Password\n                                                </button>\n                                            </div>\n                                        </form>\n                                    </div>\n                                </div>\n                                \n                                <!-- Documents Tab -->\n                                <div id=\"dashboard-documents\" class=\"dashboard-tab-container\">\n                                    <div class=\"tab-header\">\n                                        <h2><i class=\"fas fa-file-alt\"></i> Travel Documents</h2>\n                                        <button class=\"btn btn-primary\" id=\"upload-document-btn\">\n                                            <i class=\"fas fa-upload\"></i> Upload Document\n                                        </button>\n                                    </div>\n                                    <div class=\"dashboard-section\">\n                                        <div class=\"documents-container\">\n                                            <div class=\"document-cards\">\n                                                <div class=\"document-card\">\n                                                    <div class=\"document-icon\">\n                                                        <i class=\"fas fa-passport\"></i>\n                                                    </div>\n                                                    <div class=\"document-content\">\n                                                        <h4>Passport</h4>\n                                                        <p>Upload your passport copy for visa processing</p>\n                                                        <div class=\"document-actions\">\n                                                            <button class=\"btn btn-sm btn-outline\">\n                                                                <i class=\"fas fa-upload\"></i> Upload\n                                                            </button>\n                                                            <button class=\"btn btn-sm btn-outline\" disabled>\n                                                                <i class=\"fas fa-eye\"></i> View\n                                                            </button>\n                                                        </div>\n                                                    </div>\n                                                </div>\n                                                \n                                                <div class=\"document-card\">\n                                                    <div class=\"document-icon\">\n                                                        <i class=\"fas fa-plane\"></i>\n                                                    </div>\n                                                    <div class=\"document-content\">\n                                                        <h4>Flight Tickets</h4>\n                                                        <p>Upload flight itinerary or e-tickets</p>\n                                                        <div class=\"document-actions\">\n                                                            <button class=\"btn btn-sm btn-outline\">\n                                                                <i class=\"fas fa-upload\"></i> Upload\n                                                            </button>\n                                                        </div>\n                                                    </div>\n                                                </div>\n                                                \n                                                <div class=\"document-card\">\n                                                    <div class=\"document-icon\">\n                                                        <i class=\"fas fa-file-medical\"></i>\n                                                    </div>\n                                                    <div class=\"document-content\">\n                                                        <h4>Medical Insurance</h4>\n                                                        <p>Travel medical insurance documents</p>\n                                                        <div class=\"document-actions\">\n                                                            <button class=\"btn btn-sm btn-outline\">\n                                                                <i class=\"fas fa-upload\"></i> Upload\n                                                            </button>\n                                                        </div>\n                                                    </div>\n                                                </div>\n                                            </div>\n                                        </div>\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            `;\n\n      // Setup dashboard event listeners\n      setupEnhancedDashboardListeners();\n    } catch (error) {\n      console.error('Error loading dashboard:', error);\n      dashboard.innerHTML = `\n                <div class=\"container\">\n                    <div class=\"error-state\">\n                        <i class=\"fas fa-exclamation-triangle fa-3x\"></i>\n                        <h3>Error loading dashboard</h3>\n                        <p>${error.message}</p>\n                        <button class=\"btn btn-primary\" onclick=\"location.reload()\">\n                            <i class=\"fas fa-redo\"></i> Retry\n                        </button>\n                    </div>\n                </div>\n            `;\n    }\n  }\n  function renderRecentBookings(bookings) {\n    if (bookings.length === 0) {\n      return `\n                <div class=\"dashboard-empty-state\">\n                    <i class=\"fas fa-calendar-times\"></i>\n                    <p>No recent bookings</p>\n                    <button class=\"btn btn-sm btn-outline\" onclick=\"showServiceSelectionModal()\">\n                        Book Your First Trip\n                    </button>\n                </div>\n            `;\n    }\n    return bookings.map(booking => `\n            <div class=\"dashboard-booking-card\">\n                <div class=\"dashboard-booking-header\">\n                    <div class=\"booking-service-type\">\n                        <span class=\"service-badge service-${booking.serviceType}\">\n                            ${booking.serviceType}\n                        </span>\n                    </div>\n                    <span class=\"dashboard-booking-status dashboard-status-${booking.status}\">\n                        ${booking.status.toUpperCase()}\n                    </span>\n                </div>\n                \n                <h4 class=\"dashboard-booking-title\">${booking.serviceName}</h4>\n                \n                <div class=\"dashboard-booking-details\">\n                    <p><i class=\"far fa-calendar\"></i> ${new Date(booking.date).toLocaleDateString()}</p>\n                    <p><i class=\"fas fa-users\"></i> ${booking.travelers} travelers</p>\n                    <p><i class=\"fas fa-hashtag\"></i> ${booking._id}</p>\n                </div>\n                \n                <div class=\"dashboard-booking-footer\">\n                    <div class=\"booking-amount\">\n                        <strong>$${booking.totalAmount || '0'}</strong>\n                    </div>\n                    <div class=\"dashboard-booking-actions\">\n                        <button class=\"btn btn-sm btn-outline\" onclick=\"viewBookingDetails('${booking._id}')\">\n                            <i class=\"fas fa-eye\"></i>\n                        </button>\n                        ${booking.status === 'pending' ? `\n                            <button class=\"btn btn-sm btn-danger\" onclick=\"cancelBooking('${booking._id}')\">\n                                <i class=\"fas fa-times\"></i>\n                            </button>\n                        ` : ''}\n                    </div>\n                </div>\n            </div>\n        `).join('');\n  }\n  function renderBookingsTable(bookings) {\n    if (bookings.length === 0) {\n      return `\n                <tr>\n                    <td colspan=\"6\" class=\"text-center\">\n                        <div class=\"empty-table-state\">\n                            <i class=\"fas fa-calendar-times fa-2x\"></i>\n                            <p>No bookings yet</p>\n                            <button class=\"btn btn-primary\" onclick=\"showServiceSelectionModal()\">\n                                Book Your First Trip\n                            </button>\n                        </div>\n                    </td>\n                </tr>\n            `;\n    }\n    return bookings.map(booking => `\n            <tr>\n                <td>\n                    <div class=\"service-cell\">\n                        <div class=\"service-icon-small service-${booking.serviceType}\">\n                            <i class=\"fas fa-${getServiceIcon(booking.serviceType)}\"></i>\n                        </div>\n                        <div>\n                            <strong>${booking.serviceName}</strong>\n                            <small>${booking._id}</small>\n                        </div>\n                    </div>\n                </td>\n                <td>\n                    <span class=\"badge badge-service\">${booking.serviceType}</span>\n                </td>\n                <td>\n                    ${new Date(booking.date).toLocaleDateString()}<br>\n                    <small>${booking.duration || 1} days</small>\n                </td>\n                <td>\n                    <strong>$${booking.totalAmount || '0'}</strong>\n                </td>\n                <td>\n                    <span class=\"badge badge-${booking.status}\">\n                        ${booking.status.toUpperCase()}\n                    </span>\n                </td>\n                <td>\n                    <div class=\"table-actions\">\n                        <button class=\"btn-action btn-view\" onclick=\"viewBookingDetails('${booking._id}')\">\n                            <i class=\"fas fa-eye\"></i>\n                        </button>\n                        ${booking.status === 'pending' ? `\n                            <button class=\"btn-action btn-edit\" onclick=\"editBooking('${booking._id}')\">\n                                <i class=\"fas fa-edit\"></i>\n                            </button>\n                            <button class=\"btn-action btn-cancel\" onclick=\"cancelBooking('${booking._id}')\">\n                                <i class=\"fas fa-times\"></i>\n                            </button>\n                        ` : ''}\n                        <button class=\"btn-action btn-download\" onclick=\"downloadBookingInvoice('${booking._id}')\">\n                            <i class=\"fas fa-download\"></i>\n                        </button>\n                    </div>\n                </td>\n            </tr>\n        `).join('');\n  }\n  function renderRecentTripPlans(tripPlans) {\n    if (tripPlans.length === 0) {\n      return `\n                <div class=\"dashboard-empty-state\">\n                    <i class=\"fas fa-route\"></i>\n                    <p>No trip plans yet</p>\n                    <button class=\"btn btn-sm btn-outline\" onclick=\"showTripPlanModal()\">\n                        Plan Your First Trip\n                    </button>\n                </div>\n            `;\n    }\n    return tripPlans.map(trip => `\n            <div class=\"dashboard-booking-card\">\n                <div class=\"dashboard-booking-header\">\n                    <div class=\"booking-service-type\">\n                        <span class=\"service-badge service-trip\">\n                            <i class=\"fas fa-route\"></i> TRIP PLAN\n                        </span>\n                    </div>\n                    <span class=\"dashboard-booking-status dashboard-status-${trip.status}\">\n                        ${trip.status.toUpperCase()}\n                    </span>\n                </div>\n                \n                <h4 class=\"dashboard-booking-title\">${trip.duration} Trip</h4>\n                \n                <div class=\"dashboard-booking-details\">\n                    <p><i class=\"far fa-calendar\"></i> Start: ${new Date(trip.startDate).toLocaleDateString()}</p>\n                    <p><i class=\"fas fa-users\"></i> ${trip.travelers} travelers</p>\n                    <p><i class=\"fas fa-wallet\"></i> Budget: ${trip.budget}</p>\n                </div>\n                \n                <div class=\"trip-interests\">\n                    ${trip.interests && trip.interests.length > 0 ? trip.interests.map(interest => `\n                            <span class=\"interest-tag\">${interest}</span>\n                        `).join('') : '<small>No specific interests</small>'}\n                </div>\n                \n                <div class=\"dashboard-booking-footer\">\n                    <div class=\"trip-plan-date\">\n                        <small>Requested: ${new Date(trip.createdAt).toLocaleDateString()}</small>\n                    </div>\n                    <div class=\"dashboard-booking-actions\">\n                        <button class=\"btn btn-sm btn-outline\" onclick=\"viewTripPlan('${trip._id}')\">\n                            View Details\n                        </button>\n                    </div>\n                </div>\n            </div>\n        `).join('');\n  }\n  function renderTripPlans(tripPlans) {\n    if (tripPlans.length === 0) {\n      return `\n                <div class=\"empty-state\">\n                    <div class=\"empty-state-icon\">\n                        <i class=\"fas fa-route fa-3x\"></i>\n                    </div>\n                    <h3>No Trip Plans Yet</h3>\n                    <p>Start planning your perfect Rwanda adventure</p>\n                    <button class=\"btn btn-primary\" onclick=\"showTripPlanModal()\">\n                        <i class=\"fas fa-plus\"></i> Request Trip Plan\n                    </button>\n                </div>\n            `;\n    }\n    return tripPlans.map(trip => `\n            <div class=\"trip-plan-card\">\n                <div class=\"trip-plan-header\">\n                    <div class=\"trip-plan-id\">\n                        <h4>${trip._id}</h4>\n                        <span class=\"badge badge-${trip.status}\">${trip.status}</span>\n                    </div>\n                    <div class=\"trip-plan-date\">\n                        <small>Requested: ${new Date(trip.createdAt).toLocaleDateString()}</small>\n                    </div>\n                </div>\n                \n                <div class=\"trip-plan-details\">\n                    <div class=\"detail-row\">\n                        <div class=\"detail-item\">\n                            <i class=\"fas fa-calendar\"></i>\n                            <div>\n                                <label>Start Date</label>\n                                <p>${new Date(trip.startDate).toLocaleDateString()}</p>\n                            </div>\n                        </div>\n                        <div class=\"detail-item\">\n                            <i class=\"fas fa-clock\"></i>\n                            <div>\n                                <label>Duration</label>\n                                <p>${trip.duration}</p>\n                            </div>\n                        </div>\n                        <div class=\"detail-item\">\n                            <i class=\"fas fa-users\"></i>\n                            <div>\n                                <label>Travelers</label>\n                                <p>${trip.travelers} people</p>\n                            </div>\n                        </div>\n                        <div class=\"detail-item\">\n                            <i class=\"fas fa-wallet\"></i>\n                            <div>\n                                <label>Budget</label>\n                                <p>${trip.budget}</p>\n                            </div>\n                        </div>\n                    </div>\n                    \n                    ${trip.interests && trip.interests.length > 0 ? `\n                        <div class=\"detail-row\">\n                            <div class=\"detail-item full-width\">\n                                <i class=\"fas fa-heart\"></i>\n                                <div>\n                                    <label>Interests</label>\n                                    <div class=\"interests-container\">\n                                        ${trip.interests.map(interest => `\n                                            <span class=\"interest-tag\">${interest}</span>\n                                        `).join('')}\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                    ` : ''}\n                    \n                    ${trip.message ? `\n                        <div class=\"detail-row\">\n                            <div class=\"detail-item full-width\">\n                                <i class=\"fas fa-comment\"></i>\n                                <div>\n                                    <label>Notes</label>\n                                    <p>${trip.message}</p>\n                                </div>\n                            </div>\n                        </div>\n                    ` : ''}\n                    \n                    ${trip.itinerary ? `\n                        <div class=\"detail-row\">\n                            <div class=\"detail-item full-width\">\n                                <i class=\"fas fa-map\"></i>\n                                <div>\n                                    <label>Itinerary</label>\n                                    <div class=\"itinerary-container\">\n                                        ${renderItinerary(trip.itinerary)}\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                    ` : ''}\n                </div>\n                \n                <div class=\"trip-plan-footer\">\n                    <div class=\"trip-plan-actions\">\n                        ${trip.status === 'review' ? `\n                            <button class=\"btn btn-sm btn-outline\" onclick=\"editTripPlan('${trip._id}')\">\n                                <i class=\"fas fa-edit\"></i> Edit\n                            </button>\n                            <button class=\"btn btn-sm btn-danger\" onclick=\"cancelTripPlan('${trip._id}')\">\n                                <i class=\"fas fa-times\"></i> Cancel\n                            </button>\n                        ` : ''}\n                        \n                        ${trip.itinerary ? `\n                            <button class=\"btn btn-sm btn-primary\" onclick=\"downloadItinerary('${trip._id}')\">\n                                <i class=\"fas fa-download\"></i> Download Itinerary\n                            </button>\n                        ` : `\n                            <button class=\"btn btn-sm btn-outline\" disabled>\n                                <i class=\"fas fa-clock\"></i> Processing...\n                            </button>\n                        `}\n                    </div>\n                </div>\n            </div>\n        `).join('');\n  }\n  function renderItinerary(itinerary) {\n    if (!itinerary || !itinerary.days) return '<p>No itinerary available</p>';\n    return itinerary.days.map(day => `\n            <div class=\"itinerary-day\">\n                <h5>Day ${day.day}: ${day.title}</h5>\n                <div class=\"itinerary-activities\">\n                    ${day.activities.map(activity => `\n                        <div class=\"itinerary-activity\">\n                            <i class=\"fas fa-${activity.icon || 'map-marker-alt'}\"></i>\n                            <div>\n                                <strong>${activity.time}</strong>\n                                <p>${activity.description}</p>\n                                ${activity.location ? `<small><i class=\"fas fa-map-pin\"></i> ${activity.location}</small>` : ''}\n                            </div>\n                        </div>\n                    `).join('')}\n                </div>\n            </div>\n        `).join('');\n  }\n  function getServiceIcon(serviceType) {\n    const icons = {\n      'destination': 'map-marked-alt',\n      'guide': 'user-tie',\n      'translator': 'language',\n      'accommodation': 'hotel',\n      'trip': 'route'\n    };\n    return icons[serviceType] || 'question-circle';\n  }\n  function setupEnhancedDashboardListeners() {\n    var _document$getElementB, _document$getElementB2, _document$getElementB3, _document$getElementB4, _document$getElementB5, _document$getElementB6;\n    // Tab switching\n    document.querySelectorAll('.dashboard-tab-link').forEach(link => {\n      link.addEventListener('click', function (e) {\n        e.preventDefault();\n\n        // Remove active class from all tabs\n        document.querySelectorAll('.dashboard-tab-link').forEach(l => l.classList.remove('active'));\n        document.querySelectorAll('.dashboard-tab-container').forEach(c => c.classList.remove('active'));\n\n        // Add active class to clicked tab\n        this.classList.add('active');\n        const tabId = 'dashboard-' + this.dataset.tab;\n        const tabElement = document.getElementById(tabId);\n        if (tabElement) {\n          tabElement.classList.add('active');\n        }\n      });\n    });\n\n    // New booking button\n    (_document$getElementB = document.getElementById('dashboard-new-booking-btn')) === null || _document$getElementB === void 0 ? void 0 : _document$getElementB.addEventListener('click', () => {\n      showServiceSelectionModal();\n    });\n\n    // Plan trip button\n    (_document$getElementB2 = document.getElementById('dashboard-plan-trip-btn')) === null || _document$getElementB2 === void 0 ? void 0 : _document$getElementB2.addEventListener('click', () => {\n      showTripPlanModal();\n    });\n\n    // New booking modal button\n    (_document$getElementB3 = document.getElementById('new-booking-modal-btn')) === null || _document$getElementB3 === void 0 ? void 0 : _document$getElementB3.addEventListener('click', () => {\n      showServiceSelectionModal();\n    });\n\n    // New trip plan button\n    (_document$getElementB4 = document.getElementById('new-trip-plan-btn')) === null || _document$getElementB4 === void 0 ? void 0 : _document$getElementB4.addEventListener('click', () => {\n      showTripPlanModal();\n    });\n\n    // Change password button\n    (_document$getElementB5 = document.getElementById('change-password-btn')) === null || _document$getElementB5 === void 0 ? void 0 : _document$getElementB5.addEventListener('click', () => {\n      showChangePasswordModal();\n    });\n\n    // Upload document button\n    (_document$getElementB6 = document.getElementById('upload-document-btn')) === null || _document$getElementB6 === void 0 ? void 0 : _document$getElementB6.addEventListener('click', () => {\n      showUploadDocumentModal();\n    });\n\n    // Booking filter\n    const bookingFilter = document.getElementById('dashboard-booking-filter');\n    if (bookingFilter) {\n      bookingFilter.addEventListener('change', function (e) {\n        filterBookings(this.value);\n      });\n    }\n\n    // Profile form submission\n    const profileForm = document.getElementById('dashboard-profile-form');\n    if (profileForm) {\n      profileForm.addEventListener('submit', async function (e) {\n        e.preventDefault();\n        const formData = new FormData(this);\n        const data = Object.fromEntries(formData.entries());\n        try {\n          const updatedUser = userManager.updateUser(currentUser._id, data);\n          if (updatedUser) {\n            currentUser = updatedUser;\n            saveUserData(currentUser);\n            showNotification('âœ… Profile updated successfully!', 'success');\n            setTimeout(() => {\n              loadDashboard();\n            }, 1000);\n          }\n        } catch (error) {\n          showNotification('âŒ Error updating profile', 'error');\n        }\n      });\n    }\n  }\n\n  // ===============================\n  // ADMIN DASHBOARD FUNCTIONS\n  // ===============================\n\n  async function loadAdminDashboard() {\n    var _currentUser2;\n    console.log('Loading admin dashboard...');\n\n    // Check admin access\n    if (!isAuthenticated || ((_currentUser2 = currentUser) === null || _currentUser2 === void 0 ? void 0 : _currentUser2.role) !== 'admin') {\n      showNotification('Admin access required', 'error');\n      showPage('home');\n      return;\n    }\n    const admin = document.getElementById('admin');\n    if (!admin) return;\n    try {\n      const stats = userManager.getStats();\n      const monthlyRevenue = userManager.getMonthlyRevenue();\n      const recentActivity = userManager.getRecentActivity();\n      const recentBookings = userManager.bookings.slice(-5).reverse();\n      const recentUsers = userManager.users.slice(-5).reverse();\n      admin.innerHTML = `\n                <div class=\"admin-dashboard\">\n                    <div class=\"dashboard-header\">\n                        <div class=\"container\">\n                            <h1><i class=\"fas fa-crown\"></i> Admin Dashboard</h1>\n                            <p>System administration and management panel</p>\n                        </div>\n                    </div>\n                    \n                    <div class=\"container\">\n                        <div class=\"admin-controls\">\n                            <div class=\"admin-search\">\n                                <input type=\"text\" placeholder=\"Search users, bookings, trips...\" id=\"admin-search-input\">\n                                <button class=\"btn btn-primary\">\n                                    <i class=\"fas fa-search\"></i>\n                                </button>\n                            </div>\n                            <div class=\"admin-actions\">\n                                <button class=\"btn btn-success\" id=\"add-user-btn\">\n                                    <i class=\"fas fa-user-plus\"></i> Add User\n                                </button>\n                                <button class=\"btn btn-primary\" id=\"generate-report-btn\">\n                                    <i class=\"fas fa-file-export\"></i> Generate Report\n                                </button>\n                            </div>\n                        </div>\n                        \n                        <div class=\"dashboard-stats\">\n                            <div class=\"dashboard-stat-card admin-stat\">\n                                <div class=\"dashboard-stat-icon users\">\n                                    <i class=\"fas fa-users\"></i>\n                                </div>\n                                <div class=\"dashboard-stat-content\">\n                                    <h3>Total Users</h3>\n                                    <p class=\"dashboard-stat-number\">${stats.totalUsers}</p>\n                                    <p class=\"dashboard-stat-subtitle\">\n                                        <span class=\"stat-change positive\">+2 this week</span>\n                                    </p>\n                                </div>\n                            </div>\n                            \n                            <div class=\"dashboard-stat-card admin-stat\">\n                                <div class=\"dashboard-stat-icon bookings\">\n                                    <i class=\"fas fa-calendar-alt\"></i>\n                                </div>\n                                <div class=\"dashboard-stat-content\">\n                                    <h3>Total Bookings</h3>\n                                    <p class=\"dashboard-stat-number\">${stats.totalBookings}</p>\n                                    <p class=\"dashboard-stat-subtitle\">\n                                        <span class=\"stat-change positive\">+5 this month</span>\n                                    </p>\n                                </div>\n                            </div>\n                            \n                            <div class=\"dashboard-stat-card admin-stat\">\n                                <div class=\"dashboard-stat-icon revenue\">\n                                    <i class=\"fas fa-dollar-sign\"></i>\n                                </div>\n                                <div class=\"dashboard-stat-content\">\n                                    <h3>Total Revenue</h3>\n                                    <p class=\"dashboard-stat-number\">$${stats.totalRevenue.toLocaleString()}</p>\n                                    <p class=\"dashboard-stat-subtitle\">\n                                        <span class=\"stat-change positive\">+15% this month</span>\n                                    </p>\n                                </div>\n                            </div>\n                            \n                            <div class=\"dashboard-stat-card admin-stat\">\n                                <div class=\"dashboard-stat-icon pending\">\n                                    <i class=\"fas fa-clock\"></i>\n                                </div>\n                                <div class=\"dashboard-stat-content\">\n                                    <h3>Active Bookings</h3>\n                                    <p class=\"dashboard-stat-number\">${stats.activeBookings}</p>\n                                    <p class=\"dashboard-stat-subtitle\">\n                                        ${stats.pendingTripPlans} pending trips\n                                    </p>\n                                </div>\n                            </div>\n                        </div>\n                        \n                        <div class=\"admin-grid\">\n                            <div class=\"admin-column\">\n                                <div class=\"admin-widget\">\n                                    <div class=\"widget-header\">\n                                        <h3><i class=\"fas fa-chart-line\"></i> Revenue Overview</h3>\n                                        <select class=\"form-select-sm\" id=\"revenue-period\">\n                                            <option value=\"monthly\">Monthly</option>\n                                            <option value=\"weekly\">Weekly</option>\n                                            <option value=\"yearly\">Yearly</option>\n                                        </select>\n                                    </div>\n                                    <div class=\"widget-body\">\n                                        <div class=\"revenue-chart\">\n                                            ${renderRevenueChart(monthlyRevenue)}\n                                        </div>\n                                    </div>\n                                </div>\n                                \n                                <div class=\"admin-widget\">\n                                    <div class=\"widget-header\">\n                                        <h3><i class=\"fas fa-bell\"></i> Recent Activity</h3>\n                                        <button class=\"btn-link\" id=\"view-all-activity\">View All</button>\n                                    </div>\n                                    <div class=\"widget-body\">\n                                        <div class=\"activity-list\">\n                                            ${renderRecentActivity(recentActivity)}\n                                        </div>\n                                    </div>\n                                </div>\n                            </div>\n                            \n                            <div class=\"admin-column\">\n                                <div class=\"admin-widget\">\n                                    <div class=\"widget-header\">\n                                        <h3><i class=\"fas fa-users\"></i> Recent Users</h3>\n                                        <button class=\"btn-link\" id=\"view-all-users\">View All</button>\n                                    </div>\n                                    <div class=\"widget-body\">\n                                        <div class=\"users-list\">\n                                            ${renderRecentUsers(recentUsers)}\n                                        </div>\n                                    </div>\n                                </div>\n                                \n                                <div class=\"admin-widget\">\n                                    <div class=\"widget-header\">\n                                        <h3><i class=\"fas fa-calendar-check\"></i> Recent Bookings</h3>\n                                        <button class=\"btn-link\" id=\"view-all-bookings\">View All</button>\n                                    </div>\n                                    <div class=\"widget-body\">\n                                        <div class=\"bookings-list\">\n                                            ${renderAdminRecentBookings(recentBookings)}\n                                        </div>\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                        \n                        <!-- Tabs for detailed management -->\n                        <div class=\"admin-tabs\">\n                            <nav class=\"admin-tab-nav\">\n                                <button class=\"admin-tab-link active\" data-tab=\"users-management\">\n                                    <i class=\"fas fa-users-cog\"></i> Users Management\n                                </button>\n                                <button class=\"admin-tab-link\" data-tab=\"bookings-management\">\n                                    <i class=\"fas fa-calendar-check\"></i> Bookings Management\n                                </button>\n                                <button class=\"admin-tab-link\" data-tab=\"trip-plans-management\">\n                                    <i class=\"fas fa-route\"></i> Trip Plans Management\n                                </button>\n                                <button class=\"admin-tab-link\" data-tab=\"services-management\">\n                                    <i class=\"fas fa-concierge-bell\"></i> Services Management\n                                </button>\n                                <button class=\"admin-tab-link\" data-tab=\"reports\">\n                                    <i class=\"fas fa-chart-bar\"></i> Reports\n                                </button>\n                            </nav>\n                            \n                            <div class=\"admin-tab-content\">\n                                <!-- Users Management Tab -->\n                                <div id=\"users-management\" class=\"admin-tab-pane active\">\n                                    <div class=\"admin-table-container\">\n                                        <div class=\"table-header\">\n                                            <h3>Users Management</h3>\n                                            <div class=\"table-actions\">\n                                                <button class=\"btn btn-sm btn-success\" id=\"add-new-user-btn\">\n                                                    <i class=\"fas fa-plus\"></i> Add User\n                                                </button>\n                                                <button class=\"btn btn-sm btn-outline\" id=\"export-users-btn\">\n                                                    <i class=\"fas fa-download\"></i> Export\n                                                </button>\n                                            </div>\n                                        </div>\n                                        <div class=\"table-responsive\">\n                                            <table class=\"admin-table\">\n                                                <thead>\n                                                    <tr>\n                                                        <th>User</th>\n                                                        <th>Email</th>\n                                                        <th>Role</th>\n                                                        <th>Status</th>\n                                                        <th>Joined</th>\n                                                        <th>Actions</th>\n                                                    </tr>\n                                                </thead>\n                                                <tbody id=\"users-table-body\">\n                                                    ${renderUsersTable(userManager.users)}\n                                                </tbody>\n                                            </table>\n                                        </div>\n                                    </div>\n                                </div>\n                                \n                                <!-- Bookings Management Tab -->\n                                <div id=\"bookings-management\" class=\"admin-tab-pane\">\n                                    <div class=\"admin-table-container\">\n                                        <div class=\"table-header\">\n                                            <h3>Bookings Management</h3>\n                                            <div class=\"table-actions\">\n                                                <select class=\"form-select-sm\" id=\"booking-type-filter\">\n                                                    <option value=\"\">All Types</option>\n                                                    <option value=\"destination\">Destinations</option>\n                                                    <option value=\"guide\">Guides</option>\n                                                    <option value=\"translator\">Translators</option>\n                                                    <option value=\"accommodation\">Accommodations</option>\n                                                </select>\n                                                <button class=\"btn btn-sm btn-outline\" id=\"export-bookings-btn\">\n                                                    <i class=\"fas fa-download\"></i> Export\n                                                </button>\n                                            </div>\n                                        </div>\n                                        <div class=\"table-responsive\">\n                                            <table class=\"admin-table\">\n                                                <thead>\n                                                    <tr>\n                                                        <th>Booking ID</th>\n                                                        <th>User</th>\n                                                        <th>Service</th>\n                                                        <th>Amount</th>\n                                                        <th>Status</th>\n                                                        <th>Date</th>\n                                                        <th>Actions</th>\n                                                    </tr>\n                                                </thead>\n                                                <tbody id=\"bookings-table-body\">\n                                                    ${renderAdminBookingsTable(userManager.bookings)}\n                                                </tbody>\n                                            </table>\n                                        </div>\n                                    </div>\n                                </div>\n                                \n                                <!-- Trip Plans Management Tab -->\n                                <div id=\"trip-plans-management\" class=\"admin-tab-pane\">\n                                    <div class=\"admin-table-container\">\n                                        <div class=\"table-header\">\n                                            <h3>Trip Plans Management</h3>\n                                            <div class=\"table-actions\">\n                                                <select class=\"form-select-sm\" id=\"trip-status-filter\">\n                                                    <option value=\"\">All Status</option>\n                                                    <option value=\"review\">Review</option>\n                                                    <option value=\"processing\">Processing</option>\n                                                    <option value=\"completed\">Completed</option>\n                                                    <option value=\"cancelled\">Cancelled</option>\n                                                </select>\n                                                <button class=\"btn btn-sm btn-outline\" id=\"export-trips-btn\">\n                                                    <i class=\"fas fa-download\"></i> Export\n                                                </button>\n                                            </div>\n                                        </div>\n                                        <div class=\"table-responsive\">\n                                            <table class=\"admin-table\">\n                                                <thead>\n                                                    <tr>\n                                                        <th>Trip ID</th>\n                                                        <th>User</th>\n                                                        <th>Duration</th>\n                                                        <th>Budget</th>\n                                                        <th>Status</th>\n                                                        <th>Requested</th>\n                                                        <th>Actions</th>\n                                                    </tr>\n                                                </thead>\n                                                <tbody id=\"trips-table-body\">\n                                                    ${renderAdminTripsTable(userManager.tripPlans)}\n                                                </tbody>\n                                            </table>\n                                        </div>\n                                    </div>\n                                </div>\n                                \n                                <!-- Services Management Tab -->\n                                <div id=\"services-management\" class=\"admin-tab-pane\">\n                                    <div class=\"services-management\">\n                                        <div class=\"services-tabs\">\n                                            <button class=\"service-tab active\" data-service=\"guides\">\n                                                <i class=\"fas fa-user-tie\"></i> Guides\n                                            </button>\n                                            <button class=\"service-tab\" data-service=\"translators\">\n                                                <i class=\"fas fa-language\"></i> Translators\n                                            </button>\n                                            <button class=\"service-tab\" data-service=\"accommodations\">\n                                                <i class=\"fas fa-hotel\"></i> Accommodations\n                                            </button>\n                                            <button class=\"service-tab\" data-service=\"destinations\">\n                                                <i class=\"fas fa-map-marked-alt\"></i> Destinations\n                                            </button>\n                                            <button class=\"service-tab\" data-service=\"blog\">\n                                                <i class=\"fas fa-newspaper\"></i> Blog Posts\n                                            </button>\n                                        </div>\n                                        \n                                        <div class=\"services-content\">\n                                            <div id=\"guides-management\" class=\"service-tab-content active\">\n                                                <div class=\"service-header\">\n                                                    <h3>Tour Guides Management</h3>\n                                                    <button class=\"btn btn-success\" id=\"add-guide-btn\">\n                                                        <i class=\"fas fa-plus\"></i> Add Guide\n                                                    </button>\n                                                </div>\n                                                <div class=\"service-table-container\">\n                                                    <table class=\"admin-table\">\n                                                        <thead>\n                                                            <tr>\n                                                                <th>Guide</th>\n                                                                <th>Specialty</th>\n                                                                <th>Languages</th>\n                                                                <th>Rate</th>\n                                                                <th>Status</th>\n                                                                <th>Actions</th>\n                                                            </tr>\n                                                        </thead>\n                                                        <tbody>\n                                                            ${mockData.guides.map(guide => `\n                                                                <tr>\n                                                                    <td>\n                                                                        <div class=\"user-cell\">\n                                                                            <div class=\"user-avatar-small\">\n                                                                                <i class=\"fas fa-user-tie\"></i>\n                                                                            </div>\n                                                                            <div>\n                                                                                <strong>${guide.name}</strong>\n                                                                                <small>${guide.experience}</small>\n                                                                            </div>\n                                                                        </div>\n                                                                    </td>\n                                                                    <td>${guide.specialty}</td>\n                                                                    <td>${guide.languages.slice(0, 2).join(', ')}${guide.languages.length > 2 ? '...' : ''}</td>\n                                                                    <td>${guide.price}</td>\n                                                                    <td>\n                                                                        <span class=\"badge badge-${guide.available ? 'success' : 'secondary'}\">\n                                                                            ${guide.available ? 'Available' : 'Busy'}\n                                                                        </span>\n                                                                    </td>\n                                                                    <td>\n                                                                        <div class=\"table-actions\">\n                                                                            <button class=\"btn-action btn-view\" onclick=\"viewGuideDetails(${guide._id})\">\n                                                                                <i class=\"fas fa-eye\"></i>\n                                                                            </button>\n                                                                            <button class=\"btn-action btn-edit\" onclick=\"editGuide(${guide._id})\">\n                                                                                <i class=\"fas fa-edit\"></i>\n                                                                            </button>\n                                                                            <button class=\"btn-action btn-delete\" onclick=\"deleteGuide(${guide._id})\">\n                                                                                <i class=\"fas fa-trash\"></i>\n                                                                            </button>\n                                                                        </div>\n                                                                    </td>\n                                                                </tr>\n                                                            `).join('')}\n                                                        </tbody>\n                                                    </table>\n                                                </div>\n                                            </div>\n                                            <!-- Other services tabs -->\n                                        </div>\n                                    </div>\n                                </div>\n                                \n                                <!-- Reports Tab -->\n                                <div id=\"reports\" class=\"admin-tab-pane\">\n                                    <div class=\"reports-container\">\n                                        <h3>Generate Reports</h3>\n                                        <div class=\"reports-grid\">\n                                            <div class=\"report-card\">\n                                                <div class=\"report-icon\">\n                                                    <i class=\"fas fa-file-invoice-dollar\"></i>\n                                                </div>\n                                                <h4>Revenue Report</h4>\n                                                <p>Monthly revenue breakdown</p>\n                                                <button class=\"btn btn-primary\" onclick=\"generateReport('revenue')\">\n                                                    Generate\n                                                </button>\n                                            </div>\n                                            <div class=\"report-card\">\n                                                <div class=\"report-icon\">\n                                                    <i class=\"fas fa-users\"></i>\n                                                </div>\n                                                <h4>User Report</h4>\n                                                <p>User statistics and growth</p>\n                                                <button class=\"btn btn-primary\" onclick=\"generateReport('users')\">\n                                                    Generate\n                                                </button>\n                                            </div>\n                                            <div class=\"report-card\">\n                                                <div class=\"report-icon\">\n                                                    <i class=\"fas fa-calendar-alt\"></i>\n                                                </div>\n                                                <h4>Bookings Report</h4>\n                                                <p>Booking trends and performance</p>\n                                                <button class=\"btn btn-primary\" onclick=\"generateReport('bookings')\">\n                                                    Generate\n                                                </button>\n                                            </div>\n                                            <div class=\"report-card\">\n                                                <div class=\"report-icon\">\n                                                    <i class=\"fas fa-chart-pie\"></i>\n                                                </div>\n                                                <h4>Custom Report</h4>\n                                                <p>Create custom report</p>\n                                                <button class=\"btn btn-primary\" onclick=\"showCustomReportModal()\">\n                                                    Create\n                                                </button>\n                                            </div>\n                                        </div>\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            `;\n\n      // Setup admin dashboard event listeners\n      setupAdminDashboardListeners();\n    } catch (error) {\n      console.error('Error loading admin dashboard:', error);\n      admin.innerHTML = `\n                <div class=\"container\">\n                    <div class=\"error-state\">\n                        <i class=\"fas fa-exclamation-triangle fa-3x\"></i>\n                        <h3>Error loading admin dashboard</h3>\n                        <p>${error.message}</p>\n                        <button class=\"btn btn-primary\" onclick=\"location.reload()\">\n                            Retry\n                        </button>\n                    </div>\n                </div>\n            `;\n    }\n  }\n  function renderRevenueChart(monthlyRevenue) {\n    if (monthlyRevenue.length === 0) {\n      return '<p class=\"text-center\">No revenue data available</p>';\n    }\n    const maxRevenue = Math.max(...monthlyRevenue.map(m => m.revenue));\n    return monthlyRevenue.map(item => {\n      const height = item.revenue / maxRevenue * 100;\n      return `\n                <div class=\"chart-bar-container\">\n                    <div class=\"chart-bar\" style=\"height: ${height}%\">\n                        <div class=\"chart-bar-value\">$${item.revenue.toLocaleString()}</div>\n                    </div>\n                    <div class=\"chart-bar-label\">${item.month.split('-')[1]}/${item.month.split('-')[0].slice(2)}</div>\n                </div>\n            `;\n    }).join('');\n  }\n  function renderRecentActivity(activities) {\n    if (activities.length === 0) {\n      return '<p class=\"text-center\">No recent activity</p>';\n    }\n    return activities.slice(0, 6).map(activity => `\n            <div class=\"activity-item\">\n                <div class=\"activity-icon\">\n                    <i class=\"fas fa-${getActivityIcon(activity.type)}\"></i>\n                </div>\n                <div class=\"activity-content\">\n                    <p>\n                        <strong>${activity.name}</strong> ${activity.action} \n                        ${activity.type === 'user' ? 'account' : activity.type}\n                    </p>\n                    <small>${formatTimeAgo(activity.timestamp)}</small>\n                </div>\n            </div>\n        `).join('');\n  }\n  function renderRecentUsers(users) {\n    if (users.length === 0) {\n      return '<p class=\"text-center\">No recent users</p>';\n    }\n    return users.map(user => `\n            <div class=\"user-item\">\n                <div class=\"user-avatar\">\n                    <i class=\"fas fa-user-circle\"></i>\n                </div>\n                <div class=\"user-info\">\n                    <strong>${user.name}</strong>\n                    <small>${user.email}</small>\n                    <span class=\"badge badge-${user.role === 'admin' ? 'danger' : 'primary'}\">\n                        ${user.role}\n                    </span>\n                </div>\n                <div class=\"user-actions\">\n                    <button class=\"btn-action btn-sm\" onclick=\"viewUserDetails(${user._id})\">\n                        <i class=\"fas fa-eye\"></i>\n                    </button>\n                </div>\n            </div>\n        `).join('');\n  }\n  function renderAdminRecentBookings(bookings) {\n    if (bookings.length === 0) {\n      return '<p class=\"text-center\">No recent bookings</p>';\n    }\n    return bookings.map(booking => `\n            <div class=\"booking-item\">\n                <div class=\"booking-icon\">\n                    <i class=\"fas fa-${getServiceIcon(booking.serviceType)}\"></i>\n                </div>\n                <div class=\"booking-info\">\n                    <strong>${booking.serviceName}</strong>\n                    <small>${booking._id}</small>\n                    <div>\n                        <span class=\"badge badge-${booking.status}\">${booking.status}</span>\n                        <span class=\"amount\">$${booking.totalAmount || '0'}</span>\n                    </div>\n                </div>\n                <div class=\"booking-actions\">\n                    <button class=\"btn-action btn-sm\" onclick=\"viewBookingDetails('${booking._id}')\">\n                        <i class=\"fas fa-eye\"></i>\n                    </button>\n                </div>\n            </div>\n        `).join('');\n  }\n  function renderUsersTable(users) {\n    return users.map(user => `\n            <tr>\n                <td>\n                    <div class=\"user-cell\">\n                        <div class=\"user-avatar-small\">\n                            <i class=\"fas fa-user-circle\"></i>\n                        </div>\n                        <div>\n                            <strong>${user.name}</strong>\n                            <small>ID: ${user._id}</small>\n                        </div>\n                    </div>\n                </td>\n                <td>${user.email}</td>\n                <td>\n                    <span class=\"badge badge-${user.role === 'admin' ? 'danger' : 'primary'}\">\n                        ${user.role}\n                    </span>\n                </td>\n                <td>\n                    <span class=\"badge badge-${user.status === 'active' ? 'success' : 'secondary'}\">\n                        ${user.status}\n                    </span>\n                </td>\n                <td>${new Date(user.createdAt).toLocaleDateString()}</td>\n                <td>\n                    <div class=\"table-actions\">\n                        <button class=\"btn-action btn-view\" onclick=\"viewUserDetails(${user._id})\">\n                            <i class=\"fas fa-eye\"></i>\n                        </button>\n                        <button class=\"btn-action btn-edit\" onclick=\"editUser(${user._id})\">\n                            <i class=\"fas fa-edit\"></i>\n                        </button>\n                        <button class=\"btn-action btn-delete\" onclick=\"deleteUserConfirm(${user._id})\">\n                            <i class=\"fas fa-trash\"></i>\n                        </button>\n                    </div>\n                </td>\n            </tr>\n        `).join('');\n  }\n  function renderAdminBookingsTable(bookings) {\n    return bookings.map(booking => `\n            <tr>\n                <td>\n                    <strong>${booking._id}</strong>\n                </td>\n                <td>\n                    <div class=\"user-cell\">\n                        <div class=\"user-avatar-small\">\n                            <i class=\"fas fa-user-circle\"></i>\n                        </div>\n                        <div>\n                            <strong>${booking.userName}</strong>\n                            <small>${booking.userEmail}</small>\n                        </div>\n                    </div>\n                </td>\n                <td>\n                    <div class=\"service-cell\">\n                        <div class=\"service-icon-small service-${booking.serviceType}\">\n                            <i class=\"fas fa-${getServiceIcon(booking.serviceType)}\"></i>\n                        </div>\n                        <div>\n                            <strong>${booking.serviceName}</strong>\n                            <small>${booking.serviceType}</small>\n                        </div>\n                    </div>\n                </td>\n                <td>\n                    <strong>$${booking.totalAmount || '0'}</strong>\n                </td>\n                <td>\n                    <span class=\"badge badge-${booking.status}\">\n                        ${booking.status.toUpperCase()}\n                    </span>\n                </td>\n                <td>${new Date(booking.createdAt).toLocaleDateString()}</td>\n                <td>\n                    <div class=\"table-actions\">\n                        <button class=\"btn-action btn-view\" onclick=\"viewBookingDetails('${booking._id}')\">\n                            <i class=\"fas fa-eye\"></i>\n                        </button>\n                        ${booking.status === 'pending' ? `\n                            <button class=\"btn-action btn-confirm\" onclick=\"confirmBooking('${booking._id}')\">\n                                <i class=\"fas fa-check\"></i>\n                            </button>\n                            <button class=\"btn-action btn-cancel\" onclick=\"cancelBookingAdmin('${booking._id}')\">\n                                <i class=\"fas fa-times\"></i>\n                            </button>\n                        ` : ''}\n                        <button class=\"btn-action btn-download\" onclick=\"downloadBookingInvoice('${booking._id}')\">\n                            <i class=\"fas fa-download\"></i>\n                        </button>\n                    </div>\n                </td>\n            </tr>\n        `).join('');\n  }\n  function renderAdminTripsTable(tripPlans) {\n    return tripPlans.map(trip => `\n            <tr>\n                <td>\n                    <strong>${trip._id}</strong>\n                </td>\n                <td>\n                    <div class=\"user-cell\">\n                        <div class=\"user-avatar-small\">\n                            <i class=\"fas fa-user-circle\"></i>\n                        </div>\n                        <div>\n                            <strong>${trip.userName}</strong>\n                            <small>${trip.userEmail}</small>\n                        </div>\n                    </div>\n                </td>\n                <td>${trip.duration}</td>\n                <td>${trip.budget}</td>\n                <td>\n                    <span class=\"badge badge-${trip.status}\">\n                        ${trip.status.toUpperCase()}\n                    </span>\n                </td>\n                <td>${new Date(trip.createdAt).toLocaleDateString()}</td>\n                <td>\n                    <div class=\"table-actions\">\n                        <button class=\"btn-action btn-view\" onclick=\"viewTripPlanAdmin('${trip._id}')\">\n                            <i class=\"fas fa-eye\"></i>\n                        </button>\n                        <button class=\"btn-action btn-edit\" onclick=\"editTripPlanAdmin('${trip._id}')\">\n                            <i class=\"fas fa-edit\"></i>\n                        </button>\n                        ${trip.status === 'review' ? `\n                            <button class=\"btn-action btn-process\" onclick=\"processTripPlan('${trip._id}')\">\n                                <i class=\"fas fa-cogs\"></i>\n                            </button>\n                        ` : ''}\n                    </div>\n                </td>\n            </tr>\n        `).join('');\n  }\n  function getActivityIcon(activityType) {\n    const icons = {\n      'user': 'user-plus',\n      'booking': 'calendar-check',\n      'trip_plan': 'route'\n    };\n    return icons[activityType] || 'bell';\n  }\n  function formatTimeAgo(timestamp) {\n    const now = new Date();\n    const past = new Date(timestamp);\n    const diff = now - past;\n    const minutes = Math.floor(diff / 60000);\n    const hours = Math.floor(diff / 3600000);\n    const days = Math.floor(diff / 86400000);\n    if (minutes < 60) return `${minutes} minutes ago`;\n    if (hours < 24) return `${hours} hours ago`;\n    return `${days} days ago`;\n  }\n  function setupAdminDashboardListeners() {\n    var _document$getElementB7, _document$getElementB8, _document$getElementB9, _document$getElementB0;\n    // Admin tab switching\n    document.querySelectorAll('.admin-tab-link').forEach(link => {\n      link.addEventListener('click', function () {\n        // Remove active class from all tabs\n        document.querySelectorAll('.admin-tab-link').forEach(l => l.classList.remove('active'));\n        document.querySelectorAll('.admin-tab-pane').forEach(p => p.classList.remove('active'));\n\n        // Add active class to clicked tab\n        this.classList.add('active');\n        const tabId = this.dataset.tab;\n        document.getElementById(tabId).classList.add('active');\n      });\n    });\n\n    // Service tabs\n    document.querySelectorAll('.service-tab').forEach(tab => {\n      tab.addEventListener('click', function () {\n        document.querySelectorAll('.service-tab').forEach(t => t.classList.remove('active'));\n        document.querySelectorAll('.service-tab-content').forEach(c => c.classList.remove('active'));\n        this.classList.add('active');\n        const service = this.dataset.service;\n        document.getElementById(`${service}-management`).classList.add('active');\n      });\n    });\n\n    // Add user button\n    (_document$getElementB7 = document.getElementById('add-user-btn')) === null || _document$getElementB7 === void 0 ? void 0 : _document$getElementB7.addEventListener('click', () => {\n      showAddUserModal();\n    });\n\n    // Generate report button\n    (_document$getElementB8 = document.getElementById('generate-report-btn')) === null || _document$getElementB8 === void 0 ? void 0 : _document$getElementB8.addEventListener('click', () => {\n      generateReport('full');\n    });\n\n    // Search functionality\n    const searchInput = document.getElementById('admin-search-input');\n    if (searchInput) {\n      searchInput.addEventListener('input', function () {\n        searchAdminContent(this.value);\n      });\n    }\n\n    // Filter functionality\n    (_document$getElementB9 = document.getElementById('booking-type-filter')) === null || _document$getElementB9 === void 0 ? void 0 : _document$getElementB9.addEventListener('change', function () {\n      filterAdminBookings(this.value);\n    });\n    (_document$getElementB0 = document.getElementById('trip-status-filter')) === null || _document$getElementB0 === void 0 ? void 0 : _document$getElementB0.addEventListener('change', function () {\n      filterAdminTrips(this.value);\n    });\n  }\n\n  // ===============================\n  // DATA LOADING FUNCTIONS\n  // ===============================\n\n  async function loadHomePage() {\n    console.log('Loading home page...');\n    // Load featured destinations\n    const destinationsGrid = document.querySelector('.destinations-grid');\n    if (destinationsGrid) {\n      var _result$data;\n      const result = await apiRequest(config.endpoints.destinations);\n      const featuredDestinations = ((_result$data = result.data) === null || _result$data === void 0 ? void 0 : _result$data.slice(0, 3)) || mockData.destinations.slice(0, 3);\n      destinationsGrid.innerHTML = featuredDestinations.map(dest => `\n                <div class=\"destination-card\">\n                    <div class=\"destination-image\">\n                        <img src=\"${dest.image}\" alt=\"${dest.name}\" loading=\"lazy\">\n                        <div class=\"destination-rating\">\n                            <i class=\"fas fa-star\"></i> ${dest.rating}\n                        </div>\n                    </div>\n                    <div class=\"destination-content\">\n                        <h3>${dest.name}</h3>\n                        <div class=\"destination-location\">\n                            <i class=\"fas fa-map-marker-alt\"></i> ${dest.location}\n                        </div>\n                        <p>${dest.description.substring(0, 100)}...</p>\n                        <button class=\"btn btn-primary book-now\" \n                                data-type=\"destination\" \n                                data-id=\"${dest._id}\"\n                                data-name=\"${dest.name}\">\n                            Book Now\n                        </button>\n                    </div>\n                </div>\n            `).join('');\n    }\n\n    // Load featured blog posts\n    const blogGrid = document.querySelector('.blog-grid');\n    if (blogGrid) {\n      var _result$data2;\n      const result = await apiRequest(config.endpoints.blog);\n      const featuredBlogs = ((_result$data2 = result.data) === null || _result$data2 === void 0 ? void 0 : _result$data2.slice(0, 3)) || mockData.blog.slice(0, 3);\n      blogGrid.innerHTML = featuredBlogs.map(blog => `\n                <div class=\"blog-card\">\n                    <div class=\"blog-image\">\n                        <img src=\"${blog.image}\" alt=\"${blog.title}\" loading=\"lazy\">\n                        <span class=\"blog-category\">${blog.category}</span>\n                    </div>\n                    <div class=\"blog-content\">\n                        <div class=\"blog-meta\">\n                            <span class=\"blog-date\">\n                                <i class=\"far fa-calendar\"></i> ${blog.date}\n                            </span>\n                            <span class=\"blog-read-time\">${blog.readTime}</span>\n                        </div>\n                        <h3>${blog.title}</h3>\n                        <p>${blog.excerpt.substring(0, 120)}...</p>\n                        <a href=\"#\" class=\"read-more-link\" data-page=\"blog\">Read More <i class=\"fas fa-arrow-right\"></i></a>\n                    </div>\n                </div>\n            `).join('');\n    }\n\n    // Update plan trip button\n    const planTripBtn = document.querySelector('.plan-trip-btn');\n    if (planTripBtn) {\n      planTripBtn.addEventListener('click', e => {\n        e.preventDefault();\n        showTripPlanModal();\n      });\n    }\n  }\n  async function loadDestinations() {\n    console.log('Loading destinations...');\n    const grid = document.querySelector('.destinations-grid-full');\n    if (!grid) return;\n    const result = await apiRequest(config.endpoints.destinations);\n    const destinations = result.data || mockData.destinations;\n    grid.innerHTML = destinations.map(dest => `\n            <div class=\"destination-card\">\n                <div class=\"destination-image\">\n                    <img src=\"${dest.image}\" alt=\"${dest.name}\" loading=\"lazy\">\n                    <div class=\"destination-rating\">\n                        <i class=\"fas fa-star\"></i> ${dest.rating}\n                    </div>\n                </div>\n                <div class=\"destination-content\">\n                    <h3>${dest.name}</h3>\n                    <div class=\"destination-location\">\n                        <i class=\"fas fa-map-marker-alt\"></i> ${dest.location}\n                    </div>\n                    <p>${dest.description}</p>\n                    <div class=\"features\">\n                        ${dest.features.map(f => `<span class=\"feature-tag\">${f}</span>`).join('')}\n                    </div>\n                    <div class=\"price-tag\">${dest.price}</div>\n                    <button class=\"btn btn-primary book-now\" \n                            data-type=\"destination\" \n                            data-id=\"${dest._id}\"\n                            data-name=\"${dest.name}\">\n                        Book Tour\n                    </button>\n                </div>\n            </div>\n        `).join('');\n  }\n  async function loadGuides() {\n    console.log('Loading guides...');\n    const grid = document.querySelector('.guides-grid-full');\n    if (!grid) return;\n    const result = await apiRequest(config.endpoints.guides);\n    const guides = result.data || mockData.guides;\n    grid.innerHTML = guides.map(guide => `\n            <div class=\"guide-card\">\n                <div class=\"guide-avatar\">\n                    <img src=\"${guide.image}\" alt=\"${guide.name}\" loading=\"lazy\">\n                </div>\n                \n                <div class=\"guide-info\">\n                    <h3>${guide.name}</h3>\n                    \n                    <p class=\"specialty\">${guide.specialty}</p>\n                    \n                    <div class=\"languages-section\">\n                        <div class=\"languages-header\">\n                            <i class=\"fas fa-language\"></i>\n                            <strong>Languages:</strong>\n                        </div>\n                        <div class=\"languages-list\">\n                            ${guide.languages.map(lang => `\n                                <span class=\"language-tag\">\n                                    ${lang}\n                                </span>\n                            `).join('')}\n                        </div>\n                    </div>\n                    \n                    <p class=\"experience\">\n                        <i class=\"fas fa-briefcase\"></i> ${guide.experience}\n                    </p>\n                    \n                    <div class=\"rating\">\n                        ${'â˜…'.repeat(Math.floor(guide.rating))}${guide.rating % 1 ? 'Â½' : ''}\n                        <span>${guide.rating}</span>\n                    </div>\n                    \n                    <div class=\"price\">${guide.price}</div>\n                    \n                    <button class=\"btn btn-primary book-now\" \n                            data-type=\"guide\" \n                            data-id=\"${guide._id}\"\n                            data-name=\"${guide.name}\">\n                        Hire Now\n                    </button>\n                </div>\n            </div>\n        `).join('');\n  }\n  async function loadTranslators() {\n    console.log('Loading translators...');\n    const grid = document.querySelector('.translators-grid-full');\n    if (!grid) return;\n    const result = await apiRequest(config.endpoints.translators);\n    const translators = result.data || mockData.translators;\n    grid.innerHTML = translators.map(translator => `\n            <div class=\"translator-card\">\n                <div class=\"guide-avatar\">\n                    <img src=\"${translator.image}\" alt=\"${translator.name}\" loading=\"lazy\">\n                </div>\n                \n                <div class=\"guide-info\">\n                    <h3>${translator.name}</h3>\n                    \n                    <p class=\"specialty\">${translator.specialty}</p>\n                    \n                    <div class=\"languages-section\">\n                        <div class=\"languages-header\">\n                            <i class=\"fas fa-language\"></i>\n                            <strong>Languages:</strong>\n                        </div>\n                        <div class=\"languages-list\">\n                            ${translator.languages.map(lang => `\n                                <span class=\"language-tag\">\n                                    ${lang}\n                                </span>\n                            `).join('')}\n                        </div>\n                    </div>\n                    \n                    <p class=\"experience\">\n                        <i class=\"fas fa-briefcase\"></i> ${translator.experience}\n                    </p>\n                    \n                    <div class=\"rating\">\n                        ${'â˜…'.repeat(Math.floor(translator.rating))}${translator.rating % 1 ? 'Â½' : ''}\n                        <span>${translator.rating}</span>\n                    </div>\n                    \n                    <div class=\"price\">${translator.price}</div>\n                    \n                    <button class=\"btn btn-primary book-now\" \n                            data-type=\"translator\" \n                            data-id=\"${translator._id}\"\n                            data-name=\"${translator.name}\">\n                        Hire Now\n                    </button>\n                </div>\n            </div>\n        `).join('');\n  }\n  async function loadAccommodations() {\n    console.log('Loading accommodations...');\n    const grid = document.querySelector('.accommodations-grid-full');\n    if (!grid) return;\n    const result = await apiRequest(config.endpoints.accommodations);\n    const accommodations = result.data || mockData.accommodations;\n    grid.innerHTML = accommodations.map(acc => `\n            <div class=\"accommodation-card\">\n                <div class=\"accommodation-image\">\n                    <img src=\"${acc.image}\" alt=\"${acc.name}\" loading=\"lazy\">\n                </div>\n                <div class=\"accommodation-content\">\n                    <span class=\"type\">${acc.type}</span>\n                    <h3>${acc.name}</h3>\n                    <div class=\"location\">\n                        <i class=\"fas fa-map-marker-alt\"></i> ${acc.location}\n                    </div>\n                    <p>${acc.description.substring(0, 120)}...</p>\n                    <div class=\"features\">\n                        ${acc.features.slice(0, 3).map(f => `<span class=\"feature-tag\">${f}</span>`).join('')}\n                    </div>\n                    <div class=\"price-tag\">${acc.price}</div>\n                    <button class=\"btn btn-primary book-now\" \n                            data-type=\"accommodation\" \n                            data-id=\"${acc._id}\"\n                            data-name=\"${acc.name}\">\n                        Book Now\n                    </button>\n                </div>\n            </div>\n        `).join('');\n  }\n  async function loadBlog() {\n    console.log('Loading blog...');\n    const grid = document.querySelector('.blog-grid-full');\n    if (!grid) return;\n    const result = await apiRequest(config.endpoints.blog);\n    const blogs = result.data || mockData.blog;\n    grid.innerHTML = blogs.map(blog => `\n            <div class=\"blog-card\">\n                <div class=\"blog-image\">\n                    <img src=\"${blog.image}\" alt=\"${blog.title}\" loading=\"lazy\">\n                    <span class=\"blog-category\">${blog.category}</span>\n                </div>\n                <div class=\"blog-content\">\n                    <div class=\"blog-meta\">\n                        <span class=\"blog-date\">\n                            <i class=\"fas fa-calendar\"></i> ${blog.date}\n                        </span>\n                        <span class=\"blog-read-time\">${blog.readTime}</span>\n                    </div>\n                    <h3>${blog.title}</h3>\n                    <p>${blog.excerpt}</p>\n                    <p class=\"author\"><i class=\"fas fa-user\"></i> ${blog.author}</p>\n                    <a href=\"#\" class=\"read-more-link\">Read Full Article</a>\n                </div>\n            </div>\n        `).join('');\n  }\n\n  // ===============================\n  // UI COMPONENTS\n  // ===============================\n\n  function showNotification(message, type = 'info', duration = 5000) {\n    // Remove existing notifications\n    const existing = document.querySelectorAll('.notification-toast');\n    existing.forEach(n => n.remove());\n    const notification = document.createElement('div');\n    notification.className = `notification-toast ${type}`;\n    notification.innerHTML = `\n            <div class=\"notification-content\">\n                <span class=\"notification-message\">${message}</span>\n                <button class=\"notification-close\">&times;</button>\n            </div>\n        `;\n    document.body.appendChild(notification);\n\n    // Show with animation\n    setTimeout(() => notification.classList.add('show'), 10);\n\n    // Auto remove\n    const removeTimer = setTimeout(() => {\n      notification.classList.remove('show');\n      setTimeout(() => notification.remove(), 300);\n    }, duration);\n\n    // Close button\n    notification.querySelector('.notification-close').addEventListener('click', () => {\n      clearTimeout(removeTimer);\n      notification.classList.remove('show');\n      setTimeout(() => notification.remove(), 300);\n    });\n  }\n  function updateAuthUI(isLoggedIn = false, user = null) {\n    console.log('Updating auth UI:', isLoggedIn ? 'Logged in' : 'Logged out');\n    const authToggle = document.getElementById('auth-toggle');\n    const authDropdown = document.getElementById('auth-dropdown-menu');\n    if (!authToggle || !authDropdown) return;\n    if (isLoggedIn && user) {\n      authToggle.innerHTML = `\n                <i class=\"fas fa-user\"></i>\n                <span>${user.name.split(' ')[0]}</span>\n                <i class=\"fas fa-chevron-down\"></i>\n            `;\n      authDropdown.innerHTML = `\n                <div class=\"user-info\">\n                    <div class=\"user-avatar\">\n                        <i class=\"fas fa-user-circle\"></i>\n                    </div>\n                    <div class=\"user-details\">\n                        <strong>${user.name}</strong>\n                        <small>${user.email}</small>\n                    </div>\n                </div>\n                \n                <a href=\"#\" class=\"auth-option\" data-page=\"dashboard\">\n                    <i class=\"fas fa-tachometer-alt\"></i> Dashboard\n                </a>\n                \n                ${user.role === 'admin' ? `\n                    <a href=\"#\" class=\"auth-option\" data-page=\"admin\">\n                        <i class=\"fas fa-crown\"></i> Admin Panel\n                    </a>\n                ` : ''}\n                \n                <a href=\"#\" class=\"auth-option\" id=\"logout-btn\">\n                    <i class=\"fas fa-sign-out-alt\"></i> Logout\n                </a>\n                \n                <div class=\"auth-divider\"></div>\n                \n                <div class=\"auth-option demo-mode-info\">\n                    <i class=\"fas fa-info-circle\"></i> ${useMockData ? 'Demo Mode' : 'Connected'}\n                </div>\n            `;\n      document.getElementById('logout-btn').addEventListener('click', e => {\n        e.preventDefault();\n        e.stopPropagation();\n        logout();\n      });\n    } else {\n      authToggle.innerHTML = `\n                <i class=\"fas fa-user\"></i>\n                <span>Account</span>\n                <i class=\"fas fa-chevron-down\"></i>\n            `;\n      authDropdown.innerHTML = `\n                <a href=\"#\" class=\"auth-option sign-in-btn\">\n                    <i class=\"fas fa-sign-in-alt\"></i> Sign In\n                </a>\n                \n                <a href=\"#\" class=\"auth-option signup-btn\">\n                    <i class=\"fas fa-user-plus\"></i> Sign Up\n                </a>\n                \n                <div class=\"auth-divider\"></div>\n                \n                <a href=\"#\" class=\"auth-option demo-login-btn\">\n                    <i class=\"fas fa-rocket\"></i> Quick Demo\n                </a>\n                \n                <div class=\"auth-option demo-mode-info\">\n                    <i class=\"fas fa-info-circle\"></i> ${useMockData ? 'Demo Mode' : 'Connected'}\n                </div>\n            `;\n\n      // Add event listeners for new buttons\n      const signInBtn = authDropdown.querySelector('.sign-in-btn');\n      const signUpBtn = authDropdown.querySelector('.signup-btn');\n      const demoLoginBtn = authDropdown.querySelector('.demo-login-btn');\n      if (signInBtn) {\n        signInBtn.addEventListener('click', e => {\n          e.preventDefault();\n          e.stopPropagation();\n          showAuthModal('login');\n        });\n      }\n      if (signUpBtn) {\n        signUpBtn.addEventListener('click', e => {\n          e.preventDefault();\n          e.stopPropagation();\n          showAuthModal('register');\n        });\n      }\n      if (demoLoginBtn) {\n        demoLoginBtn.addEventListener('click', e => {\n          e.preventDefault();\n          e.stopPropagation();\n          quickDemoLogin();\n        });\n      }\n    }\n  }\n  function quickDemoLogin() {\n    const demoUser = {\n      _id: Date.now(),\n      name: 'Demo User',\n      email: 'demo@example.com',\n      role: 'user',\n      phone: '+250 788 123 456',\n      country: 'Rwanda',\n      token: 'demo-jwt-token-' + Date.now()\n    };\n    isAuthenticated = true;\n    currentUser = demoUser;\n    saveUserData(demoUser);\n    updateAuthUI(true, demoUser);\n    showNotification('âœ… Demo login successful! Welcome!', 'success');\n    setTimeout(() => {\n      showPage('dashboard');\n    }, 1000);\n  }\n\n  // ===============================\n  // MODAL SYSTEM\n  // ===============================\n\n  function showAuthModal(type = 'login') {\n    console.log('Showing auth modal:', type);\n    const modal = createModal();\n    const isLogin = type === 'login';\n    modal.innerHTML = `\n            <div class=\"modal-header\">\n                <h2>${isLogin ? 'Sign In' : 'Create Account'}</h2>\n                <button class=\"modal-close\">&times;</button>\n            </div>\n            \n            <div class=\"modal-body\">\n                <form id=\"auth-form\">\n                    ${!isLogin ? `\n                        <div class=\"form-group\">\n                            <label>Full Name *</label>\n                            <input type=\"text\" name=\"name\" required>\n                        </div>\n                    ` : ''}\n                    \n                    <div class=\"form-group\">\n                        <label>Email *</label>\n                        <input type=\"email\" name=\"email\" required>\n                    </div>\n                    \n                    <div class=\"form-group\">\n                        <label>Password *</label>\n                        <input type=\"password\" name=\"password\" required>\n                        ${!isLogin ? '<small>Minimum 6 characters</small>' : ''}\n                    </div>\n                    \n                    ${!isLogin ? `\n                        <div class=\"form-group\">\n                            <label>Phone</label>\n                            <input type=\"tel\" name=\"phone\">\n                        </div>\n                        \n                        <div class=\"form-group\">\n                            <label>Country</label>\n                            <input type=\"text\" name=\"country\">\n                        </div>\n                        \n                        <div class=\"form-group\">\n                            <label class=\"checkbox\">\n                                <input type=\"checkbox\" name=\"newsletter\" checked>\n                                Subscribe to newsletter\n                            </label>\n                        </div>\n                    ` : ''}\n                    \n                    <button type=\"submit\" class=\"btn btn-primary btn-block\">\n                        ${isLogin ? 'Sign In' : 'Create Account'}\n                    </button>\n                    \n                    <div class=\"auth-switch\">\n                        ${isLogin ? 'Don\\'t have an account?' : 'Already have an account?'}\n                        <a href=\"#\" class=\"switch-link\">${isLogin ? 'Sign Up' : 'Sign In'}</a>\n                    </div>\n                </form>\n            </div>\n        `;\n    const form = modal.querySelector('#auth-form');\n    form.addEventListener('submit', async e => {\n      e.preventDefault();\n      const formData = new FormData(form);\n      const data = Object.fromEntries(formData.entries());\n      if (isLogin) {\n        await login(data.email, data.password);\n        if (isAuthenticated) closeModal();\n      } else {\n        await register(data);\n        if (isAuthenticated) closeModal();\n      }\n    });\n\n    // Switch between login/register\n    modal.querySelector('.switch-link').addEventListener('click', e => {\n      e.preventDefault();\n      closeModal();\n      showAuthModal(isLogin ? 'register' : 'login');\n    });\n  }\n  function showServiceSelectionModal() {\n    const modal = createModal();\n    modal.innerHTML = `\n            <div class=\"modal-header\">\n                <h2><i class=\"fas fa-plus-circle\"></i> Book a Service</h2>\n                <button class=\"modal-close\">&times;</button>\n            </div>\n            \n            <div class=\"modal-body\">\n                <div class=\"service-selection\">\n                    <h3>Select Service Type</h3>\n                    <p>Choose what you'd like to book for your Rwanda adventure</p>\n                    \n                    <div class=\"service-options\">\n                        <div class=\"service-option\" data-type=\"destination\">\n                            <div class=\"service-option-icon\">\n                                <i class=\"fas fa-map-marked-alt\"></i>\n                            </div>\n                            <div class=\"service-option-content\">\n                                <h4>Destination</h4>\n                                <p>Book tours and experiences at Rwanda's top destinations</p>\n                            </div>\n                            <i class=\"fas fa-chevron-right\"></i>\n                        </div>\n                        \n                        <div class=\"service-option\" data-type=\"guide\">\n                            <div class=\"service-option-icon\">\n                                <i class=\"fas fa-user-tie\"></i>\n                            </div>\n                            <div class=\"service-option-content\">\n                                <h4>Tour Guide</h4>\n                                <p>Hire an expert local guide for your journey</p>\n                            </div>\n                            <i class=\"fas fa-chevron-right\"></i>\n                        </div>\n                        \n                        <div class=\"service-option\" data-type=\"translator\">\n                            <div class=\"service-option-icon\">\n                                <i class=\"fas fa-language\"></i>\n                            </div>\n                            <div class=\"service-option-content\">\n                                <h4>Translator</h4>\n                                <p>Get language assistance from professional translators</p>\n                            </div>\n                            <i class=\"fas fa-chevron-right\"></i>\n                        </div>\n                        \n                        <div class=\"service-option\" data-type=\"accommodation\">\n                            <div class=\"service-option-icon\">\n                                <i class=\"fas fa-hotel\"></i>\n                            </div>\n                            <div class=\"service-option-content\">\n                                <h4>Accommodation</h4>\n                                <p>Book hotels, lodges, and guesthouses</p>\n                            </div>\n                            <i class=\"fas fa-chevron-right\"></i>\n                        </div>\n                        \n                        <div class=\"service-option\" data-type=\"package\">\n                            <div class=\"service-option-icon\">\n                                <i class=\"fas fa-suitcase-rolling\"></i>\n                            </div>\n                            <div class=\"service-option-content\">\n                                <h4>Complete Package</h4>\n                                <p>Get a customized all-inclusive travel package</p>\n                            </div>\n                            <i class=\"fas fa-chevron-right\"></i>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        `;\n\n    // Add click handlers for service options\n    modal.querySelectorAll('.service-option').forEach(option => {\n      option.addEventListener('click', () => {\n        const serviceType = option.dataset.type;\n        closeModal();\n        if (serviceType === 'package') {\n          showTripPlanModal();\n        } else {\n          showEnhancedBookingModal(serviceType);\n        }\n      });\n    });\n  }\n  function showEnhancedBookingModal(serviceType, serviceId = null, serviceName = null) {\n    var _serviceDetails, _currentUser3, _currentUser4, _currentUser5, _currentUser6, _serviceDetails2, _serviceDetails3, _serviceDetails6, _serviceDetails7;\n    const modal = createModal();\n\n    // Get service details if ID is provided\n    let serviceDetails = null;\n    if (serviceId) {\n      // Find the service in mock data\n      let allServices = [];\n      if (serviceType === 'guide') allServices = mockData.guides;else if (serviceType === 'translator') allServices = mockData.translators;else if (serviceType === 'accommodation') allServices = mockData.accommodations;else if (serviceType === 'destination') allServices = mockData.destinations;\n      serviceDetails = allServices.find(s => s._id == serviceId);\n    }\n    modal.innerHTML = `\n            <div class=\"modal-header\">\n                <h2><i class=\"fas fa-calendar-plus\"></i> Book ${serviceType.charAt(0).toUpperCase() + serviceType.slice(1)}</h2>\n                <button class=\"modal-close\">&times;</button>\n            </div>\n            \n            <div class=\"modal-body\">\n                <form id=\"enhanced-booking-form\">\n                    <input type=\"hidden\" name=\"service_type\" value=\"${serviceType}\">\n                    <input type=\"hidden\" name=\"service_id\" value=\"${serviceId || ''}\">\n                    <input type=\"hidden\" name=\"service_name\" value=\"${((_serviceDetails = serviceDetails) === null || _serviceDetails === void 0 ? void 0 : _serviceDetails.name) || serviceName || ''}\">\n                    \n                    ${serviceDetails ? `\n                        <div class=\"booking-service-preview\">\n                            <h4>${serviceDetails.name}</h4>\n                            <p><strong>Price:</strong> ${serviceDetails.price}</p>\n                            ${serviceDetails.description ? `<p>${serviceDetails.description.substring(0, 100)}...</p>` : ''}\n                        </div>\n                    ` : ''}\n                    \n                    <div class=\"form-section\">\n                        <h4><i class=\"fas fa-user\"></i> Personal Information</h4>\n                        <div class=\"form-row\">\n                            <div class=\"form-group\">\n                                <label>Full Name *</label>\n                                <input type=\"text\" name=\"name\" value=\"${((_currentUser3 = currentUser) === null || _currentUser3 === void 0 ? void 0 : _currentUser3.name) || ''}\" required>\n                            </div>\n                            <div class=\"form-group\">\n                                <label>Email *</label>\n                                <input type=\"email\" name=\"email\" value=\"${((_currentUser4 = currentUser) === null || _currentUser4 === void 0 ? void 0 : _currentUser4.email) || ''}\" required>\n                            </div>\n                        </div>\n                        <div class=\"form-row\">\n                            <div class=\"form-group\">\n                                <label>Phone *</label>\n                                <input type=\"tel\" name=\"phone\" value=\"${((_currentUser5 = currentUser) === null || _currentUser5 === void 0 ? void 0 : _currentUser5.phone) || ''}\" required>\n                            </div>\n                            <div class=\"form-group\">\n                                <label>Nationality</label>\n                                <input type=\"text\" name=\"nationality\" value=\"${((_currentUser6 = currentUser) === null || _currentUser6 === void 0 ? void 0 : _currentUser6.country) || ''}\">\n                            </div>\n                        </div>\n                    </div>\n                    \n                    <div class=\"form-section\">\n                        <h4><i class=\"fas fa-calendar-alt\"></i> Booking Details</h4>\n                        <div class=\"form-row\">\n                            <div class=\"form-group\">\n                                <label>Start Date *</label>\n                                <input type=\"date\" name=\"date\" required min=\"${new Date().toISOString().split('T')[0]}\">\n                            </div>\n                            <div class=\"form-group\">\n                                <label>Duration (days) *</label>\n                                <select name=\"duration\" required>\n                                    <option value=\"1\">1 day</option>\n                                    <option value=\"2\">2 days</option>\n                                    <option value=\"3\">3 days</option>\n                                    <option value=\"4\">4 days</option>\n                                    <option value=\"5\">5 days</option>\n                                    <option value=\"6\">6 days</option>\n                                    <option value=\"7\">7 days</option>\n                                    <option value=\"8\">8+ days</option>\n                                </select>\n                            </div>\n                        </div>\n                        <div class=\"form-row\">\n                            <div class=\"form-group\">\n                                <label>Number of Travelers *</label>\n                                <div class=\"travelers-input\">\n                                    <button type=\"button\" class=\"btn-counter\" data-action=\"decrease\">-</button>\n                                    <input type=\"number\" name=\"travelers\" value=\"1\" min=\"1\" max=\"20\" readonly>\n                                    <button type=\"button\" class=\"btn-counter\" data-action=\"increase\">+</button>\n                                </div>\n                            </div>\n                            <div class=\"form-group\">\n                                <label>Total Amount ($)</label>\n                                <input type=\"number\" name=\"total_amount\" placeholder=\"Estimated total\" min=\"0\" \n                                       value=\"${(_serviceDetails2 = serviceDetails) !== null && _serviceDetails2 !== void 0 && _serviceDetails2.dailyRate ? serviceDetails.dailyRate : (_serviceDetails3 = serviceDetails) !== null && _serviceDetails3 !== void 0 && _serviceDetails3.basePrice ? serviceDetails.basePrice : ''}\">\n                            </div>\n                        </div>\n                    </div>\n                    \n                    <div class=\"form-section\">\n                        <h4><i class=\"fas fa-comment-dots\"></i> Additional Information</h4>\n                        <div class=\"form-group\">\n                            <label>Special Requirements</label>\n                            <textarea name=\"notes\" rows=\"3\" placeholder=\"Any dietary restrictions, accessibility needs, or special requests...\"></textarea>\n                        </div>\n                    </div>\n                    \n                    <div class=\"form-section\">\n                        <h4><i class=\"fas fa-file-invoice-dollar\"></i> Payment Method</h4>\n                        <div class=\"payment-options\">\n                            <label class=\"payment-option\">\n                                <input type=\"radio\" name=\"payment_method\" value=\"pay_now\" checked>\n                                <div class=\"payment-content\">\n                                    <i class=\"fas fa-credit-card\"></i>\n                                    <div>\n                                        <strong>Pay Now</strong>\n                                        <small>Secure online payment</small>\n                                    </div>\n                                </div>\n                            </label>\n                            <label class=\"payment-option\">\n                                <input type=\"radio\" name=\"payment_method\" value=\"pay_later\">\n                                <div class=\"payment-content\">\n                                    <i class=\"fas fa-clock\"></i>\n                                    <div>\n                                        <strong>Pay Later</strong>\n                                        <small>Pay upon arrival</small>\n                                    </div>\n                                </div>\n                            </label>\n                        </div>\n                    </div>\n                    \n                    <div class=\"form-actions\">\n                        <button type=\"submit\" class=\"btn btn-primary btn-lg\">\n                            <i class=\"fas fa-check-circle\"></i> Confirm Booking\n                        </button>\n                        <button type=\"button\" class=\"btn btn-outline\" onclick=\"closeModal()\">\n                            Cancel\n                        </button>\n                    </div>\n                </form>\n            </div>\n        `;\n\n    // Set default date to tomorrow\n    const dateInput = modal.querySelector('input[name=\"date\"]');\n    if (dateInput) {\n      const tomorrow = new Date();\n      tomorrow.setDate(tomorrow.getDate() + 1);\n      dateInput.value = tomorrow.toISOString().split('T')[0];\n    }\n\n    // Travelers counter functionality\n    modal.querySelectorAll('.btn-counter').forEach(button => {\n      button.addEventListener('click', function () {\n        var _serviceDetails4, _serviceDetails5;\n        const action = this.dataset.action;\n        const input = this.parentElement.querySelector('input[name=\"travelers\"]');\n        let value = parseInt(input.value);\n        if (action === 'increase' && value < 20) {\n          value++;\n        } else if (action === 'decrease' && value > 1) {\n          value--;\n        }\n        input.value = value;\n\n        // Update total amount if service has daily rate\n        if ((_serviceDetails4 = serviceDetails) !== null && _serviceDetails4 !== void 0 && _serviceDetails4.dailyRate) {\n          const duration = parseInt(modal.querySelector('select[name=\"duration\"]').value);\n          const totalAmount = serviceDetails.dailyRate * duration * value;\n          modal.querySelector('input[name=\"total_amount\"]').value = totalAmount;\n        } else if ((_serviceDetails5 = serviceDetails) !== null && _serviceDetails5 !== void 0 && _serviceDetails5.basePrice) {\n          const totalAmount = serviceDetails.basePrice * value;\n          modal.querySelector('input[name=\"total_amount\"]').value = totalAmount;\n        }\n      });\n    });\n\n    // Update amount when duration changes\n    const durationSelect = modal.querySelector('select[name=\"duration\"]');\n    if (durationSelect && ((_serviceDetails6 = serviceDetails) !== null && _serviceDetails6 !== void 0 && _serviceDetails6.dailyRate || (_serviceDetails7 = serviceDetails) !== null && _serviceDetails7 !== void 0 && _serviceDetails7.basePrice)) {\n      durationSelect.addEventListener('change', function () {\n        const travelers = parseInt(modal.querySelector('input[name=\"travelers\"]').value);\n        const duration = parseInt(this.value);\n        if (serviceDetails.dailyRate) {\n          const totalAmount = serviceDetails.dailyRate * duration * travelers;\n          modal.querySelector('input[name=\"total_amount\"]').value = totalAmount;\n        } else if (serviceDetails.basePrice) {\n          const totalAmount = serviceDetails.basePrice * travelers;\n          modal.querySelector('input[name=\"total_amount\"]').value = totalAmount;\n        }\n      });\n    }\n\n    // Form submission\n    const form = modal.querySelector('#enhanced-booking-form');\n    form.addEventListener('submit', async function (e) {\n      e.preventDefault();\n      const formData = new FormData(this);\n      const data = Object.fromEntries(formData.entries());\n\n      // Add user ID and calculate end date\n      data.userId = currentUser._id;\n      data.userName = currentUser.name;\n      data.userEmail = currentUser.email;\n      const startDate = new Date(data.date);\n      const endDate = new Date(startDate);\n      endDate.setDate(endDate.getDate() + parseInt(data.duration));\n      data.endDate = endDate.toISOString();\n      try {\n        const booking = userManager.createBooking(data);\n\n        // Show success message and generate invoice\n        showNotification(`âœ… Booking created successfully! Reference: ${booking._id}`, 'success');\n        closeModal();\n\n        // Refresh dashboard to show new booking\n        setTimeout(() => {\n          if (currentUser.role === 'user') {\n            loadDashboard();\n          } else if (currentUser.role === 'admin') {\n            loadAdminDashboard();\n          }\n        }, 500);\n      } catch (error) {\n        showNotification(`âŒ Error creating booking: ${error.message}`, 'error');\n      }\n    });\n  }\n  function createModal() {\n    // Remove existing modal\n    const existing = document.getElementById('modal-container');\n    if (existing) existing.remove();\n\n    // Create modal container\n    const modalContainer = document.createElement('div');\n    modalContainer.id = 'modal-container';\n    modalContainer.innerHTML = `\n            <div class=\"modal-overlay\"></div>\n            <div class=\"modal-content\"></div>\n        `;\n    document.body.appendChild(modalContainer);\n    modalContainer.style.display = 'block';\n\n    // Add close handlers\n    const overlay = modalContainer.querySelector('.modal-overlay');\n    overlay.addEventListener('click', closeModal);\n\n    // Close on Escape key\n    const escapeHandler = e => {\n      if (e.key === 'Escape') {\n        closeModal();\n        document.removeEventListener('keydown', escapeHandler);\n      }\n    };\n    document.addEventListener('keydown', escapeHandler);\n    return modalContainer.querySelector('.modal-content');\n  }\n  function closeModal() {\n    const modal = document.getElementById('modal-container');\n    if (modal) {\n      modal.remove();\n    }\n  }\n  function showTripPlanModal() {\n    var _currentUser7, _currentUser8, _currentUser9;\n    console.log('Showing trip plan modal');\n    const modal = createModal();\n    modal.innerHTML = `\n            <div class=\"modal-header\">\n                <h2><i class=\"fas fa-route\"></i> Plan Your Trip</h2>\n                <button class=\"modal-close\">&times;</button>\n            </div>\n            \n            <div class=\"modal-body\">\n                <form id=\"trip-plan-form\">\n                    <div class=\"form-group\">\n                        <label>Full Name *</label>\n                        <input type=\"text\" name=\"name\" value=\"${((_currentUser7 = currentUser) === null || _currentUser7 === void 0 ? void 0 : _currentUser7.name) || ''}\" required>\n                    </div>\n                    \n                    <div class=\"form-group\">\n                        <label>Email *</label>\n                        <input type=\"email\" name=\"email\" value=\"${((_currentUser8 = currentUser) === null || _currentUser8 === void 0 ? void 0 : _currentUser8.email) || ''}\" required>\n                    </div>\n                    \n                    <div class=\"form-row\">\n                        <div class=\"form-group\">\n                            <label>Start Date *</label>\n                            <input type=\"date\" name=\"start_date\" required>\n                        </div>\n                        \n                        <div class=\"form-group\">\n                            <label>Duration *</label>\n                            <select name=\"duration\" required>\n                                <option value=\"3-5\">3-5 days</option>\n                                <option value=\"6-8\">6-8 days</option>\n                                <option value=\"9-12\">9-12 days</option>\n                                <option value=\"13+\">13+ days</option>\n                            </select>\n                        </div>\n                    </div>\n                    \n                    <div class=\"form-row\">\n                        <div class=\"form-group\">\n                            <label>Travelers *</label>\n                            <input type=\"number\" name=\"travelers\" min=\"1\" required>\n                        </div>\n                        \n                        <div class=\"form-group\">\n                            <label>Budget *</label>\n                            <select name=\"budget\" required>\n                                <option value=\"budget\">Budget ($500-$1000)</option>\n                                <option value=\"midrange\">Mid-range ($1000-$2500)</option>\n                                <option value=\"luxury\">Luxury ($2500+)</option>\n                            </select>\n                        </div>\n                    </div>\n                    \n                    <div class=\"form-group\">\n                        <label>Interests</label>\n                        <div class=\"checkbox-group\">\n                            <label class=\"checkbox\">\n                                <input type=\"checkbox\" name=\"interests\" value=\"gorilla\">\n                                Gorilla Trekking\n                            </label>\n                            <label class=\"checkbox\">\n                                <input type=\"checkbox\" name=\"interests\" value=\"culture\">\n                                Cultural Tours\n                            </label>\n                            <label class=\"checkbox\">\n                                <input type=\"checkbox\" name=\"interests\" value=\"hiking\">\n                                Hiking\n                            </label>\n                            <label class=\"checkbox\">\n                                <input type=\"checkbox\" name=\"interests\" value=\"wildlife\">\n                                Wildlife Safari\n                            </label>\n                        </div>\n                    </div>\n                    \n                    <div class=\"form-group\">\n                        <label>Additional Information</label>\n                        <textarea name=\"message\" rows=\"4\" placeholder=\"Tell us about your dream trip...\"></textarea>\n                    </div>\n                    \n                    <button type=\"submit\" class=\"btn btn-primary btn-block\">Submit Trip Plan</button>\n                </form>\n            </div>\n        `;\n\n    // Set default date\n    const dateInput = modal.querySelector('input[name=\"start_date\"]');\n    if (dateInput) {\n      const nextMonth = new Date();\n      nextMonth.setMonth(nextMonth.getMonth() + 1);\n      dateInput.value = nextMonth.toISOString().split('T')[0];\n      dateInput.min = new Date().toISOString().split('T')[0];\n    }\n\n    // Set default travelers\n    modal.querySelector('input[name=\"travelers\"]').value = ((_currentUser9 = currentUser) === null || _currentUser9 === void 0 ? void 0 : _currentUser9.travelers) || 2;\n    const form = modal.querySelector('#trip-plan-form');\n    form.addEventListener('submit', async e => {\n      e.preventDefault();\n      const formData = new FormData(form);\n      const data = Object.fromEntries(formData.entries());\n\n      // Get interests\n      const interests = Array.from(form.querySelectorAll('input[name=\"interests\"]:checked')).map(input => input.value);\n      data.interests = interests;\n\n      // Add user information\n      data.userId = currentUser._id;\n      data.userName = currentUser.name;\n      data.userEmail = currentUser.email;\n      data.status = 'review';\n      try {\n        const tripPlan = userManager.createTripPlan(data);\n        showNotification(`âœ… Trip plan submitted! Our team will review it and get back to you within 24 hours. Reference: ${tripPlan._id}`, 'success');\n        closeModal();\n\n        // Refresh dashboard to show new trip plan\n        setTimeout(() => {\n          if (currentUser.role === 'user') {\n            loadDashboard();\n          }\n        }, 500);\n      } catch (error) {\n        showNotification(`âŒ Error: ${error.message}`, 'error');\n      }\n    });\n    modal.querySelector('.modal-close').addEventListener('click', closeModal);\n  }\n  function showAddUserModal() {\n    const modal = createModal();\n    modal.innerHTML = `\n            <div class=\"modal-header\">\n                <h2><i class=\"fas fa-user-plus\"></i> Add New User</h2>\n                <button class=\"modal-close\">&times;</button>\n            </div>\n            \n            <div class=\"modal-body\">\n                <form id=\"add-user-form\">\n                    <div class=\"form-section\">\n                        <h4>Basic Information</h4>\n                        <div class=\"form-row\">\n                            <div class=\"form-group\">\n                                <label>Full Name *</label>\n                                <input type=\"text\" name=\"name\" required>\n                            </div>\n                            <div class=\"form-group\">\n                                <label>Email *</label>\n                                <input type=\"email\" name=\"email\" required>\n                            </div>\n                        </div>\n                        \n                        <div class=\"form-row\">\n                            <div class=\"form-group\">\n                                <label>Password *</label>\n                                <input type=\"password\" name=\"password\" required minlength=\"6\">\n                            </div>\n                            <div class=\"form-group\">\n                                <label>Confirm Password *</label>\n                                <input type=\"password\" name=\"confirm_password\" required minlength=\"6\">\n                            </div>\n                        </div>\n                    </div>\n                    \n                    <div class=\"form-section\">\n                        <h4>Role & Permissions</h4>\n                        <div class=\"form-row\">\n                            <div class=\"form-group\">\n                                <label>User Role *</label>\n                                <select name=\"role\" required>\n                                    <option value=\"user\">User (Customer)</option>\n                                    <option value=\"admin\">Administrator</option>\n                                    <option value=\"agent\">Travel Agent</option>\n                                    <option value=\"guide\">Tour Guide</option>\n                                </select>\n                            </div>\n                            <div class=\"form-group\">\n                                <label>Status</label>\n                                <select name=\"status\">\n                                    <option value=\"active\">Active</option>\n                                    <option value=\"inactive\">Inactive</option>\n                                    <option value=\"pending\">Pending</option>\n                                </select>\n                            </div>\n                        </div>\n                    </div>\n                    \n                    <div class=\"form-section\">\n                        <h4>Contact Information</h4>\n                        <div class=\"form-row\">\n                            <div class=\"form-group\">\n                                <label>Phone Number</label>\n                                <input type=\"tel\" name=\"phone\">\n                            </div>\n                            <div class=\"form-group\">\n                                <label>Country</label>\n                                <input type=\"text\" name=\"country\">\n                            </div>\n                        </div>\n                    </div>\n                    \n                    <div class=\"form-actions\">\n                        <button type=\"submit\" class=\"btn btn-success\">\n                            <i class=\"fas fa-save\"></i> Create User\n                        </button>\n                        <button type=\"button\" class=\"btn btn-outline\" onclick=\"closeModal()\">\n                            Cancel\n                        </button>\n                    </div>\n                </form>\n            </div>\n        `;\n    const form = modal.querySelector('#add-user-form');\n    form.addEventListener('submit', function (e) {\n      e.preventDefault();\n      const formData = new FormData(this);\n      const data = Object.fromEntries(formData.entries());\n\n      // Validate passwords match\n      if (data.password !== data.confirm_password) {\n        showNotification('âŒ Passwords do not match', 'error');\n        return;\n      }\n      try {\n        const newUser = userManager.registerUser(data);\n        showNotification(`âœ… User ${newUser.name} created successfully!`, 'success');\n        closeModal();\n\n        // Refresh admin dashboard\n        setTimeout(() => {\n          loadAdminDashboard();\n        }, 500);\n      } catch (error) {\n        showNotification(`âŒ Error creating user: ${error.message}`, 'error');\n      }\n    });\n  }\n\n  // ===============================\n  // FORM HANDLERS\n  // ===============================\n\n  function setupForms() {\n    console.log('Setting up forms...');\n\n    // Newsletter form\n    const newsletterForm = document.getElementById('newsletter-form');\n    if (newsletterForm) {\n      newsletterForm.addEventListener('submit', async e => {\n        e.preventDefault();\n        const email = newsletterForm.querySelector('input[type=\"email\"]').value;\n        if (!validateEmail(email)) {\n          showNotification('Please enter a valid email', 'error');\n          return;\n        }\n        try {\n          const result = await apiRequest(config.endpoints.newsletter, {\n            method: 'POST',\n            body: JSON.stringify({\n              email\n            })\n          });\n          if (result.success) {\n            showNotification('âœ… Subscribed to newsletter!', 'success');\n            newsletterForm.reset();\n          }\n        } catch (error) {\n          showNotification('Subscription failed', 'error');\n        }\n      });\n    }\n\n    // Contact form\n    const contactForm = document.getElementById('contact-form');\n    if (contactForm) {\n      contactForm.addEventListener('submit', async e => {\n        e.preventDefault();\n        const formData = new FormData(contactForm);\n        const data = Object.fromEntries(formData.entries());\n        try {\n          const result = await apiRequest(config.endpoints.contact, {\n            method: 'POST',\n            body: JSON.stringify(data)\n          });\n          if (result.success) {\n            showNotification('âœ… Message sent!', 'success');\n            contactForm.reset();\n          }\n        } catch (error) {\n          showNotification('Failed to send message', 'error');\n        }\n      });\n    }\n\n    // Footer newsletter form\n    const footerNewsletterForm = document.querySelector('.footer-newsletter-form');\n    if (footerNewsletterForm) {\n      footerNewsletterForm.addEventListener('submit', async e => {\n        e.preventDefault();\n        const email = footerNewsletterForm.querySelector('input[type=\"email\"]').value;\n        if (!validateEmail(email)) {\n          showNotification('Please enter a valid email', 'error');\n          return;\n        }\n        try {\n          const result = await apiRequest(config.endpoints.newsletter, {\n            method: 'POST',\n            body: JSON.stringify({\n              email\n            })\n          });\n          if (result.success) {\n            showNotification('âœ… Subscribed to newsletter!', 'success');\n            footerNewsletterForm.reset();\n          }\n        } catch (error) {\n          showNotification('Subscription failed', 'error');\n        }\n      });\n    }\n  }\n\n  // ===============================\n  // EVENT HANDLERS\n  // ===============================\n\n  function setupEventListeners() {\n    console.log('Setting up event listeners...');\n\n    // Main navigation links\n    document.addEventListener('click', e => {\n      // Handle navbar links\n      if (e.target.matches('.nav-link[data-page]') || e.target.closest('.nav-link[data-page]')) {\n        e.preventDefault();\n        const link = e.target.matches('.nav-link[data-page]') ? e.target : e.target.closest('.nav-link[data-page]');\n        const pageId = link.dataset.page;\n        handlePageNavigation(pageId);\n      }\n\n      // Handle footer links\n      if (e.target.matches('footer a[data-page]') || e.target.closest('footer a[data-page]')) {\n        e.preventDefault();\n        const link = e.target.matches('footer a[data-page]') ? e.target : e.target.closest('footer a[data-page]');\n        const pageId = link.dataset.page;\n        handlePageNavigation(pageId);\n      }\n\n      // Handle read more links\n      if (e.target.matches('.read-more-link[data-page]') || e.target.closest('.read-more-link[data-page]')) {\n        e.preventDefault();\n        const link = e.target.matches('.read-more-link[data-page]') ? e.target : e.target.closest('.read-more-link[data-page]');\n        const pageId = link.dataset.page;\n        handlePageNavigation(pageId);\n      }\n\n      // Handle booking buttons\n      if (e.target.matches('.book-now') || e.target.closest('.book-now')) {\n        e.preventDefault();\n        const button = e.target.matches('.book-now') ? e.target : e.target.closest('.book-now');\n        const type = button.dataset.type;\n        const id = button.dataset.id;\n        const name = button.dataset.name;\n        if (isAuthenticated) {\n          showEnhancedBookingModal(type, id, name);\n        } else {\n          showNotification('Please login to book services', 'info');\n          showAuthModal('login');\n        }\n      }\n\n      // Handle plan trip buttons\n      if (e.target.matches('.plan-trip-btn') || e.target.closest('.plan-trip-btn')) {\n        e.preventDefault();\n        if (isAuthenticated) {\n          showTripPlanModal();\n        } else {\n          showNotification('Please login to plan a trip', 'info');\n          showAuthModal('login');\n        }\n      }\n\n      // Handle view all links in dashboard\n      if (e.target.matches('.view-all[data-tab]') || e.target.closest('.view-all[data-tab]')) {\n        e.preventDefault();\n        const link = e.target.matches('.view-all[data-tab]') ? e.target : e.target.closest('.view-all[data-tab]');\n        const tab = link.dataset.tab;\n\n        // Switch to the specified tab\n        const dashboard = document.getElementById('dashboard');\n        if (dashboard) {\n          document.querySelectorAll('.dashboard-tab-link').forEach(l => l.classList.remove('active'));\n          document.querySelectorAll('.dashboard-tab-container').forEach(c => c.classList.remove('active'));\n          document.querySelector(`.dashboard-tab-link[data-tab=\"${tab}\"]`).classList.add('active');\n          document.getElementById(`dashboard-${tab}`).classList.add('active');\n        }\n      }\n    });\n\n    // Auth dropdown\n    const authToggle = document.getElementById('auth-toggle');\n    const authDropdown = document.getElementById('auth-dropdown-menu');\n    if (authToggle && authDropdown) {\n      authToggle.addEventListener('click', e => {\n        e.stopPropagation();\n        authDropdown.classList.toggle('show');\n      });\n      document.addEventListener('click', e => {\n        if (!authToggle.contains(e.target) && !authDropdown.contains(e.target)) {\n          authDropdown.classList.remove('show');\n        }\n      });\n    }\n\n    // Mobile menu\n    const mobileMenuBtn = document.querySelector('.mobile-menu-btn');\n    const navLinks = document.getElementById('nav-links');\n    if (mobileMenuBtn && navLinks) {\n      mobileMenuBtn.addEventListener('click', () => {\n        navLinks.classList.toggle('active');\n        mobileMenuBtn.classList.toggle('active');\n      });\n\n      // Close mobile menu when clicking outside\n      document.addEventListener('click', e => {\n        if (!mobileMenuBtn.contains(e.target) && !navLinks.contains(e.target)) {\n          navLinks.classList.remove('active');\n          mobileMenuBtn.classList.remove('active');\n        }\n      });\n\n      // Close mobile menu when clicking a link\n      navLinks.addEventListener('click', e => {\n        if (e.target.tagName === 'A') {\n          navLinks.classList.remove('active');\n          mobileMenuBtn.classList.remove('active');\n        }\n      });\n    }\n\n    // Handle browser back/forward\n    window.addEventListener('popstate', () => {\n      const hash = window.location.hash.replace('#', '') || 'home';\n      showPage(hash, false);\n    });\n\n    // Handle initial hash\n    if (window.location.hash) {\n      const hash = window.location.hash.replace('#', '');\n      if (hash) {\n        setTimeout(() => {\n          showPage(hash, false);\n        }, 100);\n      }\n    }\n  }\n  function handlePageNavigation(pageId) {\n    var _currentUser0;\n    console.log('Navigating to:', pageId);\n\n    // Authentication checks\n    if ((pageId === 'dashboard' || pageId === 'admin') && !isAuthenticated) {\n      showNotification('Please login to access this page', 'warning');\n      showAuthModal('login');\n      return;\n    }\n    if (pageId === 'admin' && ((_currentUser0 = currentUser) === null || _currentUser0 === void 0 ? void 0 : _currentUser0.role) !== 'admin') {\n      showNotification('Admin access required', 'error');\n      return;\n    }\n    showPage(pageId);\n  }\n\n  // ===============================\n  // ADMIN FUNCTIONS\n  // ===============================\n\n  function viewUserDetails(userId) {\n    const user = userManager.users.find(u => u._id === userId);\n    if (!user) {\n      showNotification('User not found', 'error');\n      return;\n    }\n    const modal = createModal();\n    modal.innerHTML = `\n            <div class=\"modal-header\">\n                <h2><i class=\"fas fa-user-circle\"></i> User Details</h2>\n                <button class=\"modal-close\">&times;</button>\n            </div>\n            \n            <div class=\"modal-body\">\n                <div class=\"user-details\">\n                    <div class=\"user-header\">\n                        <div class=\"user-avatar-large\">\n                            <i class=\"fas fa-user-circle\"></i>\n                        </div>\n                        <div class=\"user-info\">\n                            <h3>${user.name}</h3>\n                            <p>${user.email}</p>\n                            <div class=\"user-badges\">\n                                <span class=\"badge badge-${user.role === 'admin' ? 'danger' : 'primary'}\">\n                                    ${user.role.toUpperCase()}\n                                </span>\n                                <span class=\"badge badge-${user.status === 'active' ? 'success' : 'secondary'}\">\n                                    ${user.status.toUpperCase()}\n                                </span>\n                            </div>\n                        </div>\n                    </div>\n                    \n                    <div class=\"user-details-grid\">\n                        <div class=\"detail-item\">\n                            <label><i class=\"fas fa-phone\"></i> Phone</label>\n                            <p>${user.phone || 'Not provided'}</p>\n                        </div>\n                        <div class=\"detail-item\">\n                            <label><i class=\"fas fa-globe\"></i> Country</label>\n                            <p>${user.country || 'Not provided'}</p>\n                        </div>\n                        <div class=\"detail-item\">\n                            <label><i class=\"fas fa-calendar-plus\"></i> Joined</label>\n                            <p>${new Date(user.createdAt).toLocaleDateString()}</p>\n                        </div>\n                        <div class=\"detail-item\">\n                            <label><i class=\"fas fa-sign-in-alt\"></i> Last Login</label>\n                            <p>${user.lastLogin ? new Date(user.lastLogin).toLocaleDateString() : 'Never'}</p>\n                        </div>\n                    </div>\n                    \n                    <div class=\"user-stats\">\n                        <h4><i class=\"fas fa-chart-bar\"></i> User Statistics</h4>\n                        <div class=\"stats-grid\">\n                            <div class=\"stat-card\">\n                                <div class=\"stat-number\">\n                                    ${userManager.getUserBookings(user._id).length}\n                                </div>\n                                <div class=\"stat-label\">Total Bookings</div>\n                            </div>\n                            <div class=\"stat-card\">\n                                <div class=\"stat-number\">\n                                    $${userManager.getUserBookings(user._id).filter(b => b.status === 'confirmed').reduce((sum, b) => sum + (b.totalAmount || 0), 0)}\n                                </div>\n                                <div class=\"stat-label\">Total Spent</div>\n                            </div>\n                            <div class=\"stat-card\">\n                                <div class=\"stat-number\">\n                                    ${userManager.tripPlans.filter(t => t.userId === user._id).length}\n                                </div>\n                                <div class=\"stat-label\">Trip Plans</div>\n                            </div>\n                        </div>\n                    </div>\n                    \n                    <div class=\"user-actions\">\n                        <button class=\"btn btn-primary\" onclick=\"editUser(${user._id})\">\n                            <i class=\"fas fa-edit\"></i> Edit User\n                        </button>\n                        ${user.role !== 'admin' ? `\n                            <button class=\"btn btn-danger\" onclick=\"deleteUserConfirm(${user._id})\">\n                                <i class=\"fas fa-trash\"></i> Delete User\n                            </button>\n                        ` : ''}\n                    </div>\n                </div>\n            </div>\n        `;\n  }\n  function editUser(userId) {\n    const user = userManager.users.find(u => u._id === userId);\n    if (!user) {\n      showNotification('User not found', 'error');\n      return;\n    }\n    const modal = createModal();\n    modal.innerHTML = `\n            <div class=\"modal-header\">\n                <h2><i class=\"fas fa-edit\"></i> Edit User</h2>\n                <button class=\"modal-close\">&times;</button>\n            </div>\n            \n            <div class=\"modal-body\">\n                <form id=\"edit-user-form\">\n                    <input type=\"hidden\" name=\"user_id\" value=\"${user._id}\">\n                    \n                    <div class=\"form-section\">\n                        <h4>Basic Information</h4>\n                        <div class=\"form-row\">\n                            <div class=\"form-group\">\n                                <label>Full Name *</label>\n                                <input type=\"text\" name=\"name\" value=\"${user.name}\" required>\n                            </div>\n                            <div class=\"form-group\">\n                                <label>Email *</label>\n                                <input type=\"email\" name=\"email\" value=\"${user.email}\" required>\n                            </div>\n                        </div>\n                    </div>\n                    \n                    <div class=\"form-section\">\n                        <h4>Role & Status</h4>\n                        <div class=\"form-row\">\n                            <div class=\"form-group\">\n                                <label>User Role *</label>\n                                <select name=\"role\" required>\n                                    <option value=\"user\" ${user.role === 'user' ? 'selected' : ''}>User (Customer)</option>\n                                    <option value=\"admin\" ${user.role === 'admin' ? 'selected' : ''}>Administrator</option>\n                                    <option value=\"agent\" ${user.role === 'agent' ? 'selected' : ''}>Travel Agent</option>\n                                    <option value=\"guide\" ${user.role === 'guide' ? 'selected' : ''}>Tour Guide</option>\n                                </select>\n                            </div>\n                            <div class=\"form-group\">\n                                <label>Status</label>\n                                <select name=\"status\">\n                                    <option value=\"active\" ${user.status === 'active' ? 'selected' : ''}>Active</option>\n                                    <option value=\"inactive\" ${user.status === 'inactive' ? 'selected' : ''}>Inactive</option>\n                                    <option value=\"pending\" ${user.status === 'pending' ? 'selected' : ''}>Pending</option>\n                                </select>\n                            </div>\n                        </div>\n                    </div>\n                    \n                    <div class=\"form-section\">\n                        <h4>Contact Information</h4>\n                        <div class=\"form-row\">\n                            <div class=\"form-group\">\n                                <label>Phone Number</label>\n                                <input type=\"tel\" name=\"phone\" value=\"${user.phone || ''}\">\n                            </div>\n                            <div class=\"form-group\">\n                                <label>Country</label>\n                                <input type=\"text\" name=\"country\" value=\"${user.country || ''}\">\n                            </div>\n                        </div>\n                    </div>\n                    \n                    <div class=\"form-section\">\n                        <h4>Change Password (Optional)</h4>\n                        <div class=\"form-row\">\n                            <div class=\"form-group\">\n                                <label>New Password</label>\n                                <input type=\"password\" name=\"new_password\" minlength=\"6\">\n                            </div>\n                            <div class=\"form-group\">\n                                <label>Confirm Password</label>\n                                <input type=\"password\" name=\"confirm_password\" minlength=\"6\">\n                            </div>\n                        </div>\n                    </div>\n                    \n                    <div class=\"form-actions\">\n                        <button type=\"submit\" class=\"btn btn-primary\">\n                            <i class=\"fas fa-save\"></i> Save Changes\n                        </button>\n                        <button type=\"button\" class=\"btn btn-outline\" onclick=\"closeModal()\">\n                            Cancel\n                        </button>\n                    </div>\n                </form>\n            </div>\n        `;\n    const form = modal.querySelector('#edit-user-form');\n    form.addEventListener('submit', function (e) {\n      e.preventDefault();\n      const formData = new FormData(this);\n      const data = Object.fromEntries(formData.entries());\n\n      // Validate passwords if provided\n      if (data.new_password && data.new_password !== data.confirm_password) {\n        showNotification('âŒ Passwords do not match', 'error');\n        return;\n      }\n\n      // Prepare update data\n      const updateData = {\n        name: data.name,\n        email: data.email,\n        role: data.role,\n        status: data.status,\n        phone: data.phone,\n        country: data.country\n      };\n\n      // Add password if changed\n      if (data.new_password) {\n        updateData.password = data.new_password;\n      }\n      try {\n        const updatedUser = userManager.updateUser(parseInt(data.user_id), updateData);\n        showNotification(`âœ… User ${updatedUser.name} updated successfully!`, 'success');\n        closeModal();\n\n        // Refresh admin dashboard\n        setTimeout(() => {\n          loadAdminDashboard();\n        }, 500);\n      } catch (error) {\n        showNotification(`âŒ Error updating user: ${error.message}`, 'error');\n      }\n    });\n  }\n  function deleteUserConfirm(userId) {\n    if (!confirm('Are you sure you want to delete this user? This action cannot be undone.')) {\n      return;\n    }\n    try {\n      const user = userManager.users.find(u => u._id === userId);\n      if (!user) {\n        showNotification('User not found', 'error');\n        return;\n      }\n      if (user.role === 'admin') {\n        showNotification('Cannot delete admin users', 'error');\n        return;\n      }\n      const success = userManager.deleteUser(userId);\n      if (success) {\n        showNotification('âœ… User deleted successfully!', 'success');\n        closeModal();\n\n        // Refresh admin dashboard\n        setTimeout(() => {\n          loadAdminDashboard();\n        }, 500);\n      }\n    } catch (error) {\n      showNotification(`âŒ Error deleting user: ${error.message}`, 'error');\n    }\n  }\n  function confirmBooking(bookingId) {\n    try {\n      const booking = userManager.confirmBooking(bookingId);\n      showNotification(`âœ… Booking ${bookingId} confirmed!`, 'success');\n\n      // Refresh admin dashboard\n      setTimeout(() => {\n        loadAdminDashboard();\n      }, 500);\n    } catch (error) {\n      showNotification(`âŒ Error confirming booking: ${error.message}`, 'error');\n    }\n  }\n  function viewBookingDetails(bookingId) {\n    const booking = userManager.bookings.find(b => b._id === bookingId);\n    if (!booking) {\n      showNotification('Booking not found', 'error');\n      return;\n    }\n    const modal = createModal();\n    modal.innerHTML = `\n            <div class=\"modal-header\">\n                <h2><i class=\"fas fa-calendar-check\"></i> Booking Details</h2>\n                <button class=\"modal-close\">&times;</button>\n            </div>\n            \n            <div class=\"modal-body\">\n                <div class=\"booking-details\">\n                    <div class=\"booking-header\">\n                        <div class=\"booking-id\">\n                            <h3>${booking._id}</h3>\n                            <span class=\"badge badge-${booking.status}\">${booking.status.toUpperCase()}</span>\n                        </div>\n                        <div class=\"booking-date\">\n                            <small>Created: ${new Date(booking.createdAt).toLocaleDateString()}</small>\n                        </div>\n                    </div>\n                    \n                    <div class=\"booking-info-grid\">\n                        <div class=\"info-section\">\n                            <h4><i class=\"fas fa-info-circle\"></i> Service Details</h4>\n                            <div class=\"info-item\">\n                                <label>Service Type</label>\n                                <p>${booking.serviceType}</p>\n                            </div>\n                            <div class=\"info-item\">\n                                <label>Service Name</label>\n                                <p>${booking.serviceName}</p>\n                            </div>\n                            <div class=\"info-item\">\n                                <label>Service ID</label>\n                                <p>${booking.serviceId || 'N/A'}</p>\n                            </div>\n                        </div>\n                        \n                        <div class=\"info-section\">\n                            <h4><i class=\"fas fa-user\"></i> Customer Details</h4>\n                            <div class=\"info-item\">\n                                <label>Customer Name</label>\n                                <p>${booking.userName}</p>\n                            </div>\n                            <div class=\"info-item\">\n                                <label>Email</label>\n                                <p>${booking.userEmail}</p>\n                            </div>\n                            <div class=\"info-item\">\n                                <label>Phone</label>\n                                <p>${booking.phone || 'N/A'}</p>\n                            </div>\n                        </div>\n                        \n                        <div class=\"info-section\">\n                            <h4><i class=\"fas fa-calendar-alt\"></i> Booking Dates</h4>\n                            <div class=\"info-item\">\n                                <label>Start Date</label>\n                                <p>${new Date(booking.date).toLocaleDateString()}</p>\n                            </div>\n                            <div class=\"info-item\">\n                                <label>Duration</label>\n                                <p>${booking.duration || 1} days</p>\n                            </div>\n                            <div class=\"info-item\">\n                                <label>End Date</label>\n                                <p>${booking.endDate ? new Date(booking.endDate).toLocaleDateString() : 'N/A'}</p>\n                            </div>\n                        </div>\n                        \n                        <div class=\"info-section\">\n                            <h4><i class=\"fas fa-file-invoice-dollar\"></i> Payment Details</h4>\n                            <div class=\"info-item\">\n                                <label>Total Amount</label>\n                                <p class=\"amount\">$${booking.totalAmount || '0'}</p>\n                            </div>\n                            <div class=\"info-item\">\n                                <label>Payment Method</label>\n                                <p>${booking.payment_method || 'Not specified'}</p>\n                            </div>\n                            <div class=\"info-item\">\n                                <label>Travelers</label>\n                                <p>${booking.travelers || 1} person(s)</p>\n                            </div>\n                        </div>\n                    </div>\n                    \n                    ${booking.notes ? `\n                        <div class=\"info-section\">\n                            <h4><i class=\"fas fa-comment\"></i> Special Requirements</h4>\n                            <div class=\"notes-container\">\n                                <p>${booking.notes}</p>\n                            </div>\n                        </div>\n                    ` : ''}\n                    \n                    <div class=\"booking-actions\">\n                        <button class=\"btn btn-primary\" onclick=\"downloadBookingInvoice('${booking._id}')\">\n                            <i class=\"fas fa-download\"></i> Download Invoice\n                        </button>\n                        ${currentUser.role === 'admin' && booking.status === 'pending' ? `\n                            <button class=\"btn btn-success\" onclick=\"confirmBooking('${booking._id}')\">\n                                <i class=\"fas fa-check\"></i> Confirm Booking\n                            </button>\n                            <button class=\"btn btn-danger\" onclick=\"cancelBookingAdmin('${booking._id}')\">\n                                <i class=\"fas fa-times\"></i> Cancel Booking\n                            </button>\n                        ` : ''}\n                        ${currentUser.role === 'user' && booking.status === 'pending' ? `\n                            <button class=\"btn btn-danger\" onclick=\"cancelBooking('${booking._id}')\">\n                                <i class=\"fas fa-times\"></i> Cancel Booking\n                            </button>\n                        ` : ''}\n                    </div>\n                </div>\n            </div>\n        `;\n  }\n  function downloadBookingInvoice(bookingId) {\n    const booking = userManager.bookings.find(b => b._id === bookingId);\n    if (!booking) {\n      showNotification('Booking not found', 'error');\n      return;\n    }\n\n    // Create invoice HTML\n    const invoiceHTML = `\n            <!DOCTYPE html>\n            <html>\n            <head>\n                <title>Invoice ${booking._id}</title>\n                <style>\n                    body { font-family: Arial, sans-serif; margin: 40px; }\n                    .invoice-header { border-bottom: 2px solid #333; padding-bottom: 20px; margin-bottom: 30px; }\n                    .invoice-details { margin: 20px 0; }\n                    .invoice-table { width: 100%; border-collapse: collapse; margin: 20px 0; }\n                    .invoice-table th, .invoice-table td { border: 1px solid #ddd; padding: 10px; text-align: left; }\n                    .invoice-total { text-align: right; margin-top: 20px; }\n                    .footer { margin-top: 50px; font-size: 12px; color: #666; }\n                </style>\n            </head>\n            <body>\n                <div class=\"invoice-header\">\n                    <h1>GO TRIP RWANDA</h1>\n                    <h2>INVOICE</h2>\n                    <p><strong>Invoice #:</strong> ${booking._id}</p>\n                    <p><strong>Date:</strong> ${new Date().toLocaleDateString()}</p>\n                </div>\n                \n                <div class=\"invoice-details\">\n                    <h3>Bill To:</h3>\n                    <p>${booking.userName}<br>\n                    ${booking.userEmail}<br>\n                    ${booking.phone || ''}</p>\n                </div>\n                \n                <table class=\"invoice-table\">\n                    <thead>\n                        <tr>\n                            <th>Description</th>\n                            <th>Date</th>\n                            <th>Travelers</th>\n                            <th>Amount</th>\n                        </tr>\n                    </thead>\n                    <tbody>\n                        <tr>\n                            <td>${booking.serviceName} (${booking.serviceType})</td>\n                            <td>${new Date(booking.date).toLocaleDateString()}</td>\n                            <td>${booking.travelers || 1}</td>\n                            <td>$${booking.totalAmount || '0'}</td>\n                        </tr>\n                    </tbody>\n                </table>\n                \n                <div class=\"invoice-total\">\n                    <h3>Total Amount: $${booking.totalAmount || '0'}</h3>\n                </div>\n                \n                <div class=\"footer\">\n                    <p>Thank you for choosing Go Trip Rwanda!</p>\n                    <p>For any queries, contact: info@gotrip.africa | +250 787 407 051</p>\n                </div>\n            </body>\n            </html>\n        `;\n\n    // Create and download the invoice\n    const blob = new Blob([invoiceHTML], {\n      type: 'text/html'\n    });\n    const url = URL.createObjectURL(blob);\n    const a = document.createElement('a');\n    a.href = url;\n    a.download = `invoice-${booking._id}.html`;\n    document.body.appendChild(a);\n    a.click();\n    document.body.removeChild(a);\n    URL.revokeObjectURL(url);\n    showNotification('âœ… Invoice downloaded successfully!', 'success');\n  }\n  function cancelBooking(bookingId) {\n    if (!confirm('Are you sure you want to cancel this booking?')) return;\n    try {\n      const booking = userManager.cancelBooking(bookingId);\n      showNotification('âœ… Booking cancelled successfully!', 'success');\n\n      // Refresh dashboard\n      setTimeout(() => {\n        loadDashboard();\n      }, 500);\n    } catch (error) {\n      showNotification('âŒ Error cancelling booking', 'error');\n    }\n  }\n  function cancelBookingAdmin(bookingId) {\n    if (!confirm('Are you sure you want to cancel this booking?')) {\n      return;\n    }\n    try {\n      const booking = userManager.cancelBooking(bookingId);\n      showNotification(`âœ… Booking ${bookingId} cancelled!`, 'success');\n\n      // Refresh dashboard\n      setTimeout(() => {\n        if (currentUser.role === 'admin') {\n          loadAdminDashboard();\n        } else {\n          loadDashboard();\n        }\n      }, 500);\n    } catch (error) {\n      showNotification(`âŒ Error cancelling booking: ${error.message}`, 'error');\n    }\n  }\n  function viewTripPlanAdmin(tripId) {\n    const trip = userManager.tripPlans.find(t => t._id === tripId);\n    if (!trip) {\n      showNotification('Trip plan not found', 'error');\n      return;\n    }\n    const modal = createModal();\n    modal.innerHTML = `\n            <div class=\"modal-header\">\n                <h2><i class=\"fas fa-route\"></i> Trip Plan Details</h2>\n                <button class=\"modal-close\">&times;</button>\n            </div>\n            \n            <div class=\"modal-body\">\n                <div class=\"trip-plan-details-admin\">\n                    <div class=\"trip-header\">\n                        <div class=\"trip-id\">\n                            <h3>${trip._id}</h3>\n                            <span class=\"badge badge-${trip.status}\">${trip.status.toUpperCase()}</span>\n                        </div>\n                        <div class=\"trip-date\">\n                            <small>Requested: ${new Date(trip.createdAt).toLocaleDateString()}</small>\n                        </div>\n                    </div>\n                    \n                    <div class=\"trip-info-grid\">\n                        <div class=\"info-section\">\n                            <h4><i class=\"fas fa-user\"></i> Customer Information</h4>\n                            <div class=\"info-item\">\n                                <label>Name</label>\n                                <p>${trip.userName}</p>\n                            </div>\n                            <div class=\"info-item\">\n                                <label>Email</label>\n                                <p>${trip.userEmail}</p>\n                            </div>\n                            <div class=\"info-item\">\n                                <label>Travelers</label>\n                                <p>${trip.travelers} people</p>\n                            </div>\n                        </div>\n                        \n                        <div class=\"info-section\">\n                            <h4><i class=\"fas fa-calendar-alt\"></i> Trip Details</h4>\n                            <div class=\"info-item\">\n                                <label>Start Date</label>\n                                <p>${new Date(trip.startDate).toLocaleDateString()}</p>\n                            </div>\n                            <div class=\"info-item\">\n                                <label>Duration</label>\n                                <p>${trip.duration}</p>\n                            </div>\n                            <div class=\"info-item\">\n                                <label>Budget</label>\n                                <p>${trip.budget}</p>\n                            </div>\n                        </div>\n                    </div>\n                    \n                    ${trip.interests && trip.interests.length > 0 ? `\n                        <div class=\"info-section\">\n                            <h4><i class=\"fas fa-heart\"></i> Interests</h4>\n                            <div class=\"interests-container\">\n                                ${trip.interests.map(interest => `\n                                    <span class=\"interest-tag\">${interest}</span>\n                                `).join('')}\n                            </div>\n                        </div>\n                    ` : ''}\n                    \n                    ${trip.message ? `\n                        <div class=\"info-section\">\n                            <h4><i class=\"fas fa-comment\"></i> Customer Message</h4>\n                            <div class=\"message-container\">\n                                <p>${trip.message}</p>\n                            </div>\n                        </div>\n                    ` : ''}\n                    \n                    <div class=\"trip-actions-admin\">\n                        ${trip.status === 'review' ? `\n                            <button class=\"btn btn-success\" onclick=\"processTripPlan('${trip._id}')\">\n                                <i class=\"fas fa-cogs\"></i> Process Trip Plan\n                            </button>\n                        ` : ''}\n                        <button class=\"btn btn-outline\" onclick=\"downloadTripPlan('${trip._id}')\">\n                            <i class=\"fas fa-download\"></i> Export\n                        </button>\n                    </div>\n                </div>\n            </div>\n        `;\n  }\n  function processTripPlan(tripId) {\n    const trip = userManager.updateTripPlan(tripId, {\n      status: 'processing',\n      assignedTo: currentUser.name,\n      assignedAt: new Date().toISOString()\n    });\n    showNotification(`âœ… Trip plan ${tripId} is now being processed!`, 'success');\n    closeModal();\n\n    // Refresh admin dashboard\n    setTimeout(() => {\n      loadAdminDashboard();\n    }, 500);\n  }\n  function viewTripPlan(tripId) {\n    const trip = userManager.tripPlans.find(t => t._id === tripId);\n    if (!trip) {\n      showNotification('Trip plan not found', 'error');\n      return;\n    }\n    const modal = createModal();\n    modal.innerHTML = `\n            <div class=\"modal-header\">\n                <h2><i class=\"fas fa-route\"></i> Trip Plan Details</h2>\n                <button class=\"modal-close\">&times;</button>\n            </div>\n            \n            <div class=\"modal-body\">\n                <div class=\"trip-plan-details-admin\">\n                    <div class=\"trip-header\">\n                        <div class=\"trip-id\">\n                            <h3>${trip._id}</h3>\n                            <span class=\"badge badge-${trip.status}\">${trip.status.toUpperCase()}</span>\n                        </div>\n                        <div class=\"trip-date\">\n                            <small>Requested: ${new Date(trip.createdAt).toLocaleDateString()}</small>\n                        </div>\n                    </div>\n                    \n                    <div class=\"trip-info-grid\">\n                        <div class=\"info-section\">\n                            <h4><i class=\"fas fa-user\"></i> Your Information</h4>\n                            <div class=\"info-item\">\n                                <label>Name</label>\n                                <p>${trip.userName}</p>\n                            </div>\n                            <div class=\"info-item\">\n                                <label>Email</label>\n                                <p>${trip.userEmail}</p>\n                            </div>\n                            <div class=\"info-item\">\n                                <label>Travelers</label>\n                                <p>${trip.travelers} people</p>\n                            </div>\n                        </div>\n                        \n                        <div class=\"info-section\">\n                            <h4><i class=\"fas fa-calendar-alt\"></i> Trip Details</h4>\n                            <div class=\"info-item\">\n                                <label>Start Date</label>\n                                <p>${new Date(trip.startDate).toLocaleDateString()}</p>\n                            </div>\n                            <div class=\"info-item\">\n                                <label>Duration</label>\n                                <p>${trip.duration}</p>\n                            </div>\n                            <div class=\"info-item\">\n                                <label>Budget</label>\n                                <p>${trip.budget}</p>\n                            </div>\n                        </div>\n                    </div>\n                    \n                    ${trip.interests && trip.interests.length > 0 ? `\n                        <div class=\"info-section\">\n                            <h4><i class=\"fas fa-heart\"></i> Your Interests</h4>\n                            <div class=\"interests-container\">\n                                ${trip.interests.map(interest => `\n                                    <span class=\"interest-tag\">${interest}</span>\n                                `).join('')}\n                            </div>\n                        </div>\n                    ` : ''}\n                    \n                    ${trip.message ? `\n                        <div class=\"info-section\">\n                            <h4><i class=\"fas fa-comment\"></i> Your Message</h4>\n                            <div class=\"message-container\">\n                                <p>${trip.message}</p>\n                            </div>\n                        </div>\n                    ` : ''}\n                    \n                    ${trip.assignedTo ? `\n                        <div class=\"info-section\">\n                            <h4><i class=\"fas fa-user-tie\"></i> Assigned To</h4>\n                            <div class=\"assigned-info\">\n                                <p><strong>${trip.assignedTo}</strong></p>\n                                <small>Assigned on: ${new Date(trip.assignedAt).toLocaleDateString()}</small>\n                            </div>\n                        </div>\n                    ` : ''}\n                    \n                    <div class=\"trip-status-info\">\n                        <div class=\"status-message\">\n                            ${trip.status === 'review' ? `\n                                <i class=\"fas fa-clock text-warning\"></i>\n                                <div>\n                                    <h5>Under Review</h5>\n                                    <p>Our team is reviewing your trip plan. We'll contact you within 24 hours.</p>\n                                </div>\n                            ` : trip.status === 'processing' ? `\n                                <i class=\"fas fa-cogs text-info\"></i>\n                                <div>\n                                    <h5>Processing</h5>\n                                    <p>Our travel experts are creating your customized itinerary.</p>\n                                </div>\n                            ` : trip.status === 'completed' ? `\n                                <i class=\"fas fa-check-circle text-success\"></i>\n                                <div>\n                                    <h5>Completed</h5>\n                                    <p>Your trip plan is ready! Check your email for the complete itinerary.</p>\n                                </div>\n                            ` : ''}\n                        </div>\n                    </div>\n                </div>\n            </div>\n        `;\n  }\n  function editTripPlan(tripId) {\n    const trip = userManager.tripPlans.find(t => t._id === tripId);\n    if (!trip) {\n      showNotification('Trip plan not found', 'error');\n      return;\n    }\n    showTripPlanModal();\n    // Note: For simplicity, we're just showing the trip plan modal again\n    // In a real application, you would populate the form with existing data\n  }\n  function cancelTripPlan(tripId) {\n    if (!confirm('Are you sure you want to cancel this trip plan?')) return;\n    try {\n      const trip = userManager.updateTripPlan(tripId, {\n        status: 'cancelled'\n      });\n      showNotification('âœ… Trip plan cancelled successfully!', 'success');\n\n      // Refresh dashboard\n      setTimeout(() => {\n        loadDashboard();\n      }, 500);\n    } catch (error) {\n      showNotification('âŒ Error cancelling trip plan', 'error');\n    }\n  }\n  function downloadItinerary(tripId) {\n    const trip = userManager.tripPlans.find(t => t._id === tripId);\n    if (!trip || !trip.itinerary) {\n      showNotification('Itinerary not available yet', 'warning');\n      return;\n    }\n\n    // Create itinerary HTML\n    const itineraryHTML = `\n            <!DOCTYPE html>\n            <html>\n            <head>\n                <title>Itinerary ${trip._id}</title>\n                <style>\n                    body { font-family: Arial, sans-serif; margin: 40px; }\n                    .header { border-bottom: 2px solid #333; padding-bottom: 20px; margin-bottom: 30px; }\n                    .day-section { margin: 30px 0; border-left: 4px solid #4CAF50; padding-left: 20px; }\n                    .activity { margin: 15px 0; padding: 10px; background: #f5f5f5; border-radius: 5px; }\n                    .footer { margin-top: 50px; font-size: 12px; color: #666; }\n                </style>\n            </head>\n            <body>\n                <div class=\"header\">\n                    <h1>GO TRIP RWANDA</h1>\n                    <h2>TRIP ITINERARY</h2>\n                    <p><strong>Trip ID:</strong> ${trip._id}</p>\n                    <p><strong>Customer:</strong> ${trip.userName}</p>\n                    <p><strong>Duration:</strong> ${trip.duration}</p>\n                    <p><strong>Budget:</strong> ${trip.budget}</p>\n                </div>\n                \n                ${trip.itinerary.days.map(day => `\n                    <div class=\"day-section\">\n                        <h3>Day ${day.day}: ${day.title}</h3>\n                        ${day.activities.map(activity => `\n                            <div class=\"activity\">\n                                <h4>${activity.time}</h4>\n                                <p><strong>${activity.description}</strong></p>\n                                ${activity.location ? `<p><i>Location:</i> ${activity.location}</p>` : ''}\n                            </div>\n                        `).join('')}\n                    </div>\n                `).join('')}\n                \n                ${trip.itinerary.total_cost ? `\n                    <div class=\"cost-summary\">\n                        <h3>Cost Summary</h3>\n                        <p><strong>Total Cost:</strong> $${trip.itinerary.total_cost.total || 'N/A'}</p>\n                    </div>\n                ` : ''}\n                \n                <div class=\"footer\">\n                    <p>Thank you for choosing Go Trip Rwanda!</p>\n                    <p>For any queries, contact: info@gotrip.africa | +250 787 407 051</p>\n                </div>\n            </body>\n            </html>\n        `;\n\n    // Create and download the itinerary\n    const blob = new Blob([itineraryHTML], {\n      type: 'text/html'\n    });\n    const url = URL.createObjectURL(blob);\n    const a = document.createElement('a');\n    a.href = url;\n    a.download = `itinerary-${trip._id}.html`;\n    document.body.appendChild(a);\n    a.click();\n    document.body.removeChild(a);\n    URL.revokeObjectURL(url);\n    showNotification('âœ… Itinerary downloaded successfully!', 'success');\n  }\n  function generateReport(type) {\n    let reportData;\n    let reportTitle;\n    switch (type) {\n      case 'revenue':\n        reportData = userManager.getMonthlyRevenue();\n        reportTitle = 'Monthly Revenue Report';\n        break;\n      case 'users':\n        reportData = {\n          total: userManager.users.length,\n          byRole: userManager.users.reduce((acc, user) => {\n            acc[user.role] = (acc[user.role] || 0) + 1;\n            return acc;\n          }, {}),\n          active: userManager.users.filter(u => u.status === 'active').length\n        };\n        reportTitle = 'User Statistics Report';\n        break;\n      case 'bookings':\n        reportData = {\n          total: userManager.bookings.length,\n          byStatus: userManager.bookings.reduce((acc, booking) => {\n            acc[booking.status] = (acc[booking.status] || 0) + 1;\n            return acc;\n          }, {}),\n          byType: userManager.bookings.reduce((acc, booking) => {\n            acc[booking.serviceType] = (acc[booking.serviceType] || 0) + 1;\n            return acc;\n          }, {})\n        };\n        reportTitle = 'Bookings Analysis Report';\n        break;\n      case 'full':\n        reportData = {\n          stats: userManager.getStats(),\n          monthlyRevenue: userManager.getMonthlyRevenue(),\n          recentActivity: userManager.getRecentActivity(),\n          topUsers: userManager.users.slice(0, 5),\n          topBookings: userManager.bookings.slice(0, 5)\n        };\n        reportTitle = 'Comprehensive System Report';\n        break;\n      default:\n        reportData = {};\n        reportTitle = 'Custom Report';\n    }\n\n    // Create report HTML\n    const reportHTML = `\n            <!DOCTYPE html>\n            <html>\n            <head>\n                <title>${reportTitle} - Go Trip</title>\n                <style>\n                    body { font-family: Arial, sans-serif; margin: 40px; }\n                    .report-header { border-bottom: 2px solid #333; padding-bottom: 20px; margin-bottom: 30px; }\n                    .report-section { margin: 30px 0; }\n                    .report-table { width: 100%; border-collapse: collapse; margin: 20px 0; }\n                    .report-table th, .report-table td { border: 1px solid #ddd; padding: 10px; text-align: left; }\n                    .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; }\n                    .stat-card { background: #f8f9fa; padding: 20px; border-radius: 5px; text-align: center; }\n                    .footer { margin-top: 50px; font-size: 12px; color: #666; }\n                </style>\n            </head>\n            <body>\n                <div class=\"report-header\">\n                    <h1>GO TRIP RWANDA</h1>\n                    <h2>${reportTitle}</h2>\n                    <p><strong>Generated:</strong> ${new Date().toLocaleString()}</p>\n                    <p><strong>Generated by:</strong> ${currentUser.name}</p>\n                </div>\n                \n                ${renderReportContent(type, reportData)}\n                \n                <div class=\"footer\">\n                    <p>This report was generated automatically by the Go Trip system.</p>\n                    <p>Â© ${new Date().getFullYear()} Go Trip Rwanda. All rights reserved.</p>\n                </div>\n            </body>\n            </html>\n        `;\n\n    // Download the report\n    const blob = new Blob([reportHTML], {\n      type: 'text/html'\n    });\n    const url = URL.createObjectURL(blob);\n    const a = document.createElement('a');\n    a.href = url;\n    a.download = `report-${type}-${Date.now()}.html`;\n    document.body.appendChild(a);\n    a.click();\n    document.body.removeChild(a);\n    URL.revokeObjectURL(url);\n    showNotification(`âœ… ${reportTitle} downloaded successfully!`, 'success');\n  }\n  function renderReportContent(type, data) {\n    switch (type) {\n      case 'revenue':\n        return `\n                    <div class=\"report-section\">\n                        <h3>Revenue Overview</h3>\n                        <table class=\"report-table\">\n                            <thead>\n                                <tr>\n                                    <th>Month</th>\n                                    <th>Revenue</th>\n                                    <th>Change</th>\n                                </tr>\n                            </thead>\n                            <tbody>\n                                ${data.map((item, index) => `\n                                    <tr>\n                                        <td>${item.month}</td>\n                                        <td>$${item.revenue.toLocaleString()}</td>\n                                        <td>${index > 0 ? ((item.revenue - data[index - 1].revenue) / data[index - 1].revenue * 100).toFixed(1) + '%' : 'N/A'}\n                                        </td>\n                                    </tr>\n                                `).join('')}\n                            </tbody>\n                        </table>\n                    </div>\n                `;\n      case 'users':\n        return `\n                    <div class=\"report-section\">\n                        <h3>User Statistics</h3>\n                        <div class=\"stats-grid\">\n                            <div class=\"stat-card\">\n                                <h4>Total Users</h4>\n                                <p class=\"stat-number\">${data.total}</p>\n                            </div>\n                            <div class=\"stat-card\">\n                                <h4>Active Users</h4>\n                                <p class=\"stat-number\">${data.active}</p>\n                            </div>\n                            <div class=\"stat-card\">\n                                <h4>Inactive Users</h4>\n                                <p class=\"stat-number\">${data.total - data.active}</p>\n                            </div>\n                        </div>\n                        \n                        <h4>Users by Role</h4>\n                        <table class=\"report-table\">\n                            <thead>\n                                <tr>\n                                    <th>Role</th>\n                                    <th>Count</th>\n                                    <th>Percentage</th>\n                                </tr>\n                            </thead>\n                            <tbody>\n                                ${Object.entries(data.byRole).map(([role, count]) => `\n                                    <tr>\n                                        <td>${role}</td>\n                                        <td>${count}</td>\n                                        <td>${(count / data.total * 100).toFixed(1)}%</td>\n                                    </tr>\n                                `).join('')}\n                            </tbody>\n                        </table>\n                    </div>\n                `;\n      case 'bookings':\n        return `\n                    <div class=\"report-section\">\n                        <h3>Booking Statistics</h3>\n                        <div class=\"stats-grid\">\n                            <div class=\"stat-card\">\n                                <h4>Total Bookings</h4>\n                                <p class=\"stat-number\">${data.total}</p>\n                            </div>\n                        </div>\n                        \n                        <h4>Bookings by Status</h4>\n                        <table class=\"report-table\">\n                            <thead>\n                                <tr>\n                                    <th>Status</th>\n                                    <th>Count</th>\n                                    <th>Percentage</th>\n                                </tr>\n                            </thead>\n                            <tbody>\n                                ${Object.entries(data.byStatus).map(([status, count]) => `\n                                    <tr>\n                                        <td>${status}</td>\n                                        <td>${count}</td>\n                                        <td>${(count / data.total * 100).toFixed(1)}%</td>\n                                    </tr>\n                                `).join('')}\n                            </tbody>\n                        </table>\n                        \n                        <h4>Bookings by Service Type</h4>\n                        <table class=\"report-table\">\n                            <thead>\n                                <tr>\n                                    <th>Service Type</th>\n                                    <th>Count</th>\n                                    <th>Percentage</th>\n                                </tr>\n                            </thead>\n                            <tbody>\n                                ${Object.entries(data.byType).map(([type, count]) => `\n                                    <tr>\n                                        <td>${type}</td>\n                                        <td>${count}</td>\n                                        <td>${(count / data.total * 100).toFixed(1)}%</td>\n                                    </tr>\n                                `).join('')}\n                            </tbody>\n                        </table>\n                    </div>\n                `;\n      case 'full':\n        return `\n                    <div class=\"report-section\">\n                        <h3>System Overview</h3>\n                        <div class=\"stats-grid\">\n                            <div class=\"stat-card\">\n                                <h4>Total Users</h4>\n                                <p class=\"stat-number\">${data.stats.totalUsers}</p>\n                            </div>\n                            <div class=\"stat-card\">\n                                <h4>Total Bookings</h4>\n                                <p class=\"stat-number\">${data.stats.totalBookings}</p>\n                            </div>\n                            <div class=\"stat-card\">\n                                <h4>Total Revenue</h4>\n                                <p class=\"stat-number\">$${data.stats.totalRevenue.toLocaleString()}</p>\n                            </div>\n                            <div class=\"stat-card\">\n                                <h4>Active Bookings</h4>\n                                <p class=\"stat-number\">${data.stats.activeBookings}</p>\n                            </div>\n                        </div>\n                    </div>\n                    \n                    <div class=\"report-section\">\n                        <h3>Recent Activity</h3>\n                        <table class=\"report-table\">\n                            <thead>\n                                <tr>\n                                    <th>Type</th>\n                                    <th>User</th>\n                                    <th>Action</th>\n                                    <th>Time</th>\n                                </tr>\n                            </thead>\n                            <tbody>\n                                ${data.recentActivity.slice(0, 10).map(activity => `\n                                    <tr>\n                                        <td>${activity.type}</td>\n                                        <td>${activity.name}</td>\n                                        <td>${activity.action}</td>\n                                        <td>${formatTimeAgo(activity.timestamp)}</td>\n                                    </tr>\n                                `).join('')}\n                            </tbody>\n                        </table>\n                    </div>\n                    \n                    <div class=\"report-section\">\n                        <h3>Top Users by Activity</h3>\n                        <table class=\"report-table\">\n                            <thead>\n                                <tr>\n                                    <th>User</th>\n                                    <th>Role</th>\n                                    <th>Status</th>\n                                    <th>Joined</th>\n                                </tr>\n                            </thead>\n                            <tbody>\n                                ${data.topUsers.map(user => `\n                                    <tr>\n                                        <td>${user.name}</td>\n                                        <td>${user.role}</td>\n                                        <td>${user.status}</td>\n                                        <td>${new Date(user.createdAt).toLocaleDateString()}</td>\n                                    </tr>\n                                `).join('')}\n                            </tbody>\n                        </table>\n                    </div>\n                `;\n      default:\n        return '<p>No data available for this report type.</p>';\n    }\n  }\n  function showCustomReportModal() {\n    const modal = createModal();\n    modal.innerHTML = `\n            <div class=\"modal-header\">\n                <h2><i class=\"fas fa-chart-pie\"></i> Custom Report</h2>\n                <button class=\"modal-close\">&times;</button>\n            </div>\n            \n            <div class=\"modal-body\">\n                <form id=\"custom-report-form\">\n                    <div class=\"form-section\">\n                        <h4>Report Parameters</h4>\n                        <div class=\"form-row\">\n                            <div class=\"form-group\">\n                                <label>Report Type</label>\n                                <select name=\"report_type\" required>\n                                    <option value=\"custom_booking\">Booking Analysis</option>\n                                    <option value=\"custom_user\">User Analysis</option>\n                                    <option value=\"custom_revenue\">Revenue Analysis</option>\n                                </select>\n                            </div>\n                            <div class=\"form-group\">\n                                <label>Date Range</label>\n                                <select name=\"date_range\" required>\n                                    <option value=\"last_week\">Last Week</option>\n                                    <option value=\"last_month\">Last Month</option>\n                                    <option value=\"last_quarter\">Last Quarter</option>\n                                    <option value=\"last_year\">Last Year</option>\n                                    <option value=\"all_time\">All Time</option>\n                                </select>\n                            </div>\n                        </div>\n                        \n                        <div class=\"form-group\">\n                            <label>Include Charts</label>\n                            <div class=\"checkbox-group\">\n                                <label class=\"checkbox\">\n                                    <input type=\"checkbox\" name=\"include_charts\" checked>\n                                    Include Charts\n                                </label>\n                                <label class=\"checkbox\">\n                                    <input type=\"checkbox\" name=\"include_tables\" checked>\n                                    Include Detailed Tables\n                                </label>\n                                <label class=\"checkbox\">\n                                    <input type=\"checkbox\" name=\"include_summary\">\n                                    Include Executive Summary\n                                </label>\n                            </div>\n                        </div>\n                    </div>\n                    \n                    <div class=\"form-actions\">\n                        <button type=\"submit\" class=\"btn btn-primary\">\n                            <i class=\"fas fa-file-export\"></i> Generate Report\n                        </button>\n                        <button type=\"button\" class=\"btn btn-outline\" onclick=\"closeModal()\">\n                            Cancel\n                        </button>\n                    </div>\n                </form>\n            </div>\n        `;\n    const form = modal.querySelector('#custom-report-form');\n    form.addEventListener('submit', function (e) {\n      e.preventDefault();\n      const formData = new FormData(this);\n      const data = Object.fromEntries(formData.entries());\n      showNotification('âœ… Custom report generated!', 'success');\n      closeModal();\n      generateReport('full');\n    });\n  }\n  function showChangePasswordModal() {\n    const modal = createModal();\n    modal.innerHTML = `\n            <div class=\"modal-header\">\n                <h2><i class=\"fas fa-key\"></i> Change Password</h2>\n                <button class=\"modal-close\">&times;</button>\n            </div>\n            \n            <div class=\"modal-body\">\n                <form id=\"change-password-form\">\n                    <div class=\"form-group\">\n                        <label>Current Password</label>\n                        <input type=\"password\" name=\"current_password\" required>\n                    </div>\n                    \n                    <div class=\"form-group\">\n                        <label>New Password</label>\n                        <input type=\"password\" name=\"new_password\" required minlength=\"6\">\n                    </div>\n                    \n                    <div class=\"form-group\">\n                        <label>Confirm New Password</label>\n                        <input type=\"password\" name=\"confirm_password\" required minlength=\"6\">\n                    </div>\n                    \n                    <div class=\"form-actions\">\n                        <button type=\"submit\" class=\"btn btn-primary\">\n                            <i class=\"fas fa-save\"></i> Change Password\n                        </button>\n                        <button type=\"button\" class=\"btn btn-outline\" onclick=\"closeModal()\">\n                            Cancel\n                        </button>\n                    </div>\n                </form>\n            </div>\n        `;\n    const form = modal.querySelector('#change-password-form');\n    form.addEventListener('submit', function (e) {\n      e.preventDefault();\n      const formData = new FormData(this);\n      const data = Object.fromEntries(formData.entries());\n      if (data.new_password !== data.confirm_password) {\n        showNotification('âŒ New passwords do not match', 'error');\n        return;\n      }\n\n      // In a real app, you would verify current password first\n      // For demo, we'll just update it\n      try {\n        const updatedUser = userManager.updateUser(currentUser._id, {\n          password: data.new_password\n        });\n        showNotification('âœ… Password changed successfully!', 'success');\n        closeModal();\n      } catch (error) {\n        showNotification('âŒ Error changing password', 'error');\n      }\n    });\n  }\n  function showUploadDocumentModal() {\n    const modal = createModal();\n    modal.innerHTML = `\n            <div class=\"modal-header\">\n                <h2><i class=\"fas fa-upload\"></i> Upload Document</h2>\n                <button class=\"modal-close\">&times;</button>\n            </div>\n            \n            <div class=\"modal-body\">\n                <form id=\"upload-document-form\">\n                    <div class=\"form-group\">\n                        <label>Document Type</label>\n                        <select name=\"document_type\" required>\n                            <option value=\"\">Select Document Type</option>\n                            <option value=\"passport\">Passport</option>\n                            <option value=\"visa\">Visa</option>\n                            <option value=\"flight_tickets\">Flight Tickets</option>\n                            <option value=\"insurance\">Travel Insurance</option>\n                            <option value=\"medical\">Medical Certificate</option>\n                            <option value=\"other\">Other</option>\n                        </select>\n                    </div>\n                    \n                    <div class=\"form-group\">\n                        <label>Document Name</label>\n                        <input type=\"text\" name=\"document_name\" placeholder=\"e.g., Passport Copy\" required>\n                    </div>\n                    \n                    <div class=\"form-group\">\n                        <label>Expiry Date (if applicable)</label>\n                        <input type=\"date\" name=\"expiry_date\">\n                    </div>\n                    \n                    <div class=\"form-group\">\n                        <label>Upload File</label>\n                        <div class=\"file-upload\">\n                            <input type=\"file\" name=\"document_file\" accept=\".pdf,.jpg,.jpeg,.png,.doc,.docx\" required>\n                            <div class=\"file-upload-label\">\n                                <i class=\"fas fa-cloud-upload-alt\"></i>\n                                <span>Click to upload or drag and drop</span>\n                                <small>PDF, JPG, PNG, DOC up to 10MB</small>\n                            </div>\n                        </div>\n                    </div>\n                    \n                    <div class=\"form-group\">\n                        <label>Notes</label>\n                        <textarea name=\"notes\" rows=\"3\" placeholder=\"Any additional notes about this document...\"></textarea>\n                    </div>\n                    \n                    <div class=\"form-actions\">\n                        <button type=\"submit\" class=\"btn btn-primary\">\n                            <i class=\"fas fa-upload\"></i> Upload Document\n                        </button>\n                        <button type=\"button\" class=\"btn btn-outline\" onclick=\"closeModal()\">\n                            Cancel\n                        </button>\n                    </div>\n                </form>\n            </div>\n        `;\n\n    // File upload styling\n    const fileInput = modal.querySelector('input[type=\"file\"]');\n    const fileLabel = modal.querySelector('.file-upload-label');\n    fileInput.addEventListener('change', function () {\n      if (this.files.length > 0) {\n        fileLabel.innerHTML = `\n                    <i class=\"fas fa-file\"></i>\n                    <span>${this.files[0].name}</span>\n                    <small>${(this.files[0].size / 1024 / 1024).toFixed(2)} MB</small>\n                `;\n      }\n    });\n\n    // Form submission\n    const form = modal.querySelector('#upload-document-form');\n    form.addEventListener('submit', function (e) {\n      e.preventDefault();\n      // In a real app, you would upload the file to a server\n      // For demo, we'll just show a success message\n      showNotification('âœ… Document uploaded successfully!', 'success');\n      closeModal();\n    });\n  }\n  function filterBookings(status) {\n    const bookings = userManager.getUserBookings(currentUser._id);\n    const filteredBookings = status ? bookings.filter(b => b.status === status) : bookings;\n    const tableBody = document.getElementById('dashboard-bookings-list');\n    if (tableBody) {\n      tableBody.innerHTML = renderBookingsTable(filteredBookings);\n    }\n  }\n  function filterAdminBookings(type) {\n    const filteredBookings = type ? userManager.bookings.filter(b => b.serviceType === type) : userManager.bookings;\n    const tableBody = document.getElementById('bookings-table-body');\n    if (tableBody) {\n      tableBody.innerHTML = renderAdminBookingsTable(filteredBookings);\n    }\n  }\n  function filterAdminTrips(status) {\n    const filteredTrips = status ? userManager.tripPlans.filter(t => t.status === status) : userManager.tripPlans;\n    const tableBody = document.getElementById('trips-table-body');\n    if (tableBody) {\n      tableBody.innerHTML = renderAdminTripsTable(filteredTrips);\n    }\n  }\n  function searchAdminContent(query) {\n    if (!query.trim()) {\n      // Reset all tables to show all data\n      const usersTable = document.getElementById('users-table-body');\n      const bookingsTable = document.getElementById('bookings-table-body');\n      const tripsTable = document.getElementById('trips-table-body');\n      if (usersTable) usersTable.innerHTML = renderUsersTable(userManager.users);\n      if (bookingsTable) bookingsTable.innerHTML = renderAdminBookingsTable(userManager.bookings);\n      if (tripsTable) tripsTable.innerHTML = renderAdminTripsTable(userManager.tripPlans);\n      return;\n    }\n    const lowerQuery = query.toLowerCase();\n\n    // Search users\n    const filteredUsers = userManager.users.filter(user => {\n      var _user$country;\n      return user.name.toLowerCase().includes(lowerQuery) || user.email.toLowerCase().includes(lowerQuery) || user.role.toLowerCase().includes(lowerQuery) || ((_user$country = user.country) === null || _user$country === void 0 ? void 0 : _user$country.toLowerCase().includes(lowerQuery));\n    });\n    const usersTable = document.getElementById('users-table-body');\n    if (usersTable) usersTable.innerHTML = renderUsersTable(filteredUsers);\n\n    // Search bookings\n    const filteredBookings = userManager.bookings.filter(booking => booking._id.toLowerCase().includes(lowerQuery) || booking.userName.toLowerCase().includes(lowerQuery) || booking.userEmail.toLowerCase().includes(lowerQuery) || booking.serviceName.toLowerCase().includes(lowerQuery) || booking.serviceType.toLowerCase().includes(lowerQuery));\n    const bookingsTable = document.getElementById('bookings-table-body');\n    if (bookingsTable) bookingsTable.innerHTML = renderAdminBookingsTable(filteredBookings);\n\n    // Search trip plans\n    const filteredTrips = userManager.tripPlans.filter(trip => trip._id.toLowerCase().includes(lowerQuery) || trip.userName.toLowerCase().includes(lowerQuery) || trip.userEmail.toLowerCase().includes(lowerQuery) || trip.duration.toLowerCase().includes(lowerQuery) || trip.budget.toLowerCase().includes(lowerQuery));\n    const tripsTable = document.getElementById('trips-table-body');\n    if (tripsTable) tripsTable.innerHTML = renderAdminTripsTable(filteredTrips);\n  }\n\n  // ===============================\n  // INITIALIZATION\n  // ===============================\n\n  async function init() {\n    console.log('Initializing Go Trip Professional System...');\n\n    // Hide loading overlay immediately\n    const loadingOverlay = document.getElementById('loading-overlay');\n    if (loadingOverlay) {\n      loadingOverlay.style.opacity = '0';\n      setTimeout(() => {\n        loadingOverlay.style.display = 'none';\n      }, 500);\n    }\n\n    // Set current year in footer\n    const yearElement = document.getElementById('current-year');\n    if (yearElement) {\n      yearElement.textContent = new Date().getFullYear();\n    }\n\n    // Check authentication\n    await checkAuth();\n\n    // Setup event listeners\n    setupEventListeners();\n    setupForms();\n\n    // Load initial page\n    const initialPage = window.location.hash ? window.location.hash.replace('#', '') : 'home';\n    showPage(initialPage, false);\n\n    // Show welcome notification\n    setTimeout(() => {\n      if (currentUser) {\n        showNotification(`Welcome back, ${currentUser.name}!`, 'info');\n      } else {\n        showNotification('Welcome to Go Trip!', 'info');\n      }\n    }, 1000);\n    console.log('Go Trip Professional System initialized successfully');\n  }\n\n  // ===============================\n  // EXPORT TO GLOBAL SCOPE\n  // ===============================\n\n  // Make functions globally available\n  window.showPage = showPage;\n  window.closeModal = closeModal;\n  window.showAuthModal = showAuthModal;\n  window.showNotification = showNotification;\n  window.logout = logout;\n  window.apiRequest = apiRequest;\n  window.config = config;\n  window.currentUser = () => currentUser;\n  window.isAuthenticated = () => isAuthenticated;\n  window.showServiceSelectionModal = showServiceSelectionModal;\n  window.showEnhancedBookingModal = showEnhancedBookingModal;\n  window.showTripPlanModal = showTripPlanModal;\n  window.showAddUserModal = showAddUserModal;\n  window.viewUserDetails = viewUserDetails;\n  window.editUser = editUser;\n  window.deleteUserConfirm = deleteUserConfirm;\n  window.confirmBooking = confirmBooking;\n  window.viewBookingDetails = viewBookingDetails;\n  window.downloadBookingInvoice = downloadBookingInvoice;\n  window.cancelBooking = cancelBooking;\n  window.cancelBookingAdmin = cancelBookingAdmin;\n  window.viewTripPlan = viewTripPlan;\n  window.viewTripPlanAdmin = viewTripPlanAdmin;\n  window.processTripPlan = processTripPlan;\n  window.editTripPlan = editTripPlan;\n  window.cancelTripPlan = cancelTripPlan;\n  window.downloadItinerary = downloadItinerary;\n  window.generateReport = generateReport;\n  window.showCustomReportModal = showCustomReportModal;\n  window.showChangePasswordModal = showChangePasswordModal;\n  window.showUploadDocumentModal = showUploadDocumentModal;\n  window.userManager = userManager;\n\n  // Initialize when DOM is ready\n  domReady(() => {\n    setTimeout(init, 100);\n  });\n})();","map":{"version":3,"names":["config","baseUrl","debug","useMockMode","endpoints","newsletter","contact","tripPlan","auth","login","register","verify","bookings","submit","user","guides","translators","destinations","accommodations","blog","dashboard","admin","userBookings","allUsers","allBookings","updateProfile","cancelBooking","prices","min","max","budget","midrange","luxury","mockData","_id","name","specialty","languages","experience","rating","price","dailyRate","image","certifications","languageCount","experienceYears","available","description","location","features","basePrice","duration","bestSeason","type","category","capacity","title","excerpt","date","readTime","author","content","tags","views","createdAt","UserManager","constructor","users","loadUsersFromStorage","loadBookingsFromStorage","tripPlans","loadTripPlansFromStorage","stored","localStorage","getItem","JSON","parse","email","password","role","phone","country","Date","toISOString","status","lastLogin","userId","serviceType","serviceId","serviceName","userEmail","userName","now","endDate","travelers","totalAmount","notes","startDate","interests","message","assignedTo","itinerary","saveUsers","setItem","stringify","saveBookings","saveTripPlans","registerUser","userData","existingUser","find","u","Error","newUser","push","authenticateUser","updateUser","updates","index","findIndex","deleteUser","filter","createBooking","bookingData","bookingId","toString","slice","booking","updateBooking","b","confirmBooking","getUserBookings","createTripPlan","tripData","tripId","trip","updateTripPlan","t","getStats","totalUsers","length","totalBookings","activeBookings","includes","totalRevenue","reduce","sum","pendingTripPlans","getMonthlyRevenue","monthlyRevenue","confirmedBookings","forEach","monthYear","getFullYear","String","getMonth","padStart","Object","entries","map","month","revenue","getRecentActivity","allActivities","id","action","timestamp","sort","a","userManager","isAuthenticated","currentUser","useMockData","domReady","callback","document","readyState","addEventListener","validateEmail","re","test","validatePhone","validatePassword","getAuthToken","getUserData","saveUserData","token","clearUserData","removeItem","apiRequest","endpoint","options","url","headers","simulateMockResponse","controller","AbortController","timeoutId","setTimeout","abort","response","fetch","signal","clearTimeout","ok","error","json","catch","console","log","Promise","resolve","success","data","method","body","split","subscribed","reference","booking_reference","service_name","service_type","trip_reference","stats","recentActivity","recentUsers","reverse","recentBookings","userTripPlans","upcomingBookings","completedBookings","totalSpent","total","recentTripPlans","checkAuth","updateAuthUI","result","userWithoutPassword","showNotification","showPage","logout","currentPage","querySelector","pageId","smooth","_currentUser","showAuthModal","querySelectorAll","page","classList","remove","targetPage","getElementById","add","link","dataset","loadPageContent","window","scrollTo","top","behavior","history","pushState","loadHomePage","loadDestinations","loadGuides","loadTranslators","loadAccommodations","loadBlog","loadDashboard","loadAdminDashboard","innerHTML","toUpperCase","renderRecentBookings","renderRecentTripPlans","renderBookingsTable","renderTripPlans","address","dob","passport","preferences","setupEnhancedDashboardListeners","toLocaleDateString","join","getServiceIcon","interest","renderItinerary","days","day","activities","activity","icon","time","icons","_document$getElementB","_document$getElementB2","_document$getElementB3","_document$getElementB4","_document$getElementB5","_document$getElementB6","e","preventDefault","l","c","tabId","tab","tabElement","showServiceSelectionModal","showTripPlanModal","showChangePasswordModal","showUploadDocumentModal","bookingFilter","filterBookings","value","profileForm","formData","FormData","fromEntries","updatedUser","_currentUser2","toLocaleString","renderRevenueChart","renderRecentActivity","renderRecentUsers","renderAdminRecentBookings","renderUsersTable","renderAdminBookingsTable","renderAdminTripsTable","guide","setupAdminDashboardListeners","maxRevenue","Math","m","item","height","getActivityIcon","formatTimeAgo","activityType","past","diff","minutes","floor","hours","_document$getElementB7","_document$getElementB8","_document$getElementB9","_document$getElementB0","p","service","showAddUserModal","generateReport","searchInput","searchAdminContent","filterAdminBookings","filterAdminTrips","destinationsGrid","_result$data","featuredDestinations","dest","substring","blogGrid","_result$data2","featuredBlogs","planTripBtn","grid","f","lang","repeat","translator","acc","blogs","existing","n","notification","createElement","className","appendChild","removeTimer","isLoggedIn","authToggle","authDropdown","stopPropagation","signInBtn","signUpBtn","demoLoginBtn","quickDemoLogin","demoUser","modal","createModal","isLogin","form","closeModal","option","showEnhancedBookingModal","_serviceDetails","_currentUser3","_currentUser4","_currentUser5","_currentUser6","_serviceDetails2","_serviceDetails3","_serviceDetails6","_serviceDetails7","serviceDetails","allServices","s","charAt","dateInput","tomorrow","setDate","getDate","button","_serviceDetails4","_serviceDetails5","input","parentElement","parseInt","durationSelect","modalContainer","style","display","overlay","escapeHandler","key","removeEventListener","_currentUser7","_currentUser8","_currentUser9","nextMonth","setMonth","Array","from","confirm_password","setupForms","newsletterForm","reset","contactForm","footerNewsletterForm","setupEventListeners","target","matches","closest","handlePageNavigation","toggle","contains","mobileMenuBtn","navLinks","tagName","hash","replace","_currentUser0","viewUserDetails","editUser","new_password","updateData","user_id","deleteUserConfirm","confirm","viewBookingDetails","payment_method","downloadBookingInvoice","invoiceHTML","blob","Blob","URL","createObjectURL","href","download","click","removeChild","revokeObjectURL","cancelBookingAdmin","viewTripPlanAdmin","processTripPlan","assignedAt","viewTripPlan","editTripPlan","cancelTripPlan","downloadItinerary","itineraryHTML","total_cost","reportData","reportTitle","byRole","active","byStatus","byType","topUsers","topBookings","reportHTML","renderReportContent","toFixed","count","showCustomReportModal","fileInput","fileLabel","files","size","filteredBookings","tableBody","filteredTrips","query","trim","usersTable","bookingsTable","tripsTable","lowerQuery","toLowerCase","filteredUsers","_user$country","init","loadingOverlay","opacity","yearElement","textContent","initialPage"],"sources":["C:/Users/USER-PC/Documents/TR web/frontend/src/index.js"],"sourcesContent":["// Go Trip - Complete Professional Tourism System\r\n(function() {\r\n    'use strict';\r\n    \r\n    // ===============================\r\n    // CONFIGURATION\r\n    // ===============================\r\n    const config = {\r\n        baseUrl: 'http://localhost:3000/api',\r\n        debug: true,\r\n        useMockMode: true,\r\n        \r\n        endpoints: {\r\n            newsletter: '/newsletter',\r\n            contact: '/contact',\r\n            tripPlan: '/tripPlan',\r\n            auth: {\r\n                login: '/auth/login',\r\n                register: '/auth/register',\r\n                verify: '/auth/verify'\r\n            },\r\n            bookings: {\r\n                submit: '/bookings',\r\n                user: '/bookings/user'\r\n            },\r\n            guides: '/guides',\r\n            translators: '/translators',\r\n            destinations: '/destinations',\r\n            accommodations: '/accommodations',\r\n            blog: '/blog',\r\n            dashboard: {\r\n                user: '/dashboard/user',\r\n                admin: '/dashboard/admin',\r\n                userBookings: '/dashboard/user/bookings',\r\n                allUsers: '/dashboard/admin/users',\r\n                allBookings: '/dashboard/admin/bookings',\r\n                updateProfile: '/dashboard/user/profile',\r\n                cancelBooking: '/dashboard/bookings'\r\n            }\r\n        },\r\n        prices: {\r\n            guides: {\r\n                min: 80,\r\n                max: 200\r\n            },\r\n            translators: {\r\n                min: 50,\r\n                max: 150\r\n            },\r\n            accommodations: {\r\n                budget: [50, 150],\r\n                midrange: [150, 300],\r\n                luxury: [300, 5000]\r\n            }\r\n        }\r\n    };\r\n\r\n    // ===============================\r\n    // MOCK DATA\r\n    // ===============================\r\n    const mockData = {\r\n        guides: [\r\n            { \r\n                _id: 1, \r\n                name: \"Jean Claude N.\", \r\n                specialty: \"Gorilla Trekking Expert\", \r\n                languages: [\"English\", \"French\", \"Kinyarwanda\", \"Swahili\"],\r\n                experience: \"8 years experience\",\r\n                rating: 4.9,\r\n                price: \"$180/day\",\r\n                dailyRate: 180,\r\n                image: \"https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?ixlib=rb-4.0.3&auto=format&fit=crop&w=400&q=80\",\r\n                certifications: [\"RDB Certified\", \"Wildlife First Aid\", \"CPR Certified\"],\r\n                languageCount: 4,\r\n                experienceYears: 8,\r\n                available: true,\r\n                description: \"Expert guide specializing in gorilla trekking with extensive knowledge of Volcanoes National Park.\"\r\n            },\r\n            { \r\n                _id: 2, \r\n                name: \"Marie Aimee K.\", \r\n                specialty: \"Cultural Tour Guide\", \r\n                languages: [\"English\", \"Swahili\", \"Kinyarwanda\", \"French\"],\r\n                experience: \"6 years experience\",\r\n                rating: 4.8,\r\n                price: \"$160/day\",\r\n                dailyRate: 160,\r\n                image: \"https://images.unsplash.com/photo-1494790108755-2616b612b786?ixlib=rb-4.0.3&auto=format&fit=crop&w=400&q=80\",\r\n                certifications: [\"Cultural Heritage\", \"Anthropology Degree\", \"RDB Certified\"],\r\n                languageCount: 4,\r\n                experienceYears: 6,\r\n                available: true,\r\n                description: \"Cultural expert providing deep insights into Rwandan traditions and history.\"\r\n            },\r\n            { \r\n                _id: 3, \r\n                name: \"David M.\", \r\n                specialty: \"Bird Watching Specialist\", \r\n                languages: [\"English\", \"German\", \"Kinyarwanda\", \"French\"],\r\n                experience: \"10 years experience\",\r\n                rating: 4.9,\r\n                price: \"$200/day\",\r\n                dailyRate: 200,\r\n                image: \"https://images.unsplash.com/photo-1500648767791-00dcc994a43e?ixlib=rb-4.0.3&auto=format&fit=crop&w=400&q=80\",\r\n                certifications: [\"Ornithology Certified\", \"RDB Guide\", \"Photography Expert\"],\r\n                languageCount: 4,\r\n                experienceYears: 10,\r\n                available: true,\r\n                description: \"Specialized bird watching guide with extensive knowledge of Rwanda's avian species.\"\r\n            },\r\n            { \r\n                _id: 4, \r\n                name: \"Sarah T.\", \r\n                specialty: \"Adventure Hiking Guide\", \r\n                languages: [\"English\", \"French\", \"Spanish\", \"Kinyarwanda\"],\r\n                experience: \"7 years experience\",\r\n                rating: 4.7,\r\n                price: \"$170/day\",\r\n                dailyRate: 170,\r\n                image: \"https://images.unsplash.com/photo-1487412720507-e7ab37603c6f?ixlib=rb-4.0.3&auto=format&fit=crop&w=400&q=80\",\r\n                certifications: [\"Mountain Guide\", \"Wilderness First Responder\", \"RDB Certified\"],\r\n                languageCount: 4,\r\n                experienceYears: 7,\r\n                available: true,\r\n                description: \"Experienced hiking guide for mountain trails and adventure tours.\"\r\n            },\r\n            { \r\n                _id: 5, \r\n                name: \"Peter K.\", \r\n                specialty: \"History & Culture Guide\", \r\n                languages: [\"English\", \"Kinyarwanda\", \"French\"],\r\n                experience: \"5 years experience\",\r\n                rating: 4.6,\r\n                price: \"$140/day\",\r\n                dailyRate: 140,\r\n                image: \"https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?ixlib=rb-4.0.3&auto=format&fit=crop&w=400&q=80\",\r\n                certifications: [\"History Degree\", \"RDB Certified\", \"Cultural Expert\"],\r\n                languageCount: 3,\r\n                experienceYears: 5,\r\n                available: true,\r\n                description: \"History expert providing comprehensive cultural and historical tours.\"\r\n            },\r\n            { \r\n                _id: 6, \r\n                name: \"Grace U.\", \r\n                specialty: \"Family Tour Specialist\", \r\n                languages: [\"English\", \"French\", \"Swahili\"],\r\n                experience: \"4 years experience\",\r\n                rating: 4.5,\r\n                price: \"$130/day\",\r\n                dailyRate: 130,\r\n                image: \"https://images.unsplash.com/photo-1544725176-7c40e5a71c5e?ixlib=rb-4.0.3&auto=format&fit=crop&w=400&q=80\",\r\n                certifications: [\"Child Safety Certified\", \"RDB Guide\", \"Family Specialist\"],\r\n                languageCount: 3,\r\n                experienceYears: 4,\r\n                available: true,\r\n                description: \"Family-friendly guide specializing in tours suitable for all ages.\"\r\n            }\r\n        ],\r\n        translators: [\r\n            { \r\n                _id: 1, \r\n                name: \"Patience Rutayisire\", \r\n                languages: [\"English\", \"German\", \"Spanish\", \"French\", \"Swahili\", \"Chinese\", \"Kinyarwanda\"],\r\n                specialty: \"Tourism & Business Translation\",\r\n                rating: 4.9,\r\n                price: \"$140/day\",\r\n                dailyRate: 140,\r\n                image: \"./images/Patie.png\",\r\n                experience: \"5 years experience\",\r\n                certifications: [\"Certified Translator\", \"Tourism Diploma\", \"Business Communication\"],\r\n                languageCount: 7,\r\n                experienceYears: 5,\r\n                available: true,\r\n                description: \"Professional translator specializing in tourism and business communications.\"\r\n            },\r\n            { \r\n                _id: 2, \r\n                name: \"Eric M.\", \r\n                languages: [\"English\", \"German\", \"Chinese\", \"Kinyarwanda\", \"French\"],\r\n                specialty: \"Medical & Technical Translation\",\r\n                rating: 4.8,\r\n                price: \"$150/day\",\r\n                dailyRate: 150,\r\n                image: \"https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?ixlib=rb-4.0.3&auto=format&fit=crop&w=400&q=80\",\r\n                experience: \"8 years experience\",\r\n                certifications: [\"Medical Translator\", \"Technical Certification\", \"RDB Approved\"],\r\n                languageCount: 5,\r\n                experienceYears: 8,\r\n                available: true,\r\n                description: \"Specialized in medical and technical translations with government approval.\"\r\n            },\r\n            { \r\n                _id: 3, \r\n                name: \"Grace U.\", \r\n                languages: [\"English\", \"Spanish\", \"Portuguese\", \"Kinyarwanda\", \"French\"],\r\n                specialty: \"Legal & Government Translation\",\r\n                rating: 4.7,\r\n                price: \"$130/day\",\r\n                dailyRate: 130,\r\n                image: \"https://images.unsplash.com/photo-1544725176-7c40e5a71c5e?ixlib=rb-4.0.3&auto=format&fit=crop&w=400&q=80\",\r\n                experience: \"6 years experience\",\r\n                certifications: [\"Legal Translator\", \"Government Certified\", \"Diplomatic Experience\"],\r\n                languageCount: 5,\r\n                experienceYears: 6,\r\n                available: true,\r\n                description: \"Expert in legal documents and government communications translation.\"\r\n            },\r\n            { \r\n                _id: 4, \r\n                name: \"Robert K.\", \r\n                languages: [\"English\", \"Arabic\", \"Swahili\", \"Kinyarwanda\", \"French\"],\r\n                specialty: \"Conference & Event Translation\",\r\n                rating: 4.8,\r\n                price: \"$145/day\",\r\n                dailyRate: 145,\r\n                image: \"https://images.unsplash.com/photo-1507591064344-4c6ce005-128?ixlib=rb-4.0.3&auto=format&fit=crop&w=400&q=80\",\r\n                experience: \"7 years experience\",\r\n                certifications: [\"Conference Interpreter\", \"Event Management\", \"RDB Certified\"],\r\n                languageCount: 5,\r\n                experienceYears: 7,\r\n                available: true,\r\n                description: \"Specialized in conference interpreting and large event translation services.\"\r\n            },\r\n            { \r\n                _id: 5, \r\n                name: \"Alice N.\", \r\n                languages: [\"English\", \"French\", \"Kinyarwanda\"],\r\n                specialty: \"General Translation\",\r\n                rating: 4.6,\r\n                price: \"$90/day\",\r\n                dailyRate: 90,\r\n                image: \"https://images.unsplash.com/photo-1494790108755-2616b612b786?ixlib=rb-4.0.3&auto=format&fit=crop&w=400&q=80\",\r\n                experience: \"3 years experience\",\r\n                certifications: [\"Basic Translation\", \"RDB Certified\", \"Tourism Focus\"],\r\n                languageCount: 3,\r\n                experienceYears: 3,\r\n                available: true,\r\n                description: \"General translator with focus on tourism and everyday communication.\"\r\n            },\r\n            { \r\n                _id: 6, \r\n                name: \"Samuel T.\", \r\n                languages: [\"English\", \"Swahili\", \"Kinyarwanda\", \"French\", \"Spanish\", \"Portuguese\"],\r\n                specialty: \"Multi-Language Specialist\",\r\n                rating: 4.9,\r\n                price: \"$160/day\",\r\n                dailyRate: 160,\r\n                image: \"https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?ixlib=rb-4.0.3&auto=format&fit=crop&w=400&q=80\",\r\n                experience: \"9 years experience\",\r\n                certifications: [\"Advanced Translator\", \"Language Degree\", \"RDB Certified\"],\r\n                languageCount: 6,\r\n                experienceYears: 9,\r\n                available: true,\r\n                description: \"Multi-lingual expert translator with extensive international experience.\"\r\n            }\r\n        ],\r\n        destinations: [\r\n            {\r\n                _id: 1,\r\n                name: \"Volcanoes National Park\",\r\n                location: \"Northern Province, Rwanda\",\r\n                description: \"Home to the endangered mountain gorillas, this UNESCO World Heritage site offers unforgettable gorilla trekking experiences in the Virunga Mountains.\",\r\n                image: \"./images/mount-bisoke-rwanda.jpg\",\r\n                features: [\"Gorilla Trekking\", \"Mountain Hiking\", \"Bird Watching\", \"Cultural Villages\"],\r\n                rating: 4.9,\r\n                price: \"From $1,500\",\r\n                basePrice: 1500,\r\n                duration: \"3-5 days\",\r\n                bestSeason: [\"June\", \"July\", \"August\", \"September\"]\r\n            },\r\n            {\r\n                _id: 2,\r\n                name: \"Lake Kivu\",\r\n                location: \"Western Province, Rwanda\",\r\n                description: \"One of Africa's Great Lakes, offering stunning views, water sports, beautiful beaches, and relaxing hot springs along its shores.\",\r\n                image: \"./images/ruanda-lake-kivu-aussicht.jpg\",\r\n                features: [\"Beaches\", \"Boating\", \"Swimming\", \"Hot Springs\"],\r\n                rating: 4.7,\r\n                price: \"From $300\",\r\n                basePrice: 300,\r\n                duration: \"2-3 days\",\r\n                bestSeason: [\"All year\"]\r\n            },\r\n            {\r\n                _id: 3,\r\n                name: \"Nyungwe Forest National Park\",\r\n                location: \"Southern Province, Rwanda\",\r\n                description: \"Ancient rainforest with canopy walkway, home to chimpanzees and over 300 bird species. One of Africa's oldest forests.\",\r\n                image: \"./images/nyungwe-weather.jpg\",\r\n                features: [\"Canopy Walk\", \"Chimpanzee Tracking\", \"Hiking\", \"Waterfalls\"],\r\n                rating: 4.8,\r\n                price: \"From $600\",\r\n                basePrice: 600,\r\n                duration: \"2-4 days\",\r\n                bestSeason: [\"December\", \"January\", \"February\", \"June\", \"July\", \"August\"]\r\n            },\r\n            {\r\n                _id: 4,\r\n                name: \"Kigali City\",\r\n                location: \"Kigali, Rwanda\",\r\n                description: \"The vibrant capital city known for its cleanliness, safety, and rich cultural experiences including museums, markets, and memorial sites.\",\r\n                image: \"./images/mount-jali-hike.jpg\",\r\n                features: [\"City Tours\", \"Cultural Museums\", \"Markets\", \"Nightlife\"],\r\n                rating: 4.8,\r\n                price: \"From $100\",\r\n                basePrice: 100,\r\n                duration: \"1-3 days\",\r\n                bestSeason: [\"All year\"]\r\n            },\r\n            {\r\n                _id: 5,\r\n                name: \"Akagera National Park\",\r\n                location: \"Eastern Province, Rwanda\",\r\n                description: \"Rwanda's only Big Five safari destination, offering game drives, boat safaris, and beautiful landscapes.\",\r\n                image: \"./images/Akagera-Hippos.jpg\",\r\n                features: [\"Game Drives\", \"Boat Safaris\", \"Bird Watching\", \"Camping\"],\r\n                rating: 4.7,\r\n                price: \"From $700\",\r\n                basePrice: 700,\r\n                duration: \"2-3 days\",\r\n                bestSeason: [\"June\", \"July\", \"August\", \"September\"]\r\n            },\r\n            {\r\n                _id: 6,\r\n                name: \"King's Palace Museum\",\r\n                location: \"Nyanza, Rwanda\",\r\n                description: \"Traditional royal palace offering insights into Rwanda's pre-colonial history, culture, and monarchy.\",\r\n                image: \"./images/palace-museum-rwanda.jpg\",\r\n                features: [\"Cultural History\", \"Traditional Architecture\", \"Royal Grounds\", \"Guided Tours\"],\r\n                rating: 4.6,\r\n                price: \"From $200\",\r\n                basePrice: 200,\r\n                duration: \"1 day\",\r\n                bestSeason: [\"All year\"]\r\n            }\r\n        ],\r\n        accommodations: [\r\n            { \r\n                _id: 1, \r\n                name: \"Bisate Lodge\", \r\n                location: \"Volcanoes National Park\",\r\n                type: \"Luxury Eco-Lodge\",\r\n                description: \"Award-winning eco-lodge with stunning views of the volcanoes, offering luxury accommodation and direct gorilla trekking access.\",\r\n                image: \"./images/Bisate-Lodge-Rwanda-Exterior.jpg\",\r\n                features: [\"Private Villas\", \"Gorilla Views\", \"Spa\", \"Fine Dining\"],\r\n                price: \"$2,500/night\",\r\n                dailyRate: 2500,\r\n                rating: 4.9,\r\n                category: \"luxury\",\r\n                capacity: 2,\r\n                available: true\r\n            },\r\n            { \r\n                _id: 2, \r\n                name: \"Lake Kivu Serena Hotel\", \r\n                location: \"Gisenyi, Lake Kivu\",\r\n                type: \"5-Star Hotel\",\r\n                description: \"Luxury resort on the shores of Lake Kivu with private beach, water sports, and panoramic lake views.\",\r\n                image: \"./images/aeriel-view-serena.jpg\",\r\n                features: [\"Lake View\", \"Private Beach\", \"Spa\", \"Water Sports\"],\r\n                price: \"$450/night\",\r\n                dailyRate: 450,\r\n                rating: 4.7,\r\n                category: \"luxury\",\r\n                capacity: 4,\r\n                available: true\r\n            },\r\n            { \r\n                _id: 3, \r\n                name: \"Kigali Marriott Hotel\", \r\n                location: \"Kigali City Center\",\r\n                type: \"Business Hotel\",\r\n                description: \"Modern luxury hotel in the heart of Kigali, perfect for business travelers and tourists alike.\",\r\n                image: \"./images/mariot-kigali.png\",\r\n                features: [\"City Center\", \"Business Center\", \"Pool\", \"Multiple Restaurants\"],\r\n                price: \"$350/night\",\r\n                dailyRate: 350,\r\n                rating: 4.6,\r\n                category: \"midrange\",\r\n                capacity: 3,\r\n                available: true\r\n            },\r\n            { \r\n                _id: 4, \r\n                name: \"One&Only Gorilla's Nest\", \r\n                location: \"Volcanoes National Park\",\r\n                type: \"Luxury Resort\",\r\n                description: \"Ultra-luxurious resort offering bespoke gorilla trekking experiences and unparalleled comfort.\",\r\n                image: \"./images/one-and-only-kinigi.jpg\",\r\n                features: [\"Butler Service\", \"Private Trekking\", \"Helicopter Transfer\", \"Fine Dining\"],\r\n                price: \"$3,500/night\",\r\n                dailyRate: 3500,\r\n                rating: 4.9,\r\n                category: \"luxury\",\r\n                capacity: 2,\r\n                available: true\r\n            },\r\n            { \r\n                _id: 5, \r\n                name: \"One&Only Nyungwe\", \r\n                location: \"Nyungwe Forest\",\r\n                type: \"Eco-Lodge\",\r\n                description: \"Sustainable eco-lodge nestled in the Nyungwe Forest, offering immersive nature experiences.\",\r\n                image: \"./images/one-only-nyungwe-house.jpg\",\r\n                features: [\"Forest Views\", \"Bird Watching\", \"Sustainable\", \"Guided Hikes\"],\r\n                price: \"$280/night\",\r\n                dailyRate: 280,\r\n                rating: 4.5,\r\n                category: \"midrange\",\r\n                capacity: 2,\r\n                available: true\r\n            },\r\n            { \r\n                _id: 6, \r\n                name: \"Raddison Blu Hotel\", \r\n                location: \"Kigali\",\r\n                type: \"4-Star Hotel\",\r\n                description: \"Contemporary hotel with excellent amenities and convenient city center location.\",\r\n                image: \"./images/radison-blue.jpg\",\r\n                features: [\"City Views\", \"Restaurant\", \"Pool\", \"Fitness Center\"],\r\n                price: \"$220/night\",\r\n                dailyRate: 220,\r\n                rating: 4.4,\r\n                category: \"midrange\",\r\n                capacity: 2,\r\n                available: true\r\n            }\r\n        ],\r\n        blog: [\r\n            { \r\n                _id: 1, \r\n                title: \"Complete Guide to Gorilla Trekking in Rwanda\", \r\n                excerpt: \"Everything you need to know about mountain gorilla trekking in Volcanoes National Park, including permits, preparation, and what to expect.\",\r\n                date: \"May 15, 2024\",\r\n                category: \"Adventure\",\r\n                image: \"./images/gorilla-trekk-rwanda.jpg\",\r\n                readTime: \"8 min read\",\r\n                author: \"Jean Claude\",\r\n                content: \"Full article content here...\",\r\n                tags: [\"Gorilla Trekking\", \"Wildlife\", \"Adventure\", \"Rwanda\"],\r\n                views: 1250,\r\n                createdAt: \"2024-05-15T10:00:00.000Z\"\r\n            },\r\n            { \r\n                _id: 2, \r\n                title: \"Best Time to Visit Rwanda: Weather & Seasons Guide\", \r\n                excerpt: \"Planning your trip? Here's when to visit Rwanda for the best wildlife viewing, hiking conditions, and cultural experiences.\",\r\n                date: \"April 28, 2024\",\r\n                category: \"Travel Tips\",\r\n                image: \"https://images.unsplash.com/photo-1469474968028-56623f02e42e?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=80\",\r\n                readTime: \"6 min read\",\r\n                author: \"Travel Team\",\r\n                content: \"Full article content here...\",\r\n                tags: [\"Travel Tips\", \"Weather\", \"Seasons\", \"Planning\"],\r\n                views: 980,\r\n                createdAt: \"2024-04-28T09:30:00.000Z\"\r\n            },\r\n            { \r\n                _id: 3, \r\n                title: \"Rwandan Culture: Traditions, Food & Etiquette\", \r\n                excerpt: \"Discover the rich cultural heritage of Rwanda, from traditional dances and ceremonies to delicious local cuisine.\",\r\n                date: \"April 15, 2024\",\r\n                category: \"Culture\",\r\n                image: \"./images/intore-dancers.jpg\",\r\n                readTime: \"7 min read\",\r\n                author: \"Marie Aimee\",\r\n                content: \"Full article content here...\",\r\n                tags: [\"Culture\", \"Traditions\", \"Food\", \"Etiquette\"],\r\n                views: 1120,\r\n                createdAt: \"2024-04-15T11:15:00.000Z\"\r\n            },\r\n            { \r\n                _id: 4, \r\n                title: \"Top 10 Hiking Trails in the Land of a Thousand Hills\", \r\n                excerpt: \"Explore Rwanda's breathtaking landscapes through these incredible hiking trails suitable for all fitness levels.\",\r\n                date: \"March 30, 2024\",\r\n                category: \"Hiking\",\r\n                image: \"https://images.unsplash.com/photo-1506905925346-21bda4d32df4?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=80\",\r\n                readTime: \"9 min read\",\r\n                author: \"Sarah T.\",\r\n                content: \"Full article content here...\",\r\n                tags: [\"Hiking\", \"Trails\", \"Outdoors\", \"Adventure\"],\r\n                views: 890,\r\n                createdAt: \"2024-03-30T14:20:00.000Z\"\r\n            },\r\n            { \r\n                _id: 5, \r\n                title: \"Bird Watching in Rwanda: A Birder's Paradise\", \r\n                excerpt: \"With over 700 bird species, Rwanda offers incredible bird watching opportunities across its national parks and forests.\",\r\n                date: \"March 15, 2024\",\r\n                category: \"Wildlife\",\r\n                image: \"https://images.unsplash.com/photo-1452570053594-1b985d6ea890?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=80\",\r\n                readTime: \"5 min read\",\r\n                author: \"David M.\",\r\n                content: \"Full article content here...\",\r\n                tags: [\"Bird Watching\", \"Wildlife\", \"Nature\", \"Photography\"],\r\n                views: 750,\r\n                createdAt: \"2024-03-15T13:45:00.000Z\"\r\n            },\r\n            { \r\n                _id: 6, \r\n                title: \"Sustainable Tourism in Rwanda: Making a Positive Impact\", \r\n                excerpt: \"Learn how Rwanda is leading the way in sustainable tourism and how you can travel responsibly in this beautiful country.\",\r\n                date: \"February 28, 2024\",\r\n                category: \"Sustainability\",\r\n                image: \"https://images.unsplash.com/photo-1469474968028-56623f02e42e?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=80\",\r\n                readTime: \"6 min read\",\r\n                author: \"Patience R.\",\r\n                content: \"Full article content here...\",\r\n                tags: [\"Sustainability\", \"Eco-Tourism\", \"Responsible Travel\", \"Conservation\"],\r\n                views: 1050,\r\n                createdAt: \"2024-02-28T16:00:00.000Z\"\r\n            }\r\n        ]\r\n    };\r\n\r\n    // ===============================\r\n    // USER MANAGEMENT SYSTEM\r\n    // ===============================\r\n    class UserManager {\r\n        constructor() {\r\n            this.users = this.loadUsersFromStorage();\r\n            this.bookings = this.loadBookingsFromStorage();\r\n            this.tripPlans = this.loadTripPlansFromStorage();\r\n        }\r\n\r\n        loadUsersFromStorage() {\r\n            const stored = localStorage.getItem('goTrip_users');\r\n            if (stored) {\r\n                return JSON.parse(stored);\r\n            }\r\n            return [\r\n                {\r\n                    _id: 1,\r\n                    name: 'Admin User',\r\n                    email: 'admin@gotrip.africa',\r\n                    password: 'admin123',\r\n                    role: 'admin',\r\n                    phone: '+250 788 100 001',\r\n                    country: 'Rwanda',\r\n                    createdAt: new Date().toISOString(),\r\n                    status: 'active',\r\n                    lastLogin: new Date().toISOString()\r\n                },\r\n                {\r\n                    _id: 2,\r\n                    name: 'Test Customer',\r\n                    email: 'customer@example.com',\r\n                    password: 'customer123',\r\n                    role: 'user',\r\n                    phone: '+250 788 123 456',\r\n                    country: 'USA',\r\n                    createdAt: new Date().toISOString(),\r\n                    status: 'active',\r\n                    lastLogin: new Date().toISOString()\r\n                }\r\n            ];\r\n        }\r\n\r\n        loadBookingsFromStorage() {\r\n            const stored = localStorage.getItem('goTrip_bookings');\r\n            if (stored) return JSON.parse(stored);\r\n            \r\n            return [\r\n                {\r\n                    _id: 'BOOK-001',\r\n                    userId: 2,\r\n                    serviceType: 'destination',\r\n                    serviceId: 1,\r\n                    serviceName: 'Volcanoes National Park',\r\n                    userEmail: 'customer@example.com',\r\n                    userName: 'Test Customer',\r\n                    date: new Date(Date.now() + 86400000 * 7).toISOString(),\r\n                    endDate: new Date(Date.now() + 86400000 * 9).toISOString(),\r\n                    travelers: 2,\r\n                    duration: 3,\r\n                    status: 'confirmed',\r\n                    totalAmount: 1500,\r\n                    createdAt: new Date().toISOString(),\r\n                    notes: 'Looking forward to gorilla trekking'\r\n                },\r\n                {\r\n                    _id: 'BOOK-002',\r\n                    userId: 2,\r\n                    serviceType: 'guide',\r\n                    serviceId: 1,\r\n                    serviceName: 'Jean Claude N.',\r\n                    userEmail: 'customer@example.com',\r\n                    userName: 'Test Customer',\r\n                    date: new Date(Date.now() + 86400000 * 5).toISOString(),\r\n                    endDate: new Date(Date.now() + 86400000 * 6).toISOString(),\r\n                    travelers: 4,\r\n                    duration: 2,\r\n                    status: 'pending',\r\n                    totalAmount: 360,\r\n                    createdAt: new Date().toISOString(),\r\n                    notes: 'Need a gorilla trekking expert'\r\n                }\r\n            ];\r\n        }\r\n\r\n        loadTripPlansFromStorage() {\r\n            const stored = localStorage.getItem('goTrip_tripPlans');\r\n            if (stored) return JSON.parse(stored);\r\n            \r\n            return [\r\n                {\r\n                    _id: 'TRIP-001',\r\n                    userId: 2,\r\n                    userName: 'Test Customer',\r\n                    userEmail: 'customer@example.com',\r\n                    startDate: new Date(Date.now() + 86400000 * 14).toISOString(),\r\n                    duration: '6-8 days',\r\n                    travelers: 3,\r\n                    budget: 'midrange',\r\n                    interests: ['gorilla', 'culture', 'hiking'],\r\n                    message: 'Looking for a family adventure with gorilla trekking and cultural experiences',\r\n                    status: 'review',\r\n                    createdAt: new Date().toISOString(),\r\n                    assignedTo: null,\r\n                    itinerary: null\r\n                }\r\n            ];\r\n        }\r\n\r\n        saveUsers() {\r\n            localStorage.setItem('goTrip_users', JSON.stringify(this.users));\r\n        }\r\n\r\n        saveBookings() {\r\n            localStorage.setItem('goTrip_bookings', JSON.stringify(this.bookings));\r\n        }\r\n\r\n        saveTripPlans() {\r\n            localStorage.setItem('goTrip_tripPlans', JSON.stringify(this.tripPlans));\r\n        }\r\n\r\n        // User methods\r\n        registerUser(userData) {\r\n            const existingUser = this.users.find(u => u.email === userData.email);\r\n            if (existingUser) {\r\n                throw new Error('User already exists');\r\n            }\r\n\r\n            const newUser = {\r\n                _id: Date.now(),\r\n                ...userData,\r\n                role: 'user',\r\n                status: 'active',\r\n                createdAt: new Date().toISOString(),\r\n                lastLogin: new Date().toISOString()\r\n            };\r\n\r\n            this.users.push(newUser);\r\n            this.saveUsers();\r\n            return newUser;\r\n        }\r\n\r\n        authenticateUser(email, password) {\r\n            const user = this.users.find(u => \r\n                u.email === email && u.password === password && u.status === 'active'\r\n            );\r\n            \r\n            if (user) {\r\n                user.lastLogin = new Date().toISOString();\r\n                this.saveUsers();\r\n                return user;\r\n            }\r\n            return null;\r\n        }\r\n\r\n        updateUser(userId, updates) {\r\n            const index = this.users.findIndex(u => u._id === userId);\r\n            if (index !== -1) {\r\n                this.users[index] = { ...this.users[index], ...updates };\r\n                this.saveUsers();\r\n                return this.users[index];\r\n            }\r\n            return null;\r\n        }\r\n\r\n        deleteUser(userId) {\r\n            this.users = this.users.filter(u => u._id !== userId);\r\n            this.saveUsers();\r\n            return true;\r\n        }\r\n\r\n        // Booking methods\r\n        createBooking(bookingData) {\r\n            const bookingId = `BOOK-${Date.now().toString().slice(-6)}`;\r\n            const booking = {\r\n                _id: bookingId,\r\n                ...bookingData,\r\n                createdAt: new Date().toISOString(),\r\n                status: 'pending'\r\n            };\r\n\r\n            this.bookings.push(booking);\r\n            this.saveBookings();\r\n            return booking;\r\n        }\r\n\r\n        updateBooking(bookingId, updates) {\r\n            const index = this.bookings.findIndex(b => b._id === bookingId);\r\n            if (index !== -1) {\r\n                this.bookings[index] = { ...this.bookings[index], ...updates };\r\n                this.saveBookings();\r\n                return this.bookings[index];\r\n            }\r\n            return null;\r\n        }\r\n\r\n        cancelBooking(bookingId) {\r\n            return this.updateBooking(bookingId, { status: 'cancelled' });\r\n        }\r\n\r\n        confirmBooking(bookingId) {\r\n            return this.updateBooking(bookingId, { status: 'confirmed' });\r\n        }\r\n\r\n        getUserBookings(userId) {\r\n            return this.bookings.filter(b => b.userId === userId);\r\n        }\r\n\r\n        // Trip Plan methods\r\n        createTripPlan(tripData) {\r\n            const tripId = `TRIP-${Date.now().toString().slice(-6)}`;\r\n            const trip = {\r\n                _id: tripId,\r\n                ...tripData,\r\n                createdAt: new Date().toISOString(),\r\n                status: 'review'\r\n            };\r\n\r\n            this.tripPlans.push(trip);\r\n            this.saveTripPlans();\r\n            return trip;\r\n        }\r\n\r\n        updateTripPlan(tripId, updates) {\r\n            const index = this.tripPlans.findIndex(t => t._id === tripId);\r\n            if (index !== -1) {\r\n                this.tripPlans[index] = { ...this.tripPlans[index], ...updates };\r\n                this.saveTripPlans();\r\n                return this.tripPlans[index];\r\n            }\r\n            return null;\r\n        }\r\n\r\n        // Analytics methods\r\n        getStats() {\r\n            const totalUsers = this.users.length;\r\n            const totalBookings = this.bookings.length;\r\n            const activeBookings = this.bookings.filter(b => \r\n                ['confirmed', 'pending'].includes(b.status)\r\n            ).length;\r\n            \r\n            const totalRevenue = this.bookings\r\n                .filter(b => b.status === 'confirmed')\r\n                .reduce((sum, b) => sum + (b.totalAmount || 0), 0);\r\n            \r\n            const pendingTripPlans = this.tripPlans.filter(t => t.status === 'review').length;\r\n\r\n            return {\r\n                totalUsers,\r\n                totalBookings,\r\n                activeBookings,\r\n                totalRevenue,\r\n                pendingTripPlans\r\n            };\r\n        }\r\n\r\n        getMonthlyRevenue() {\r\n            const monthlyRevenue = {};\r\n            const confirmedBookings = this.bookings.filter(b => b.status === 'confirmed');\r\n            \r\n            confirmedBookings.forEach(booking => {\r\n                const date = new Date(booking.createdAt);\r\n                const monthYear = `${date.getFullYear()}-${String(date.getMonth() + 1).padStart(2, '0')}`;\r\n                \r\n                if (!monthlyRevenue[monthYear]) {\r\n                    monthlyRevenue[monthYear] = 0;\r\n                }\r\n                monthlyRevenue[monthYear] += booking.totalAmount || 0;\r\n            });\r\n\r\n            return Object.entries(monthlyRevenue).map(([month, revenue]) => ({\r\n                month,\r\n                revenue\r\n            }));\r\n        }\r\n\r\n        getRecentActivity() {\r\n            const allActivities = [\r\n                ...this.users.map(u => ({\r\n                    type: 'user',\r\n                    id: u._id,\r\n                    name: u.name,\r\n                    email: u.email,\r\n                    action: 'registered',\r\n                    timestamp: u.createdAt\r\n                })),\r\n                ...this.bookings.map(b => ({\r\n                    type: 'booking',\r\n                    id: b._id,\r\n                    name: b.serviceName,\r\n                    email: b.userEmail,\r\n                    action: b.status,\r\n                    timestamp: b.createdAt\r\n                })),\r\n                ...this.tripPlans.map(t => ({\r\n                    type: 'trip_plan',\r\n                    id: t._id,\r\n                    name: t.userName,\r\n                    email: t.userEmail,\r\n                    action: 'requested',\r\n                    timestamp: t.createdAt\r\n                }))\r\n            ];\r\n\r\n            return allActivities.sort((a, b) => \r\n                new Date(b.timestamp) - new Date(a.timestamp)\r\n            ).slice(0, 20);\r\n        }\r\n    }\r\n\r\n    // Initialize User Manager\r\n    const userManager = new UserManager();\r\n\r\n    // ===============================\r\n    // STATE MANAGEMENT\r\n    // ===============================\r\n    let isAuthenticated = false;\r\n    let currentUser = null;\r\n    let useMockData = config.useMockMode;\r\n\r\n    // ===============================\r\n    // CORE UTILITIES\r\n    // ===============================\r\n    \r\n    // DOM Ready Helper\r\n    function domReady(callback) {\r\n        if (document.readyState === 'loading') {\r\n            document.addEventListener('DOMContentLoaded', callback);\r\n        } else {\r\n            callback();\r\n        }\r\n    }\r\n\r\n    // Validation Functions\r\n    function validateEmail(email) {\r\n        const re = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\r\n        return re.test(email);\r\n    }\r\n\r\n    function validatePhone(phone) {\r\n        const re = /^\\+?[\\d\\s\\-\\(\\)]{10,}$/;\r\n        return re.test(phone);\r\n    }\r\n\r\n    function validatePassword(password) {\r\n        return password.length >= 6;\r\n    }\r\n\r\n    // Storage Functions\r\n    function getAuthToken() {\r\n        return localStorage.getItem('authToken');\r\n    }\r\n\r\n    function getUserData() {\r\n        const userData = localStorage.getItem('userData');\r\n        return userData ? JSON.parse(userData) : null;\r\n    }\r\n\r\n    function saveUserData(userData) {\r\n        localStorage.setItem('userData', JSON.stringify(userData));\r\n        if (userData.token) {\r\n            localStorage.setItem('authToken', userData.token);\r\n        }\r\n    }\r\n\r\n    function clearUserData() {\r\n        localStorage.removeItem('authToken');\r\n        localStorage.removeItem('userData');\r\n        isAuthenticated = false;\r\n        currentUser = null;\r\n    }\r\n\r\n    // ===============================\r\n    // API SERVICE\r\n    // ===============================\r\n    \r\n    async function apiRequest(endpoint, options = {}) {\r\n        const url = `${config.baseUrl}${endpoint}`;\r\n        const token = getAuthToken();\r\n        \r\n        const headers = {\r\n            'Content-Type': 'application/json',\r\n            ...options.headers\r\n        };\r\n        \r\n        if (token) {\r\n            headers['Authorization'] = `Bearer ${token}`;\r\n        }\r\n        \r\n        // If using mock mode, simulate response\r\n        if (useMockData) {\r\n            return simulateMockResponse(endpoint, options);\r\n        }\r\n        \r\n        try {\r\n            const controller = new AbortController();\r\n            const timeoutId = setTimeout(() => controller.abort(), 8000);\r\n            \r\n            const response = await fetch(url, {\r\n                ...options,\r\n                headers,\r\n                signal: controller.signal\r\n            });\r\n            \r\n            clearTimeout(timeoutId);\r\n            \r\n            if (!response.ok) {\r\n                const error = await response.json().catch(() => ({}));\r\n                throw new Error(error.message || `HTTP ${response.status}`);\r\n            }\r\n            \r\n            return await response.json();\r\n            \r\n        } catch (error) {\r\n            console.error('API Error:', error);\r\n            \r\n            // Fall back to mock data on network error\r\n            if (!useMockData) {\r\n                console.log('Falling back to mock data');\r\n                useMockData = true;\r\n            }\r\n            \r\n            return simulateMockResponse(endpoint, options);\r\n        }\r\n    }\r\n\r\n    function simulateMockResponse(endpoint, options) {\r\n        return new Promise(resolve => {\r\n            setTimeout(() => {\r\n                let response = { success: true, data: [], message: 'Mock response' };\r\n                \r\n                const method = options?.method || 'GET';\r\n                const body = options?.body ? JSON.parse(options.body) : {};\r\n                \r\n                if (endpoint.includes('/auth')) {\r\n                    if (endpoint.includes('/login') && method === 'POST') {\r\n                        response = {\r\n                            success: true,\r\n                            token: 'mock-jwt-token-' + Date.now(),\r\n                            user: {\r\n                                _id: Date.now(),\r\n                                name: body.email.split('@')[0],\r\n                                email: body.email,\r\n                                role: 'user',\r\n                                phone: '+250 788 123 456',\r\n                                country: 'Rwanda'\r\n                            },\r\n                            message: 'Login successful (demo)'\r\n                        };\r\n                    } else if (endpoint.includes('/register') && method === 'POST') {\r\n                        response = {\r\n                            success: true,\r\n                            token: 'mock-jwt-token-' + Date.now(),\r\n                            user: {\r\n                                _id: Date.now(),\r\n                                name: body.name,\r\n                                email: body.email,\r\n                                role: 'user',\r\n                                phone: body.phone || '+250 788 123 456',\r\n                                country: body.country || 'Rwanda'\r\n                            },\r\n                            message: 'Registration successful (demo)'\r\n                        };\r\n                    } else if (endpoint.includes('/verify')) {\r\n                        const userData = getUserData();\r\n                        response = {\r\n                            success: !!userData,\r\n                            user: userData || null,\r\n                            message: userData ? 'User verified (demo)' : 'Not authenticated'\r\n                        };\r\n                    }\r\n                } else if (endpoint.includes('/newsletter')) {\r\n                    response = {\r\n                        success: true,\r\n                        data: { email: body.email, subscribed: true },\r\n                        message: 'Subscribed to newsletter (demo)'\r\n                    };\r\n                } else if (endpoint.includes('/contact')) {\r\n                    response = {\r\n                        success: true,\r\n                        data: { reference: 'CONTACT-' + Date.now(), status: 'received' },\r\n                        message: 'Message received (demo)'\r\n                    };\r\n                } else if (endpoint.includes('/bookings')) {\r\n                    if (method === 'POST') {\r\n                        response = {\r\n                            success: true,\r\n                            data: {\r\n                                booking_reference: 'BOOK-' + Date.now(),\r\n                                service_name: body.service_name,\r\n                                status: 'confirmed'\r\n                            },\r\n                            message: 'Booking confirmed (demo)'\r\n                        };\r\n                    } else {\r\n                        response = {\r\n                            success: true,\r\n                            data: [\r\n                                {\r\n                                    _id: 'mock-1',\r\n                                    service_name: 'Gorilla Trekking Tour',\r\n                                    booking_reference: 'GT-2024-001',\r\n                                    status: 'confirmed',\r\n                                    date: new Date().toISOString(),\r\n                                    service_type: 'destination'\r\n                                }\r\n                            ]\r\n                        };\r\n                    }\r\n                } else if (endpoint.includes('/tripPlan')) {\r\n                    response = {\r\n                        success: true,\r\n                        data: {\r\n                            trip_reference: 'TRIP-' + Date.now(),\r\n                            status: 'pending'\r\n                        },\r\n                        message: 'Trip plan submitted (demo)'\r\n                    };\r\n                } else if (endpoint.includes('/guides')) {\r\n                    response = { success: true, data: mockData.guides };\r\n                } else if (endpoint.includes('/translators')) {\r\n                    response = { success: true, data: mockData.translators };\r\n                } else if (endpoint.includes('/destinations')) {\r\n                    response = { success: true, data: mockData.destinations };\r\n                } else if (endpoint.includes('/accommodations')) {\r\n                    response = { success: true, data: mockData.accommodations };\r\n                } else if (endpoint.includes('/blog')) {\r\n                    response = { success: true, data: mockData.blog };\r\n                } else if (endpoint.includes('/dashboard')) {\r\n                    if (endpoint.includes('/admin')) {\r\n                        const stats = userManager.getStats();\r\n                        const monthlyRevenue = userManager.getMonthlyRevenue();\r\n                        const recentActivity = userManager.getRecentActivity();\r\n                        const recentUsers = userManager.users.slice(-5).reverse();\r\n                        const recentBookings = userManager.bookings.slice(-5).reverse();\r\n                        \r\n                        response = {\r\n                            success: true,\r\n                            data: {\r\n                                stats,\r\n                                monthlyRevenue,\r\n                                recentActivity,\r\n                                recentUsers,\r\n                                recentBookings\r\n                            }\r\n                        };\r\n                    } else {\r\n                        const userBookings = userManager.getUserBookings(currentUser._id);\r\n                        const userTripPlans = userManager.tripPlans.filter(t => t.userId === currentUser._id);\r\n                        \r\n                        response = {\r\n                            success: true,\r\n                            data: {\r\n                                stats: {\r\n                                    totalBookings: userBookings.length,\r\n                                    upcomingBookings: userBookings.filter(b => ['confirmed', 'pending'].includes(b.status)).length,\r\n                                    completedBookings: userBookings.filter(b => b.status === 'completed').length,\r\n                                    pendingTripPlans: userTripPlans.filter(t => t.status === 'review').length,\r\n                                    totalSpent: [{ total: userBookings.filter(b => b.status === 'confirmed').reduce((sum, b) => sum + (b.totalAmount || 0), 0) }]\r\n                                },\r\n                                recentBookings: userBookings.slice(-3).reverse(),\r\n                                recentTripPlans: userTripPlans.slice(-2).reverse()\r\n                            }\r\n                        };\r\n                    }\r\n                }\r\n                \r\n                resolve(response);\r\n            }, 300);\r\n        });\r\n    }\r\n\r\n    // ===============================\r\n    // AUTHENTICATION\r\n    // ===============================\r\n    \r\n    async function checkAuth() {\r\n        const token = getAuthToken();\r\n        if (!token) {\r\n            updateAuthUI();\r\n            return false;\r\n        }\r\n        \r\n        try {\r\n            const result = await apiRequest(config.endpoints.auth.verify);\r\n            if (result.success && result.user) {\r\n                isAuthenticated = true;\r\n                currentUser = result.user;\r\n                saveUserData(result.user);\r\n                updateAuthUI(true, result.user);\r\n                return true;\r\n            } else {\r\n                clearUserData();\r\n                updateAuthUI();\r\n                return false;\r\n            }\r\n        } catch (error) {\r\n            console.error('Auth check error:', error);\r\n            updateAuthUI();\r\n            return false;\r\n        }\r\n    }\r\n\r\n    async function login(email, password) {\r\n        try {\r\n            const user = userManager.authenticateUser(email, password);\r\n            if (user) {\r\n                const { password, ...userWithoutPassword } = user;\r\n                \r\n                isAuthenticated = true;\r\n                currentUser = userWithoutPassword;\r\n                saveUserData(userWithoutPassword);\r\n                updateAuthUI(true, userWithoutPassword);\r\n                \r\n                showNotification(`âœ… Welcome back, ${user.name}!`, 'success');\r\n                \r\n                // Redirect to dashboard after login\r\n                setTimeout(() => {\r\n                    if (user.role === 'admin') {\r\n                        showPage('admin');\r\n                    } else {\r\n                        showPage('dashboard');\r\n                    }\r\n                }, 1000);\r\n                \r\n                return { success: true };\r\n            } else {\r\n                throw new Error('Invalid email or password');\r\n            }\r\n        } catch (error) {\r\n            showNotification(`âŒ ${error.message}`, 'error');\r\n            return { success: false, message: error.message };\r\n        }\r\n    }\r\n\r\n    async function register(userData) {\r\n        try {\r\n            const newUser = userManager.registerUser(userData);\r\n            \r\n            // Remove password from user object before storing\r\n            const { password, ...userWithoutPassword } = newUser;\r\n            \r\n            isAuthenticated = true;\r\n            currentUser = userWithoutPassword;\r\n            saveUserData(userWithoutPassword);\r\n            updateAuthUI(true, userWithoutPassword);\r\n            \r\n            showNotification('âœ… Registration successful! Welcome to Go Trip!', 'success');\r\n            \r\n            // Redirect to dashboard after registration\r\n            setTimeout(() => {\r\n                showPage('dashboard');\r\n            }, 1500);\r\n            \r\n            return { success: true };\r\n        } catch (error) {\r\n            showNotification(`âŒ ${error.message}`, 'error');\r\n            return { success: false, message: error.message };\r\n        }\r\n    }\r\n\r\n    function logout() {\r\n        clearUserData();\r\n        updateAuthUI();\r\n        showNotification('ðŸ‘‹ Logged out successfully', 'info');\r\n        \r\n        // Redirect to home if on protected pages\r\n        const currentPage = document.querySelector('.page.active');\r\n        if (currentPage && (currentPage.id === 'dashboard' || currentPage.id === 'admin')) {\r\n            showPage('home');\r\n        }\r\n    }\r\n\r\n    // ===============================\r\n    // PAGE NAVIGATION SYSTEM\r\n    // ===============================\r\n    \r\n    function showPage(pageId, smooth = true) {\r\n        console.log('Showing page:', pageId);\r\n        \r\n        // Authentication checks\r\n        if ((pageId === 'dashboard' || pageId === 'admin') && !isAuthenticated) {\r\n            showNotification('Please login to access this page', 'warning');\r\n            showAuthModal('login');\r\n            return;\r\n        }\r\n        \r\n        if (pageId === 'admin' && currentUser?.role !== 'admin') {\r\n            showNotification('Admin access required', 'error');\r\n            return;\r\n        }\r\n        \r\n        // Hide all pages\r\n        document.querySelectorAll('.page').forEach(page => {\r\n            page.classList.remove('active');\r\n        });\r\n        \r\n        // Show target page\r\n        const targetPage = document.getElementById(pageId);\r\n        if (targetPage) {\r\n            targetPage.classList.add('active');\r\n            \r\n            // Update navigation\r\n            document.querySelectorAll('.nav-link').forEach(link => {\r\n                link.classList.remove('active');\r\n                if (link.dataset.page === pageId) {\r\n                    link.classList.add('active');\r\n                }\r\n            });\r\n            \r\n            // Load page content\r\n            loadPageContent(pageId);\r\n            \r\n            // Smooth scroll to top\r\n            if (smooth) {\r\n                window.scrollTo({\r\n                    top: 0,\r\n                    behavior: 'smooth'\r\n                });\r\n            } else {\r\n                window.scrollTo(0, 0);\r\n            }\r\n            \r\n            // Update URL hash\r\n            if (history.pushState) {\r\n                history.pushState(null, null, `#${pageId}`);\r\n            }\r\n            \r\n        } else {\r\n            // Fallback to home\r\n            showPage('home');\r\n        }\r\n    }\r\n\r\n    function loadPageContent(pageId) {\r\n        console.log('Loading content for:', pageId);\r\n        switch(pageId) {\r\n            case 'home':\r\n                loadHomePage();\r\n                break;\r\n            case 'destinations':\r\n                loadDestinations();\r\n                break;\r\n            case 'guides':\r\n                loadGuides();\r\n                break;\r\n            case 'translators':\r\n                loadTranslators();\r\n                break;\r\n            case 'accommodations':\r\n                loadAccommodations();\r\n                break;\r\n            case 'blog':\r\n                loadBlog();\r\n                break;\r\n            case 'dashboard':\r\n                loadDashboard();\r\n                break;\r\n            case 'admin':\r\n                loadAdminDashboard();\r\n                break;\r\n        }\r\n    }\r\n\r\n    // ===============================\r\n    // ENHANCED DASHBOARD FUNCTIONS\r\n    // ===============================\r\n    \r\n    async function loadDashboard() {\r\n        console.log('Loading enhanced user dashboard...');\r\n        \r\n        const dashboard = document.getElementById('dashboard');\r\n        if (!dashboard) return;\r\n        \r\n        if (!isAuthenticated) {\r\n            showPage('home');\r\n            showNotification('Please login to access dashboard', 'warning');\r\n            return;\r\n        }\r\n        \r\n        try {\r\n            // Get user data\r\n            const userBookings = userManager.getUserBookings(currentUser._id);\r\n            const userTripPlans = userManager.tripPlans.filter(t => t.userId === currentUser._id);\r\n            \r\n            // Calculate user stats\r\n            const totalBookings = userBookings.length;\r\n            const upcomingBookings = userBookings.filter(b => \r\n                ['confirmed', 'pending'].includes(b.status)\r\n            ).length;\r\n            const completedBookings = userBookings.filter(b => \r\n                b.status === 'completed'\r\n            ).length;\r\n            const totalSpent = userBookings\r\n                .filter(b => b.status === 'confirmed')\r\n                .reduce((sum, b) => sum + (b.totalAmount || 0), 0);\r\n            \r\n            // Render dashboard\r\n            dashboard.innerHTML = `\r\n                <div class=\"dashboard\">\r\n                    <div class=\"dashboard-header\">\r\n                        <div class=\"container\">\r\n                            <h1><i class=\"fas fa-tachometer-alt\"></i> Dashboard</h1>\r\n                            <p>Welcome back, ${currentUser.name}! Manage your travel plans and bookings</p>\r\n                        </div>\r\n                    </div>\r\n                    \r\n                    <div class=\"container\">\r\n                        <div class=\"dashboard-grid\">\r\n                            <div class=\"dashboard-sidebar\">\r\n                                <div class=\"dashboard-user-profile\">\r\n                                    <div class=\"dashboard-user-avatar-large\">\r\n                                        <i class=\"fas fa-user-circle\"></i>\r\n                                    </div>\r\n                                    <h3 class=\"dashboard-user-name\">${currentUser.name}</h3>\r\n                                    <p class=\"dashboard-user-email\">${currentUser.email}</p>\r\n                                    <p class=\"user-role\"><span class=\"badge badge-${currentUser.role === 'admin' ? 'danger' : 'primary'}\">${currentUser.role.toUpperCase()}</span></p>\r\n                                    <div class=\"user-stats-mini\">\r\n                                        <div class=\"stat\">\r\n                                            <strong>${totalBookings}</strong>\r\n                                            <span>Bookings</span>\r\n                                        </div>\r\n                                        <div class=\"stat\">\r\n                                            <strong>$${totalSpent}</strong>\r\n                                            <span>Spent</span>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                                \r\n                                <ul class=\"dashboard-nav\">\r\n                                    <li>\r\n                                        <a href=\"#\" class=\"dashboard-tab-link active\" data-tab=\"overview\">\r\n                                            <i class=\"fas fa-chart-pie\"></i>\r\n                                            Overview\r\n                                        </a>\r\n                                    </li>\r\n                                    <li>\r\n                                        <a href=\"#\" class=\"dashboard-tab-link\" data-tab=\"bookings\">\r\n                                            <i class=\"fas fa-calendar-check\"></i>\r\n                                            My Bookings\r\n                                            <span class=\"nav-badge\">${totalBookings}</span>\r\n                                        </a>\r\n                                    </li>\r\n                                    <li>\r\n                                        <a href=\"#\" class=\"dashboard-tab-link\" data-tab=\"trip-plans\">\r\n                                            <i class=\"fas fa-route\"></i>\r\n                                            Trip Plans\r\n                                            <span class=\"nav-badge\">${userTripPlans.length}</span>\r\n                                        </a>\r\n                                    </li>\r\n                                    <li>\r\n                                        <a href=\"#\" class=\"dashboard-tab-link\" data-tab=\"profile\">\r\n                                            <i class=\"fas fa-user-cog\"></i>\r\n                                            Profile Settings\r\n                                        </a>\r\n                                    </li>\r\n                                    <li>\r\n                                        <a href=\"#\" class=\"dashboard-tab-link\" data-tab=\"documents\">\r\n                                            <i class=\"fas fa-file-alt\"></i>\r\n                                            Travel Documents\r\n                                        </a>\r\n                                    </li>\r\n                                </ul>\r\n                                \r\n                                <div class=\"sidebar-actions\">\r\n                                    <button class=\"btn btn-primary btn-block mt-3\" id=\"dashboard-new-booking-btn\">\r\n                                        <i class=\"fas fa-plus\"></i> New Booking\r\n                                    </button>\r\n                                    <button class=\"btn btn-outline btn-block mt-2\" id=\"dashboard-plan-trip-btn\">\r\n                                        <i class=\"fas fa-map-marked-alt\"></i> Plan a Trip\r\n                                    </button>\r\n                                </div>\r\n                            </div>\r\n                            \r\n                            <div class=\"dashboard-content\">\r\n                                <!-- Overview Tab -->\r\n                                <div id=\"dashboard-overview\" class=\"dashboard-tab-container active\">\r\n                                    <div class=\"dashboard-stats\">\r\n                                        <div class=\"dashboard-stat-card\">\r\n                                            <div class=\"dashboard-stat-icon bookings\">\r\n                                                <i class=\"fas fa-calendar-alt\"></i>\r\n                                            </div>\r\n                                            <div class=\"dashboard-stat-content\">\r\n                                                <h3>Total Bookings</h3>\r\n                                                <p class=\"dashboard-stat-number\">${totalBookings}</p>\r\n                                                <p class=\"dashboard-stat-subtitle\">All-time bookings</p>\r\n                                            </div>\r\n                                        </div>\r\n                                        \r\n                                        <div class=\"dashboard-stat-card\">\r\n                                            <div class=\"dashboard-stat-icon pending\">\r\n                                                <i class=\"fas fa-clock\"></i>\r\n                                            </div>\r\n                                            <div class=\"dashboard-stat-content\">\r\n                                                <h3>Upcoming</h3>\r\n                                                <p class=\"dashboard-stat-number\">${upcomingBookings}</p>\r\n                                                <p class=\"dashboard-stat-subtitle\">Active bookings</p>\r\n                                            </div>\r\n                                        </div>\r\n                                        \r\n                                        <div class=\"dashboard-stat-card\">\r\n                                            <div class=\"dashboard-stat-icon completed\">\r\n                                                <i class=\"fas fa-check-circle\"></i>\r\n                                            </div>\r\n                                            <div class=\"dashboard-stat-content\">\r\n                                                <h3>Completed</h3>\r\n                                                <p class=\"dashboard-stat-number\">${completedBookings}</p>\r\n                                                <p class=\"dashboard-stat-subtitle\">Past experiences</p>\r\n                                            </div>\r\n                                        </div>\r\n                                        \r\n                                        <div class=\"dashboard-stat-card\">\r\n                                            <div class=\"dashboard-stat-icon revenue\">\r\n                                                <i class=\"fas fa-wallet\"></i>\r\n                                            </div>\r\n                                            <div class=\"dashboard-stat-content\">\r\n                                                <h3>Total Spent</h3>\r\n                                                <p class=\"dashboard-stat-number\">$${totalSpent}</p>\r\n                                                <p class=\"dashboard-stat-subtitle\">All transactions</p>\r\n                                            </div>\r\n                                        </div>\r\n                                    </div>\r\n                                    \r\n                                    <div class=\"dashboard-section\">\r\n                                        <div class=\"section-header\">\r\n                                            <h3><i class=\"fas fa-history\"></i> Recent Bookings</h3>\r\n                                            <a href=\"#\" class=\"btn-link view-all\" data-tab=\"bookings\">View All</a>\r\n                                        </div>\r\n                                        <div id=\"dashboard-recent-bookings\" class=\"dashboard-booking-cards\">\r\n                                            ${renderRecentBookings(userBookings.slice(0, 3))}\r\n                                        </div>\r\n                                    </div>\r\n                                    \r\n                                    <div class=\"dashboard-section\">\r\n                                        <div class=\"section-header\">\r\n                                            <h3><i class=\"fas fa-route\"></i> Recent Trip Plans</h3>\r\n                                            <a href=\"#\" class=\"btn-link view-all\" data-tab=\"trip-plans\">View All</a>\r\n                                        </div>\r\n                                        <div id=\"dashboard-recent-trip-plans\" class=\"dashboard-booking-cards\">\r\n                                            ${renderRecentTripPlans(userTripPlans.slice(0, 2))}\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                                \r\n                                <!-- Bookings Tab -->\r\n                                <div id=\"dashboard-bookings\" class=\"dashboard-tab-container\">\r\n                                    <div class=\"tab-header\">\r\n                                        <h2><i class=\"fas fa-calendar-check\"></i> My Bookings</h2>\r\n                                        <div class=\"tab-filters\">\r\n                                            <select id=\"dashboard-booking-filter\" class=\"form-select\">\r\n                                                <option value=\"\">All Status</option>\r\n                                                <option value=\"pending\">Pending</option>\r\n                                                <option value=\"confirmed\">Confirmed</option>\r\n                                                <option value=\"completed\">Completed</option>\r\n                                                <option value=\"cancelled\">Cancelled</option>\r\n                                            </select>\r\n                                            <button class=\"btn btn-primary\" id=\"new-booking-modal-btn\">\r\n                                                <i class=\"fas fa-plus\"></i> New Booking\r\n                                            </button>\r\n                                        </div>\r\n                                    </div>\r\n                                    <div class=\"dashboard-section\">\r\n                                        <div class=\"bookings-table-container\">\r\n                                            <table class=\"dashboard-table\">\r\n                                                <thead>\r\n                                                    <tr>\r\n                                                        <th>Service</th>\r\n                                                        <th>Type</th>\r\n                                                        <th>Date</th>\r\n                                                        <th>Amount</th>\r\n                                                        <th>Status</th>\r\n                                                        <th>Actions</th>\r\n                                                    </tr>\r\n                                                </thead>\r\n                                                <tbody id=\"dashboard-bookings-list\">\r\n                                                    ${renderBookingsTable(userBookings)}\r\n                                                </tbody>\r\n                                            </table>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                                \r\n                                <!-- Trip Plans Tab -->\r\n                                <div id=\"dashboard-trip-plans\" class=\"dashboard-tab-container\">\r\n                                    <div class=\"tab-header\">\r\n                                        <h2><i class=\"fas fa-route\"></i> My Trip Plans</h2>\r\n                                        <button class=\"btn btn-primary\" id=\"new-trip-plan-btn\">\r\n                                            <i class=\"fas fa-plus\"></i> Request New Trip Plan\r\n                                        </button>\r\n                                    </div>\r\n                                    <div class=\"dashboard-section\">\r\n                                        <div class=\"trip-plans-container\">\r\n                                            ${renderTripPlans(userTripPlans)}\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                                \r\n                                <!-- Profile Tab -->\r\n                                <div id=\"dashboard-profile\" class=\"dashboard-tab-container\">\r\n                                    <div class=\"tab-header\">\r\n                                        <h2><i class=\"fas fa-user-cog\"></i> Profile Settings</h2>\r\n                                    </div>\r\n                                    <div class=\"dashboard-section\">\r\n                                        <form id=\"dashboard-profile-form\" class=\"dashboard-form-grid\">\r\n                                            <div class=\"dashboard-form-group\">\r\n                                                <label><i class=\"fas fa-user\"></i> Full Name</label>\r\n                                                <input type=\"text\" name=\"name\" value=\"${currentUser.name}\" required>\r\n                                            </div>\r\n                                            \r\n                                            <div class=\"dashboard-form-group\">\r\n                                                <label><i class=\"fas fa-envelope\"></i> Email</label>\r\n                                                <input type=\"email\" value=\"${currentUser.email}\" disabled>\r\n                                                <small class=\"text-muted\">Contact support to change email</small>\r\n                                            </div>\r\n                                            \r\n                                            <div class=\"dashboard-form-group\">\r\n                                                <label><i class=\"fas fa-phone\"></i> Phone Number</label>\r\n                                                <input type=\"tel\" name=\"phone\" value=\"${currentUser.phone || ''}\" required>\r\n                                            </div>\r\n                                            \r\n                                            <div class=\"dashboard-form-group\">\r\n                                                <label><i class=\"fas fa-globe\"></i> Country</label>\r\n                                                <input type=\"text\" name=\"country\" value=\"${currentUser.country || ''}\" required>\r\n                                            </div>\r\n                                            \r\n                                            <div class=\"dashboard-form-group full-width\">\r\n                                                <label><i class=\"fas fa-home\"></i> Address</label>\r\n                                                <textarea name=\"address\" rows=\"2\">${currentUser.address || ''}</textarea>\r\n                                            </div>\r\n                                            \r\n                                            <div class=\"dashboard-form-group\">\r\n                                                <label><i class=\"fas fa-birthday-cake\"></i> Date of Birth</label>\r\n                                                <input type=\"date\" name=\"dob\" value=\"${currentUser.dob || ''}\">\r\n                                            </div>\r\n                                            \r\n                                            <div class=\"dashboard-form-group\">\r\n                                                <label><i class=\"fas fa-passport\"></i> Passport Number</label>\r\n                                                <input type=\"text\" name=\"passport\" value=\"${currentUser.passport || ''}\">\r\n                                            </div>\r\n                                            \r\n                                            <div class=\"dashboard-form-group full-width\">\r\n                                                <label><i class=\"fas fa-heart\"></i> Travel Preferences</label>\r\n                                                <textarea name=\"preferences\" rows=\"3\" placeholder=\"Any specific preferences, dietary requirements, or special needs...\">${currentUser.preferences || ''}</textarea>\r\n                                            </div>\r\n                                            \r\n                                            <div class=\"form-actions\">\r\n                                                <button type=\"submit\" class=\"btn btn-primary\">\r\n                                                    <i class=\"fas fa-save\"></i> Update Profile\r\n                                                </button>\r\n                                                <button type=\"button\" class=\"btn btn-outline\" id=\"change-password-btn\">\r\n                                                    <i class=\"fas fa-key\"></i> Change Password\r\n                                                </button>\r\n                                            </div>\r\n                                        </form>\r\n                                    </div>\r\n                                </div>\r\n                                \r\n                                <!-- Documents Tab -->\r\n                                <div id=\"dashboard-documents\" class=\"dashboard-tab-container\">\r\n                                    <div class=\"tab-header\">\r\n                                        <h2><i class=\"fas fa-file-alt\"></i> Travel Documents</h2>\r\n                                        <button class=\"btn btn-primary\" id=\"upload-document-btn\">\r\n                                            <i class=\"fas fa-upload\"></i> Upload Document\r\n                                        </button>\r\n                                    </div>\r\n                                    <div class=\"dashboard-section\">\r\n                                        <div class=\"documents-container\">\r\n                                            <div class=\"document-cards\">\r\n                                                <div class=\"document-card\">\r\n                                                    <div class=\"document-icon\">\r\n                                                        <i class=\"fas fa-passport\"></i>\r\n                                                    </div>\r\n                                                    <div class=\"document-content\">\r\n                                                        <h4>Passport</h4>\r\n                                                        <p>Upload your passport copy for visa processing</p>\r\n                                                        <div class=\"document-actions\">\r\n                                                            <button class=\"btn btn-sm btn-outline\">\r\n                                                                <i class=\"fas fa-upload\"></i> Upload\r\n                                                            </button>\r\n                                                            <button class=\"btn btn-sm btn-outline\" disabled>\r\n                                                                <i class=\"fas fa-eye\"></i> View\r\n                                                            </button>\r\n                                                        </div>\r\n                                                    </div>\r\n                                                </div>\r\n                                                \r\n                                                <div class=\"document-card\">\r\n                                                    <div class=\"document-icon\">\r\n                                                        <i class=\"fas fa-plane\"></i>\r\n                                                    </div>\r\n                                                    <div class=\"document-content\">\r\n                                                        <h4>Flight Tickets</h4>\r\n                                                        <p>Upload flight itinerary or e-tickets</p>\r\n                                                        <div class=\"document-actions\">\r\n                                                            <button class=\"btn btn-sm btn-outline\">\r\n                                                                <i class=\"fas fa-upload\"></i> Upload\r\n                                                            </button>\r\n                                                        </div>\r\n                                                    </div>\r\n                                                </div>\r\n                                                \r\n                                                <div class=\"document-card\">\r\n                                                    <div class=\"document-icon\">\r\n                                                        <i class=\"fas fa-file-medical\"></i>\r\n                                                    </div>\r\n                                                    <div class=\"document-content\">\r\n                                                        <h4>Medical Insurance</h4>\r\n                                                        <p>Travel medical insurance documents</p>\r\n                                                        <div class=\"document-actions\">\r\n                                                            <button class=\"btn btn-sm btn-outline\">\r\n                                                                <i class=\"fas fa-upload\"></i> Upload\r\n                                                            </button>\r\n                                                        </div>\r\n                                                    </div>\r\n                                                </div>\r\n                                            </div>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            `;\r\n            \r\n            // Setup dashboard event listeners\r\n            setupEnhancedDashboardListeners();\r\n            \r\n        } catch (error) {\r\n            console.error('Error loading dashboard:', error);\r\n            dashboard.innerHTML = `\r\n                <div class=\"container\">\r\n                    <div class=\"error-state\">\r\n                        <i class=\"fas fa-exclamation-triangle fa-3x\"></i>\r\n                        <h3>Error loading dashboard</h3>\r\n                        <p>${error.message}</p>\r\n                        <button class=\"btn btn-primary\" onclick=\"location.reload()\">\r\n                            <i class=\"fas fa-redo\"></i> Retry\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n            `;\r\n        }\r\n    }\r\n\r\n    function renderRecentBookings(bookings) {\r\n        if (bookings.length === 0) {\r\n            return `\r\n                <div class=\"dashboard-empty-state\">\r\n                    <i class=\"fas fa-calendar-times\"></i>\r\n                    <p>No recent bookings</p>\r\n                    <button class=\"btn btn-sm btn-outline\" onclick=\"showServiceSelectionModal()\">\r\n                        Book Your First Trip\r\n                    </button>\r\n                </div>\r\n            `;\r\n        }\r\n        \r\n        return bookings.map(booking => `\r\n            <div class=\"dashboard-booking-card\">\r\n                <div class=\"dashboard-booking-header\">\r\n                    <div class=\"booking-service-type\">\r\n                        <span class=\"service-badge service-${booking.serviceType}\">\r\n                            ${booking.serviceType}\r\n                        </span>\r\n                    </div>\r\n                    <span class=\"dashboard-booking-status dashboard-status-${booking.status}\">\r\n                        ${booking.status.toUpperCase()}\r\n                    </span>\r\n                </div>\r\n                \r\n                <h4 class=\"dashboard-booking-title\">${booking.serviceName}</h4>\r\n                \r\n                <div class=\"dashboard-booking-details\">\r\n                    <p><i class=\"far fa-calendar\"></i> ${new Date(booking.date).toLocaleDateString()}</p>\r\n                    <p><i class=\"fas fa-users\"></i> ${booking.travelers} travelers</p>\r\n                    <p><i class=\"fas fa-hashtag\"></i> ${booking._id}</p>\r\n                </div>\r\n                \r\n                <div class=\"dashboard-booking-footer\">\r\n                    <div class=\"booking-amount\">\r\n                        <strong>$${booking.totalAmount || '0'}</strong>\r\n                    </div>\r\n                    <div class=\"dashboard-booking-actions\">\r\n                        <button class=\"btn btn-sm btn-outline\" onclick=\"viewBookingDetails('${booking._id}')\">\r\n                            <i class=\"fas fa-eye\"></i>\r\n                        </button>\r\n                        ${booking.status === 'pending' ? `\r\n                            <button class=\"btn btn-sm btn-danger\" onclick=\"cancelBooking('${booking._id}')\">\r\n                                <i class=\"fas fa-times\"></i>\r\n                            </button>\r\n                        ` : ''}\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        `).join('');\r\n    }\r\n\r\n    function renderBookingsTable(bookings) {\r\n        if (bookings.length === 0) {\r\n            return `\r\n                <tr>\r\n                    <td colspan=\"6\" class=\"text-center\">\r\n                        <div class=\"empty-table-state\">\r\n                            <i class=\"fas fa-calendar-times fa-2x\"></i>\r\n                            <p>No bookings yet</p>\r\n                            <button class=\"btn btn-primary\" onclick=\"showServiceSelectionModal()\">\r\n                                Book Your First Trip\r\n                            </button>\r\n                        </div>\r\n                    </td>\r\n                </tr>\r\n            `;\r\n        }\r\n        \r\n        return bookings.map(booking => `\r\n            <tr>\r\n                <td>\r\n                    <div class=\"service-cell\">\r\n                        <div class=\"service-icon-small service-${booking.serviceType}\">\r\n                            <i class=\"fas fa-${getServiceIcon(booking.serviceType)}\"></i>\r\n                        </div>\r\n                        <div>\r\n                            <strong>${booking.serviceName}</strong>\r\n                            <small>${booking._id}</small>\r\n                        </div>\r\n                    </div>\r\n                </td>\r\n                <td>\r\n                    <span class=\"badge badge-service\">${booking.serviceType}</span>\r\n                </td>\r\n                <td>\r\n                    ${new Date(booking.date).toLocaleDateString()}<br>\r\n                    <small>${booking.duration || 1} days</small>\r\n                </td>\r\n                <td>\r\n                    <strong>$${booking.totalAmount || '0'}</strong>\r\n                </td>\r\n                <td>\r\n                    <span class=\"badge badge-${booking.status}\">\r\n                        ${booking.status.toUpperCase()}\r\n                    </span>\r\n                </td>\r\n                <td>\r\n                    <div class=\"table-actions\">\r\n                        <button class=\"btn-action btn-view\" onclick=\"viewBookingDetails('${booking._id}')\">\r\n                            <i class=\"fas fa-eye\"></i>\r\n                        </button>\r\n                        ${booking.status === 'pending' ? `\r\n                            <button class=\"btn-action btn-edit\" onclick=\"editBooking('${booking._id}')\">\r\n                                <i class=\"fas fa-edit\"></i>\r\n                            </button>\r\n                            <button class=\"btn-action btn-cancel\" onclick=\"cancelBooking('${booking._id}')\">\r\n                                <i class=\"fas fa-times\"></i>\r\n                            </button>\r\n                        ` : ''}\r\n                        <button class=\"btn-action btn-download\" onclick=\"downloadBookingInvoice('${booking._id}')\">\r\n                            <i class=\"fas fa-download\"></i>\r\n                        </button>\r\n                    </div>\r\n                </td>\r\n            </tr>\r\n        `).join('');\r\n    }\r\n\r\n    function renderRecentTripPlans(tripPlans) {\r\n        if (tripPlans.length === 0) {\r\n            return `\r\n                <div class=\"dashboard-empty-state\">\r\n                    <i class=\"fas fa-route\"></i>\r\n                    <p>No trip plans yet</p>\r\n                    <button class=\"btn btn-sm btn-outline\" onclick=\"showTripPlanModal()\">\r\n                        Plan Your First Trip\r\n                    </button>\r\n                </div>\r\n            `;\r\n        }\r\n        \r\n        return tripPlans.map(trip => `\r\n            <div class=\"dashboard-booking-card\">\r\n                <div class=\"dashboard-booking-header\">\r\n                    <div class=\"booking-service-type\">\r\n                        <span class=\"service-badge service-trip\">\r\n                            <i class=\"fas fa-route\"></i> TRIP PLAN\r\n                        </span>\r\n                    </div>\r\n                    <span class=\"dashboard-booking-status dashboard-status-${trip.status}\">\r\n                        ${trip.status.toUpperCase()}\r\n                    </span>\r\n                </div>\r\n                \r\n                <h4 class=\"dashboard-booking-title\">${trip.duration} Trip</h4>\r\n                \r\n                <div class=\"dashboard-booking-details\">\r\n                    <p><i class=\"far fa-calendar\"></i> Start: ${new Date(trip.startDate).toLocaleDateString()}</p>\r\n                    <p><i class=\"fas fa-users\"></i> ${trip.travelers} travelers</p>\r\n                    <p><i class=\"fas fa-wallet\"></i> Budget: ${trip.budget}</p>\r\n                </div>\r\n                \r\n                <div class=\"trip-interests\">\r\n                    ${trip.interests && trip.interests.length > 0 ? \r\n                        trip.interests.map(interest => `\r\n                            <span class=\"interest-tag\">${interest}</span>\r\n                        `).join('') : \r\n                        '<small>No specific interests</small>'\r\n                    }\r\n                </div>\r\n                \r\n                <div class=\"dashboard-booking-footer\">\r\n                    <div class=\"trip-plan-date\">\r\n                        <small>Requested: ${new Date(trip.createdAt).toLocaleDateString()}</small>\r\n                    </div>\r\n                    <div class=\"dashboard-booking-actions\">\r\n                        <button class=\"btn btn-sm btn-outline\" onclick=\"viewTripPlan('${trip._id}')\">\r\n                            View Details\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        `).join('');\r\n    }\r\n\r\n    function renderTripPlans(tripPlans) {\r\n        if (tripPlans.length === 0) {\r\n            return `\r\n                <div class=\"empty-state\">\r\n                    <div class=\"empty-state-icon\">\r\n                        <i class=\"fas fa-route fa-3x\"></i>\r\n                    </div>\r\n                    <h3>No Trip Plans Yet</h3>\r\n                    <p>Start planning your perfect Rwanda adventure</p>\r\n                    <button class=\"btn btn-primary\" onclick=\"showTripPlanModal()\">\r\n                        <i class=\"fas fa-plus\"></i> Request Trip Plan\r\n                    </button>\r\n                </div>\r\n            `;\r\n        }\r\n        \r\n        return tripPlans.map(trip => `\r\n            <div class=\"trip-plan-card\">\r\n                <div class=\"trip-plan-header\">\r\n                    <div class=\"trip-plan-id\">\r\n                        <h4>${trip._id}</h4>\r\n                        <span class=\"badge badge-${trip.status}\">${trip.status}</span>\r\n                    </div>\r\n                    <div class=\"trip-plan-date\">\r\n                        <small>Requested: ${new Date(trip.createdAt).toLocaleDateString()}</small>\r\n                    </div>\r\n                </div>\r\n                \r\n                <div class=\"trip-plan-details\">\r\n                    <div class=\"detail-row\">\r\n                        <div class=\"detail-item\">\r\n                            <i class=\"fas fa-calendar\"></i>\r\n                            <div>\r\n                                <label>Start Date</label>\r\n                                <p>${new Date(trip.startDate).toLocaleDateString()}</p>\r\n                            </div>\r\n                        </div>\r\n                        <div class=\"detail-item\">\r\n                            <i class=\"fas fa-clock\"></i>\r\n                            <div>\r\n                                <label>Duration</label>\r\n                                <p>${trip.duration}</p>\r\n                            </div>\r\n                        </div>\r\n                        <div class=\"detail-item\">\r\n                            <i class=\"fas fa-users\"></i>\r\n                            <div>\r\n                                <label>Travelers</label>\r\n                                <p>${trip.travelers} people</p>\r\n                            </div>\r\n                        </div>\r\n                        <div class=\"detail-item\">\r\n                            <i class=\"fas fa-wallet\"></i>\r\n                            <div>\r\n                                <label>Budget</label>\r\n                                <p>${trip.budget}</p>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    \r\n                    ${trip.interests && trip.interests.length > 0 ? `\r\n                        <div class=\"detail-row\">\r\n                            <div class=\"detail-item full-width\">\r\n                                <i class=\"fas fa-heart\"></i>\r\n                                <div>\r\n                                    <label>Interests</label>\r\n                                    <div class=\"interests-container\">\r\n                                        ${trip.interests.map(interest => `\r\n                                            <span class=\"interest-tag\">${interest}</span>\r\n                                        `).join('')}\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    ` : ''}\r\n                    \r\n                    ${trip.message ? `\r\n                        <div class=\"detail-row\">\r\n                            <div class=\"detail-item full-width\">\r\n                                <i class=\"fas fa-comment\"></i>\r\n                                <div>\r\n                                    <label>Notes</label>\r\n                                    <p>${trip.message}</p>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    ` : ''}\r\n                    \r\n                    ${trip.itinerary ? `\r\n                        <div class=\"detail-row\">\r\n                            <div class=\"detail-item full-width\">\r\n                                <i class=\"fas fa-map\"></i>\r\n                                <div>\r\n                                    <label>Itinerary</label>\r\n                                    <div class=\"itinerary-container\">\r\n                                        ${renderItinerary(trip.itinerary)}\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    ` : ''}\r\n                </div>\r\n                \r\n                <div class=\"trip-plan-footer\">\r\n                    <div class=\"trip-plan-actions\">\r\n                        ${trip.status === 'review' ? `\r\n                            <button class=\"btn btn-sm btn-outline\" onclick=\"editTripPlan('${trip._id}')\">\r\n                                <i class=\"fas fa-edit\"></i> Edit\r\n                            </button>\r\n                            <button class=\"btn btn-sm btn-danger\" onclick=\"cancelTripPlan('${trip._id}')\">\r\n                                <i class=\"fas fa-times\"></i> Cancel\r\n                            </button>\r\n                        ` : ''}\r\n                        \r\n                        ${trip.itinerary ? `\r\n                            <button class=\"btn btn-sm btn-primary\" onclick=\"downloadItinerary('${trip._id}')\">\r\n                                <i class=\"fas fa-download\"></i> Download Itinerary\r\n                            </button>\r\n                        ` : `\r\n                            <button class=\"btn btn-sm btn-outline\" disabled>\r\n                                <i class=\"fas fa-clock\"></i> Processing...\r\n                            </button>\r\n                        `}\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        `).join('');\r\n    }\r\n\r\n    function renderItinerary(itinerary) {\r\n        if (!itinerary || !itinerary.days) return '<p>No itinerary available</p>';\r\n        \r\n        return itinerary.days.map(day => `\r\n            <div class=\"itinerary-day\">\r\n                <h5>Day ${day.day}: ${day.title}</h5>\r\n                <div class=\"itinerary-activities\">\r\n                    ${day.activities.map(activity => `\r\n                        <div class=\"itinerary-activity\">\r\n                            <i class=\"fas fa-${activity.icon || 'map-marker-alt'}\"></i>\r\n                            <div>\r\n                                <strong>${activity.time}</strong>\r\n                                <p>${activity.description}</p>\r\n                                ${activity.location ? `<small><i class=\"fas fa-map-pin\"></i> ${activity.location}</small>` : ''}\r\n                            </div>\r\n                        </div>\r\n                    `).join('')}\r\n                </div>\r\n            </div>\r\n        `).join('');\r\n    }\r\n\r\n    function getServiceIcon(serviceType) {\r\n        const icons = {\r\n            'destination': 'map-marked-alt',\r\n            'guide': 'user-tie',\r\n            'translator': 'language',\r\n            'accommodation': 'hotel',\r\n            'trip': 'route'\r\n        };\r\n        return icons[serviceType] || 'question-circle';\r\n    }\r\n\r\n    function setupEnhancedDashboardListeners() {\r\n        // Tab switching\r\n        document.querySelectorAll('.dashboard-tab-link').forEach(link => {\r\n            link.addEventListener('click', function(e) {\r\n                e.preventDefault();\r\n                \r\n                // Remove active class from all tabs\r\n                document.querySelectorAll('.dashboard-tab-link').forEach(l => l.classList.remove('active'));\r\n                document.querySelectorAll('.dashboard-tab-container').forEach(c => c.classList.remove('active'));\r\n                \r\n                // Add active class to clicked tab\r\n                this.classList.add('active');\r\n                const tabId = 'dashboard-' + this.dataset.tab;\r\n                const tabElement = document.getElementById(tabId);\r\n                if (tabElement) {\r\n                    tabElement.classList.add('active');\r\n                }\r\n            });\r\n        });\r\n        \r\n        // New booking button\r\n        document.getElementById('dashboard-new-booking-btn')?.addEventListener('click', () => {\r\n            showServiceSelectionModal();\r\n        });\r\n        \r\n        // Plan trip button\r\n        document.getElementById('dashboard-plan-trip-btn')?.addEventListener('click', () => {\r\n            showTripPlanModal();\r\n        });\r\n        \r\n        // New booking modal button\r\n        document.getElementById('new-booking-modal-btn')?.addEventListener('click', () => {\r\n            showServiceSelectionModal();\r\n        });\r\n        \r\n        // New trip plan button\r\n        document.getElementById('new-trip-plan-btn')?.addEventListener('click', () => {\r\n            showTripPlanModal();\r\n        });\r\n        \r\n        // Change password button\r\n        document.getElementById('change-password-btn')?.addEventListener('click', () => {\r\n            showChangePasswordModal();\r\n        });\r\n        \r\n        // Upload document button\r\n        document.getElementById('upload-document-btn')?.addEventListener('click', () => {\r\n            showUploadDocumentModal();\r\n        });\r\n        \r\n        // Booking filter\r\n        const bookingFilter = document.getElementById('dashboard-booking-filter');\r\n        if (bookingFilter) {\r\n            bookingFilter.addEventListener('change', function(e) {\r\n                filterBookings(this.value);\r\n            });\r\n        }\r\n        \r\n        // Profile form submission\r\n        const profileForm = document.getElementById('dashboard-profile-form');\r\n        if (profileForm) {\r\n            profileForm.addEventListener('submit', async function(e) {\r\n                e.preventDefault();\r\n                const formData = new FormData(this);\r\n                const data = Object.fromEntries(formData.entries());\r\n                \r\n                try {\r\n                    const updatedUser = userManager.updateUser(currentUser._id, data);\r\n                    if (updatedUser) {\r\n                        currentUser = updatedUser;\r\n                        saveUserData(currentUser);\r\n                        showNotification('âœ… Profile updated successfully!', 'success');\r\n                        setTimeout(() => {\r\n                            loadDashboard();\r\n                        }, 1000);\r\n                    }\r\n                } catch (error) {\r\n                    showNotification('âŒ Error updating profile', 'error');\r\n                }\r\n            });\r\n        }\r\n    }\r\n\r\n    // ===============================\r\n    // ADMIN DASHBOARD FUNCTIONS\r\n    // ===============================\r\n\r\n    async function loadAdminDashboard() {\r\n        console.log('Loading admin dashboard...');\r\n        \r\n        // Check admin access\r\n        if (!isAuthenticated || currentUser?.role !== 'admin') {\r\n            showNotification('Admin access required', 'error');\r\n            showPage('home');\r\n            return;\r\n        }\r\n        \r\n        const admin = document.getElementById('admin');\r\n        if (!admin) return;\r\n        \r\n        try {\r\n            const stats = userManager.getStats();\r\n            const monthlyRevenue = userManager.getMonthlyRevenue();\r\n            const recentActivity = userManager.getRecentActivity();\r\n            const recentBookings = userManager.bookings.slice(-5).reverse();\r\n            const recentUsers = userManager.users.slice(-5).reverse();\r\n            \r\n            admin.innerHTML = `\r\n                <div class=\"admin-dashboard\">\r\n                    <div class=\"dashboard-header\">\r\n                        <div class=\"container\">\r\n                            <h1><i class=\"fas fa-crown\"></i> Admin Dashboard</h1>\r\n                            <p>System administration and management panel</p>\r\n                        </div>\r\n                    </div>\r\n                    \r\n                    <div class=\"container\">\r\n                        <div class=\"admin-controls\">\r\n                            <div class=\"admin-search\">\r\n                                <input type=\"text\" placeholder=\"Search users, bookings, trips...\" id=\"admin-search-input\">\r\n                                <button class=\"btn btn-primary\">\r\n                                    <i class=\"fas fa-search\"></i>\r\n                                </button>\r\n                            </div>\r\n                            <div class=\"admin-actions\">\r\n                                <button class=\"btn btn-success\" id=\"add-user-btn\">\r\n                                    <i class=\"fas fa-user-plus\"></i> Add User\r\n                                </button>\r\n                                <button class=\"btn btn-primary\" id=\"generate-report-btn\">\r\n                                    <i class=\"fas fa-file-export\"></i> Generate Report\r\n                                </button>\r\n                            </div>\r\n                        </div>\r\n                        \r\n                        <div class=\"dashboard-stats\">\r\n                            <div class=\"dashboard-stat-card admin-stat\">\r\n                                <div class=\"dashboard-stat-icon users\">\r\n                                    <i class=\"fas fa-users\"></i>\r\n                                </div>\r\n                                <div class=\"dashboard-stat-content\">\r\n                                    <h3>Total Users</h3>\r\n                                    <p class=\"dashboard-stat-number\">${stats.totalUsers}</p>\r\n                                    <p class=\"dashboard-stat-subtitle\">\r\n                                        <span class=\"stat-change positive\">+2 this week</span>\r\n                                    </p>\r\n                                </div>\r\n                            </div>\r\n                            \r\n                            <div class=\"dashboard-stat-card admin-stat\">\r\n                                <div class=\"dashboard-stat-icon bookings\">\r\n                                    <i class=\"fas fa-calendar-alt\"></i>\r\n                                </div>\r\n                                <div class=\"dashboard-stat-content\">\r\n                                    <h3>Total Bookings</h3>\r\n                                    <p class=\"dashboard-stat-number\">${stats.totalBookings}</p>\r\n                                    <p class=\"dashboard-stat-subtitle\">\r\n                                        <span class=\"stat-change positive\">+5 this month</span>\r\n                                    </p>\r\n                                </div>\r\n                            </div>\r\n                            \r\n                            <div class=\"dashboard-stat-card admin-stat\">\r\n                                <div class=\"dashboard-stat-icon revenue\">\r\n                                    <i class=\"fas fa-dollar-sign\"></i>\r\n                                </div>\r\n                                <div class=\"dashboard-stat-content\">\r\n                                    <h3>Total Revenue</h3>\r\n                                    <p class=\"dashboard-stat-number\">$${stats.totalRevenue.toLocaleString()}</p>\r\n                                    <p class=\"dashboard-stat-subtitle\">\r\n                                        <span class=\"stat-change positive\">+15% this month</span>\r\n                                    </p>\r\n                                </div>\r\n                            </div>\r\n                            \r\n                            <div class=\"dashboard-stat-card admin-stat\">\r\n                                <div class=\"dashboard-stat-icon pending\">\r\n                                    <i class=\"fas fa-clock\"></i>\r\n                                </div>\r\n                                <div class=\"dashboard-stat-content\">\r\n                                    <h3>Active Bookings</h3>\r\n                                    <p class=\"dashboard-stat-number\">${stats.activeBookings}</p>\r\n                                    <p class=\"dashboard-stat-subtitle\">\r\n                                        ${stats.pendingTripPlans} pending trips\r\n                                    </p>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                        \r\n                        <div class=\"admin-grid\">\r\n                            <div class=\"admin-column\">\r\n                                <div class=\"admin-widget\">\r\n                                    <div class=\"widget-header\">\r\n                                        <h3><i class=\"fas fa-chart-line\"></i> Revenue Overview</h3>\r\n                                        <select class=\"form-select-sm\" id=\"revenue-period\">\r\n                                            <option value=\"monthly\">Monthly</option>\r\n                                            <option value=\"weekly\">Weekly</option>\r\n                                            <option value=\"yearly\">Yearly</option>\r\n                                        </select>\r\n                                    </div>\r\n                                    <div class=\"widget-body\">\r\n                                        <div class=\"revenue-chart\">\r\n                                            ${renderRevenueChart(monthlyRevenue)}\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                                \r\n                                <div class=\"admin-widget\">\r\n                                    <div class=\"widget-header\">\r\n                                        <h3><i class=\"fas fa-bell\"></i> Recent Activity</h3>\r\n                                        <button class=\"btn-link\" id=\"view-all-activity\">View All</button>\r\n                                    </div>\r\n                                    <div class=\"widget-body\">\r\n                                        <div class=\"activity-list\">\r\n                                            ${renderRecentActivity(recentActivity)}\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                            \r\n                            <div class=\"admin-column\">\r\n                                <div class=\"admin-widget\">\r\n                                    <div class=\"widget-header\">\r\n                                        <h3><i class=\"fas fa-users\"></i> Recent Users</h3>\r\n                                        <button class=\"btn-link\" id=\"view-all-users\">View All</button>\r\n                                    </div>\r\n                                    <div class=\"widget-body\">\r\n                                        <div class=\"users-list\">\r\n                                            ${renderRecentUsers(recentUsers)}\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                                \r\n                                <div class=\"admin-widget\">\r\n                                    <div class=\"widget-header\">\r\n                                        <h3><i class=\"fas fa-calendar-check\"></i> Recent Bookings</h3>\r\n                                        <button class=\"btn-link\" id=\"view-all-bookings\">View All</button>\r\n                                    </div>\r\n                                    <div class=\"widget-body\">\r\n                                        <div class=\"bookings-list\">\r\n                                            ${renderAdminRecentBookings(recentBookings)}\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                        \r\n                        <!-- Tabs for detailed management -->\r\n                        <div class=\"admin-tabs\">\r\n                            <nav class=\"admin-tab-nav\">\r\n                                <button class=\"admin-tab-link active\" data-tab=\"users-management\">\r\n                                    <i class=\"fas fa-users-cog\"></i> Users Management\r\n                                </button>\r\n                                <button class=\"admin-tab-link\" data-tab=\"bookings-management\">\r\n                                    <i class=\"fas fa-calendar-check\"></i> Bookings Management\r\n                                </button>\r\n                                <button class=\"admin-tab-link\" data-tab=\"trip-plans-management\">\r\n                                    <i class=\"fas fa-route\"></i> Trip Plans Management\r\n                                </button>\r\n                                <button class=\"admin-tab-link\" data-tab=\"services-management\">\r\n                                    <i class=\"fas fa-concierge-bell\"></i> Services Management\r\n                                </button>\r\n                                <button class=\"admin-tab-link\" data-tab=\"reports\">\r\n                                    <i class=\"fas fa-chart-bar\"></i> Reports\r\n                                </button>\r\n                            </nav>\r\n                            \r\n                            <div class=\"admin-tab-content\">\r\n                                <!-- Users Management Tab -->\r\n                                <div id=\"users-management\" class=\"admin-tab-pane active\">\r\n                                    <div class=\"admin-table-container\">\r\n                                        <div class=\"table-header\">\r\n                                            <h3>Users Management</h3>\r\n                                            <div class=\"table-actions\">\r\n                                                <button class=\"btn btn-sm btn-success\" id=\"add-new-user-btn\">\r\n                                                    <i class=\"fas fa-plus\"></i> Add User\r\n                                                </button>\r\n                                                <button class=\"btn btn-sm btn-outline\" id=\"export-users-btn\">\r\n                                                    <i class=\"fas fa-download\"></i> Export\r\n                                                </button>\r\n                                            </div>\r\n                                        </div>\r\n                                        <div class=\"table-responsive\">\r\n                                            <table class=\"admin-table\">\r\n                                                <thead>\r\n                                                    <tr>\r\n                                                        <th>User</th>\r\n                                                        <th>Email</th>\r\n                                                        <th>Role</th>\r\n                                                        <th>Status</th>\r\n                                                        <th>Joined</th>\r\n                                                        <th>Actions</th>\r\n                                                    </tr>\r\n                                                </thead>\r\n                                                <tbody id=\"users-table-body\">\r\n                                                    ${renderUsersTable(userManager.users)}\r\n                                                </tbody>\r\n                                            </table>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                                \r\n                                <!-- Bookings Management Tab -->\r\n                                <div id=\"bookings-management\" class=\"admin-tab-pane\">\r\n                                    <div class=\"admin-table-container\">\r\n                                        <div class=\"table-header\">\r\n                                            <h3>Bookings Management</h3>\r\n                                            <div class=\"table-actions\">\r\n                                                <select class=\"form-select-sm\" id=\"booking-type-filter\">\r\n                                                    <option value=\"\">All Types</option>\r\n                                                    <option value=\"destination\">Destinations</option>\r\n                                                    <option value=\"guide\">Guides</option>\r\n                                                    <option value=\"translator\">Translators</option>\r\n                                                    <option value=\"accommodation\">Accommodations</option>\r\n                                                </select>\r\n                                                <button class=\"btn btn-sm btn-outline\" id=\"export-bookings-btn\">\r\n                                                    <i class=\"fas fa-download\"></i> Export\r\n                                                </button>\r\n                                            </div>\r\n                                        </div>\r\n                                        <div class=\"table-responsive\">\r\n                                            <table class=\"admin-table\">\r\n                                                <thead>\r\n                                                    <tr>\r\n                                                        <th>Booking ID</th>\r\n                                                        <th>User</th>\r\n                                                        <th>Service</th>\r\n                                                        <th>Amount</th>\r\n                                                        <th>Status</th>\r\n                                                        <th>Date</th>\r\n                                                        <th>Actions</th>\r\n                                                    </tr>\r\n                                                </thead>\r\n                                                <tbody id=\"bookings-table-body\">\r\n                                                    ${renderAdminBookingsTable(userManager.bookings)}\r\n                                                </tbody>\r\n                                            </table>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                                \r\n                                <!-- Trip Plans Management Tab -->\r\n                                <div id=\"trip-plans-management\" class=\"admin-tab-pane\">\r\n                                    <div class=\"admin-table-container\">\r\n                                        <div class=\"table-header\">\r\n                                            <h3>Trip Plans Management</h3>\r\n                                            <div class=\"table-actions\">\r\n                                                <select class=\"form-select-sm\" id=\"trip-status-filter\">\r\n                                                    <option value=\"\">All Status</option>\r\n                                                    <option value=\"review\">Review</option>\r\n                                                    <option value=\"processing\">Processing</option>\r\n                                                    <option value=\"completed\">Completed</option>\r\n                                                    <option value=\"cancelled\">Cancelled</option>\r\n                                                </select>\r\n                                                <button class=\"btn btn-sm btn-outline\" id=\"export-trips-btn\">\r\n                                                    <i class=\"fas fa-download\"></i> Export\r\n                                                </button>\r\n                                            </div>\r\n                                        </div>\r\n                                        <div class=\"table-responsive\">\r\n                                            <table class=\"admin-table\">\r\n                                                <thead>\r\n                                                    <tr>\r\n                                                        <th>Trip ID</th>\r\n                                                        <th>User</th>\r\n                                                        <th>Duration</th>\r\n                                                        <th>Budget</th>\r\n                                                        <th>Status</th>\r\n                                                        <th>Requested</th>\r\n                                                        <th>Actions</th>\r\n                                                    </tr>\r\n                                                </thead>\r\n                                                <tbody id=\"trips-table-body\">\r\n                                                    ${renderAdminTripsTable(userManager.tripPlans)}\r\n                                                </tbody>\r\n                                            </table>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                                \r\n                                <!-- Services Management Tab -->\r\n                                <div id=\"services-management\" class=\"admin-tab-pane\">\r\n                                    <div class=\"services-management\">\r\n                                        <div class=\"services-tabs\">\r\n                                            <button class=\"service-tab active\" data-service=\"guides\">\r\n                                                <i class=\"fas fa-user-tie\"></i> Guides\r\n                                            </button>\r\n                                            <button class=\"service-tab\" data-service=\"translators\">\r\n                                                <i class=\"fas fa-language\"></i> Translators\r\n                                            </button>\r\n                                            <button class=\"service-tab\" data-service=\"accommodations\">\r\n                                                <i class=\"fas fa-hotel\"></i> Accommodations\r\n                                            </button>\r\n                                            <button class=\"service-tab\" data-service=\"destinations\">\r\n                                                <i class=\"fas fa-map-marked-alt\"></i> Destinations\r\n                                            </button>\r\n                                            <button class=\"service-tab\" data-service=\"blog\">\r\n                                                <i class=\"fas fa-newspaper\"></i> Blog Posts\r\n                                            </button>\r\n                                        </div>\r\n                                        \r\n                                        <div class=\"services-content\">\r\n                                            <div id=\"guides-management\" class=\"service-tab-content active\">\r\n                                                <div class=\"service-header\">\r\n                                                    <h3>Tour Guides Management</h3>\r\n                                                    <button class=\"btn btn-success\" id=\"add-guide-btn\">\r\n                                                        <i class=\"fas fa-plus\"></i> Add Guide\r\n                                                    </button>\r\n                                                </div>\r\n                                                <div class=\"service-table-container\">\r\n                                                    <table class=\"admin-table\">\r\n                                                        <thead>\r\n                                                            <tr>\r\n                                                                <th>Guide</th>\r\n                                                                <th>Specialty</th>\r\n                                                                <th>Languages</th>\r\n                                                                <th>Rate</th>\r\n                                                                <th>Status</th>\r\n                                                                <th>Actions</th>\r\n                                                            </tr>\r\n                                                        </thead>\r\n                                                        <tbody>\r\n                                                            ${mockData.guides.map(guide => `\r\n                                                                <tr>\r\n                                                                    <td>\r\n                                                                        <div class=\"user-cell\">\r\n                                                                            <div class=\"user-avatar-small\">\r\n                                                                                <i class=\"fas fa-user-tie\"></i>\r\n                                                                            </div>\r\n                                                                            <div>\r\n                                                                                <strong>${guide.name}</strong>\r\n                                                                                <small>${guide.experience}</small>\r\n                                                                            </div>\r\n                                                                        </div>\r\n                                                                    </td>\r\n                                                                    <td>${guide.specialty}</td>\r\n                                                                    <td>${guide.languages.slice(0, 2).join(', ')}${guide.languages.length > 2 ? '...' : ''}</td>\r\n                                                                    <td>${guide.price}</td>\r\n                                                                    <td>\r\n                                                                        <span class=\"badge badge-${guide.available ? 'success' : 'secondary'}\">\r\n                                                                            ${guide.available ? 'Available' : 'Busy'}\r\n                                                                        </span>\r\n                                                                    </td>\r\n                                                                    <td>\r\n                                                                        <div class=\"table-actions\">\r\n                                                                            <button class=\"btn-action btn-view\" onclick=\"viewGuideDetails(${guide._id})\">\r\n                                                                                <i class=\"fas fa-eye\"></i>\r\n                                                                            </button>\r\n                                                                            <button class=\"btn-action btn-edit\" onclick=\"editGuide(${guide._id})\">\r\n                                                                                <i class=\"fas fa-edit\"></i>\r\n                                                                            </button>\r\n                                                                            <button class=\"btn-action btn-delete\" onclick=\"deleteGuide(${guide._id})\">\r\n                                                                                <i class=\"fas fa-trash\"></i>\r\n                                                                            </button>\r\n                                                                        </div>\r\n                                                                    </td>\r\n                                                                </tr>\r\n                                                            `).join('')}\r\n                                                        </tbody>\r\n                                                    </table>\r\n                                                </div>\r\n                                            </div>\r\n                                            <!-- Other services tabs -->\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                                \r\n                                <!-- Reports Tab -->\r\n                                <div id=\"reports\" class=\"admin-tab-pane\">\r\n                                    <div class=\"reports-container\">\r\n                                        <h3>Generate Reports</h3>\r\n                                        <div class=\"reports-grid\">\r\n                                            <div class=\"report-card\">\r\n                                                <div class=\"report-icon\">\r\n                                                    <i class=\"fas fa-file-invoice-dollar\"></i>\r\n                                                </div>\r\n                                                <h4>Revenue Report</h4>\r\n                                                <p>Monthly revenue breakdown</p>\r\n                                                <button class=\"btn btn-primary\" onclick=\"generateReport('revenue')\">\r\n                                                    Generate\r\n                                                </button>\r\n                                            </div>\r\n                                            <div class=\"report-card\">\r\n                                                <div class=\"report-icon\">\r\n                                                    <i class=\"fas fa-users\"></i>\r\n                                                </div>\r\n                                                <h4>User Report</h4>\r\n                                                <p>User statistics and growth</p>\r\n                                                <button class=\"btn btn-primary\" onclick=\"generateReport('users')\">\r\n                                                    Generate\r\n                                                </button>\r\n                                            </div>\r\n                                            <div class=\"report-card\">\r\n                                                <div class=\"report-icon\">\r\n                                                    <i class=\"fas fa-calendar-alt\"></i>\r\n                                                </div>\r\n                                                <h4>Bookings Report</h4>\r\n                                                <p>Booking trends and performance</p>\r\n                                                <button class=\"btn btn-primary\" onclick=\"generateReport('bookings')\">\r\n                                                    Generate\r\n                                                </button>\r\n                                            </div>\r\n                                            <div class=\"report-card\">\r\n                                                <div class=\"report-icon\">\r\n                                                    <i class=\"fas fa-chart-pie\"></i>\r\n                                                </div>\r\n                                                <h4>Custom Report</h4>\r\n                                                <p>Create custom report</p>\r\n                                                <button class=\"btn btn-primary\" onclick=\"showCustomReportModal()\">\r\n                                                    Create\r\n                                                </button>\r\n                                            </div>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            `;\r\n            \r\n            // Setup admin dashboard event listeners\r\n            setupAdminDashboardListeners();\r\n            \r\n        } catch (error) {\r\n            console.error('Error loading admin dashboard:', error);\r\n            admin.innerHTML = `\r\n                <div class=\"container\">\r\n                    <div class=\"error-state\">\r\n                        <i class=\"fas fa-exclamation-triangle fa-3x\"></i>\r\n                        <h3>Error loading admin dashboard</h3>\r\n                        <p>${error.message}</p>\r\n                        <button class=\"btn btn-primary\" onclick=\"location.reload()\">\r\n                            Retry\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n            `;\r\n        }\r\n    }\r\n\r\n    function renderRevenueChart(monthlyRevenue) {\r\n        if (monthlyRevenue.length === 0) {\r\n            return '<p class=\"text-center\">No revenue data available</p>';\r\n        }\r\n        \r\n        const maxRevenue = Math.max(...monthlyRevenue.map(m => m.revenue));\r\n        \r\n        return monthlyRevenue.map(item => {\r\n            const height = (item.revenue / maxRevenue) * 100;\r\n            return `\r\n                <div class=\"chart-bar-container\">\r\n                    <div class=\"chart-bar\" style=\"height: ${height}%\">\r\n                        <div class=\"chart-bar-value\">$${item.revenue.toLocaleString()}</div>\r\n                    </div>\r\n                    <div class=\"chart-bar-label\">${item.month.split('-')[1]}/${item.month.split('-')[0].slice(2)}</div>\r\n                </div>\r\n            `;\r\n        }).join('');\r\n    }\r\n\r\n    function renderRecentActivity(activities) {\r\n        if (activities.length === 0) {\r\n            return '<p class=\"text-center\">No recent activity</p>';\r\n        }\r\n        \r\n        return activities.slice(0, 6).map(activity => `\r\n            <div class=\"activity-item\">\r\n                <div class=\"activity-icon\">\r\n                    <i class=\"fas fa-${getActivityIcon(activity.type)}\"></i>\r\n                </div>\r\n                <div class=\"activity-content\">\r\n                    <p>\r\n                        <strong>${activity.name}</strong> ${activity.action} \r\n                        ${activity.type === 'user' ? 'account' : activity.type}\r\n                    </p>\r\n                    <small>${formatTimeAgo(activity.timestamp)}</small>\r\n                </div>\r\n            </div>\r\n        `).join('');\r\n    }\r\n\r\n    function renderRecentUsers(users) {\r\n        if (users.length === 0) {\r\n            return '<p class=\"text-center\">No recent users</p>';\r\n        }\r\n        \r\n        return users.map(user => `\r\n            <div class=\"user-item\">\r\n                <div class=\"user-avatar\">\r\n                    <i class=\"fas fa-user-circle\"></i>\r\n                </div>\r\n                <div class=\"user-info\">\r\n                    <strong>${user.name}</strong>\r\n                    <small>${user.email}</small>\r\n                    <span class=\"badge badge-${user.role === 'admin' ? 'danger' : 'primary'}\">\r\n                        ${user.role}\r\n                    </span>\r\n                </div>\r\n                <div class=\"user-actions\">\r\n                    <button class=\"btn-action btn-sm\" onclick=\"viewUserDetails(${user._id})\">\r\n                        <i class=\"fas fa-eye\"></i>\r\n                    </button>\r\n                </div>\r\n            </div>\r\n        `).join('');\r\n    }\r\n\r\n    function renderAdminRecentBookings(bookings) {\r\n        if (bookings.length === 0) {\r\n            return '<p class=\"text-center\">No recent bookings</p>';\r\n        }\r\n        \r\n        return bookings.map(booking => `\r\n            <div class=\"booking-item\">\r\n                <div class=\"booking-icon\">\r\n                    <i class=\"fas fa-${getServiceIcon(booking.serviceType)}\"></i>\r\n                </div>\r\n                <div class=\"booking-info\">\r\n                    <strong>${booking.serviceName}</strong>\r\n                    <small>${booking._id}</small>\r\n                    <div>\r\n                        <span class=\"badge badge-${booking.status}\">${booking.status}</span>\r\n                        <span class=\"amount\">$${booking.totalAmount || '0'}</span>\r\n                    </div>\r\n                </div>\r\n                <div class=\"booking-actions\">\r\n                    <button class=\"btn-action btn-sm\" onclick=\"viewBookingDetails('${booking._id}')\">\r\n                        <i class=\"fas fa-eye\"></i>\r\n                    </button>\r\n                </div>\r\n            </div>\r\n        `).join('');\r\n    }\r\n\r\n    function renderUsersTable(users) {\r\n        return users.map(user => `\r\n            <tr>\r\n                <td>\r\n                    <div class=\"user-cell\">\r\n                        <div class=\"user-avatar-small\">\r\n                            <i class=\"fas fa-user-circle\"></i>\r\n                        </div>\r\n                        <div>\r\n                            <strong>${user.name}</strong>\r\n                            <small>ID: ${user._id}</small>\r\n                        </div>\r\n                    </div>\r\n                </td>\r\n                <td>${user.email}</td>\r\n                <td>\r\n                    <span class=\"badge badge-${user.role === 'admin' ? 'danger' : 'primary'}\">\r\n                        ${user.role}\r\n                    </span>\r\n                </td>\r\n                <td>\r\n                    <span class=\"badge badge-${user.status === 'active' ? 'success' : 'secondary'}\">\r\n                        ${user.status}\r\n                    </span>\r\n                </td>\r\n                <td>${new Date(user.createdAt).toLocaleDateString()}</td>\r\n                <td>\r\n                    <div class=\"table-actions\">\r\n                        <button class=\"btn-action btn-view\" onclick=\"viewUserDetails(${user._id})\">\r\n                            <i class=\"fas fa-eye\"></i>\r\n                        </button>\r\n                        <button class=\"btn-action btn-edit\" onclick=\"editUser(${user._id})\">\r\n                            <i class=\"fas fa-edit\"></i>\r\n                        </button>\r\n                        <button class=\"btn-action btn-delete\" onclick=\"deleteUserConfirm(${user._id})\">\r\n                            <i class=\"fas fa-trash\"></i>\r\n                        </button>\r\n                    </div>\r\n                </td>\r\n            </tr>\r\n        `).join('');\r\n    }\r\n\r\n    function renderAdminBookingsTable(bookings) {\r\n        return bookings.map(booking => `\r\n            <tr>\r\n                <td>\r\n                    <strong>${booking._id}</strong>\r\n                </td>\r\n                <td>\r\n                    <div class=\"user-cell\">\r\n                        <div class=\"user-avatar-small\">\r\n                            <i class=\"fas fa-user-circle\"></i>\r\n                        </div>\r\n                        <div>\r\n                            <strong>${booking.userName}</strong>\r\n                            <small>${booking.userEmail}</small>\r\n                        </div>\r\n                    </div>\r\n                </td>\r\n                <td>\r\n                    <div class=\"service-cell\">\r\n                        <div class=\"service-icon-small service-${booking.serviceType}\">\r\n                            <i class=\"fas fa-${getServiceIcon(booking.serviceType)}\"></i>\r\n                        </div>\r\n                        <div>\r\n                            <strong>${booking.serviceName}</strong>\r\n                            <small>${booking.serviceType}</small>\r\n                        </div>\r\n                    </div>\r\n                </td>\r\n                <td>\r\n                    <strong>$${booking.totalAmount || '0'}</strong>\r\n                </td>\r\n                <td>\r\n                    <span class=\"badge badge-${booking.status}\">\r\n                        ${booking.status.toUpperCase()}\r\n                    </span>\r\n                </td>\r\n                <td>${new Date(booking.createdAt).toLocaleDateString()}</td>\r\n                <td>\r\n                    <div class=\"table-actions\">\r\n                        <button class=\"btn-action btn-view\" onclick=\"viewBookingDetails('${booking._id}')\">\r\n                            <i class=\"fas fa-eye\"></i>\r\n                        </button>\r\n                        ${booking.status === 'pending' ? `\r\n                            <button class=\"btn-action btn-confirm\" onclick=\"confirmBooking('${booking._id}')\">\r\n                                <i class=\"fas fa-check\"></i>\r\n                            </button>\r\n                            <button class=\"btn-action btn-cancel\" onclick=\"cancelBookingAdmin('${booking._id}')\">\r\n                                <i class=\"fas fa-times\"></i>\r\n                            </button>\r\n                        ` : ''}\r\n                        <button class=\"btn-action btn-download\" onclick=\"downloadBookingInvoice('${booking._id}')\">\r\n                            <i class=\"fas fa-download\"></i>\r\n                        </button>\r\n                    </div>\r\n                </td>\r\n            </tr>\r\n        `).join('');\r\n    }\r\n\r\n    function renderAdminTripsTable(tripPlans) {\r\n        return tripPlans.map(trip => `\r\n            <tr>\r\n                <td>\r\n                    <strong>${trip._id}</strong>\r\n                </td>\r\n                <td>\r\n                    <div class=\"user-cell\">\r\n                        <div class=\"user-avatar-small\">\r\n                            <i class=\"fas fa-user-circle\"></i>\r\n                        </div>\r\n                        <div>\r\n                            <strong>${trip.userName}</strong>\r\n                            <small>${trip.userEmail}</small>\r\n                        </div>\r\n                    </div>\r\n                </td>\r\n                <td>${trip.duration}</td>\r\n                <td>${trip.budget}</td>\r\n                <td>\r\n                    <span class=\"badge badge-${trip.status}\">\r\n                        ${trip.status.toUpperCase()}\r\n                    </span>\r\n                </td>\r\n                <td>${new Date(trip.createdAt).toLocaleDateString()}</td>\r\n                <td>\r\n                    <div class=\"table-actions\">\r\n                        <button class=\"btn-action btn-view\" onclick=\"viewTripPlanAdmin('${trip._id}')\">\r\n                            <i class=\"fas fa-eye\"></i>\r\n                        </button>\r\n                        <button class=\"btn-action btn-edit\" onclick=\"editTripPlanAdmin('${trip._id}')\">\r\n                            <i class=\"fas fa-edit\"></i>\r\n                        </button>\r\n                        ${trip.status === 'review' ? `\r\n                            <button class=\"btn-action btn-process\" onclick=\"processTripPlan('${trip._id}')\">\r\n                                <i class=\"fas fa-cogs\"></i>\r\n                            </button>\r\n                        ` : ''}\r\n                    </div>\r\n                </td>\r\n            </tr>\r\n        `).join('');\r\n    }\r\n\r\n    function getActivityIcon(activityType) {\r\n        const icons = {\r\n            'user': 'user-plus',\r\n            'booking': 'calendar-check',\r\n            'trip_plan': 'route'\r\n        };\r\n        return icons[activityType] || 'bell';\r\n    }\r\n\r\n    function formatTimeAgo(timestamp) {\r\n        const now = new Date();\r\n        const past = new Date(timestamp);\r\n        const diff = now - past;\r\n        \r\n        const minutes = Math.floor(diff / 60000);\r\n        const hours = Math.floor(diff / 3600000);\r\n        const days = Math.floor(diff / 86400000);\r\n        \r\n        if (minutes < 60) return `${minutes} minutes ago`;\r\n        if (hours < 24) return `${hours} hours ago`;\r\n        return `${days} days ago`;\r\n    }\r\n\r\n    function setupAdminDashboardListeners() {\r\n        // Admin tab switching\r\n        document.querySelectorAll('.admin-tab-link').forEach(link => {\r\n            link.addEventListener('click', function() {\r\n                // Remove active class from all tabs\r\n                document.querySelectorAll('.admin-tab-link').forEach(l => l.classList.remove('active'));\r\n                document.querySelectorAll('.admin-tab-pane').forEach(p => p.classList.remove('active'));\r\n                \r\n                // Add active class to clicked tab\r\n                this.classList.add('active');\r\n                const tabId = this.dataset.tab;\r\n                document.getElementById(tabId).classList.add('active');\r\n            });\r\n        });\r\n        \r\n        // Service tabs\r\n        document.querySelectorAll('.service-tab').forEach(tab => {\r\n            tab.addEventListener('click', function() {\r\n                document.querySelectorAll('.service-tab').forEach(t => t.classList.remove('active'));\r\n                document.querySelectorAll('.service-tab-content').forEach(c => c.classList.remove('active'));\r\n                \r\n                this.classList.add('active');\r\n                const service = this.dataset.service;\r\n                document.getElementById(`${service}-management`).classList.add('active');\r\n            });\r\n        });\r\n        \r\n        // Add user button\r\n        document.getElementById('add-user-btn')?.addEventListener('click', () => {\r\n            showAddUserModal();\r\n        });\r\n        \r\n        // Generate report button\r\n        document.getElementById('generate-report-btn')?.addEventListener('click', () => {\r\n            generateReport('full');\r\n        });\r\n        \r\n        // Search functionality\r\n        const searchInput = document.getElementById('admin-search-input');\r\n        if (searchInput) {\r\n            searchInput.addEventListener('input', function() {\r\n                searchAdminContent(this.value);\r\n            });\r\n        }\r\n        \r\n        // Filter functionality\r\n        document.getElementById('booking-type-filter')?.addEventListener('change', function() {\r\n            filterAdminBookings(this.value);\r\n        });\r\n        \r\n        document.getElementById('trip-status-filter')?.addEventListener('change', function() {\r\n            filterAdminTrips(this.value);\r\n        });\r\n    }\r\n\r\n    // ===============================\r\n    // DATA LOADING FUNCTIONS\r\n    // ===============================\r\n    \r\n    async function loadHomePage() {\r\n        console.log('Loading home page...');\r\n        // Load featured destinations\r\n        const destinationsGrid = document.querySelector('.destinations-grid');\r\n        if (destinationsGrid) {\r\n            const result = await apiRequest(config.endpoints.destinations);\r\n            const featuredDestinations = result.data?.slice(0, 3) || mockData.destinations.slice(0, 3);\r\n            \r\n            destinationsGrid.innerHTML = featuredDestinations.map(dest => `\r\n                <div class=\"destination-card\">\r\n                    <div class=\"destination-image\">\r\n                        <img src=\"${dest.image}\" alt=\"${dest.name}\" loading=\"lazy\">\r\n                        <div class=\"destination-rating\">\r\n                            <i class=\"fas fa-star\"></i> ${dest.rating}\r\n                        </div>\r\n                    </div>\r\n                    <div class=\"destination-content\">\r\n                        <h3>${dest.name}</h3>\r\n                        <div class=\"destination-location\">\r\n                            <i class=\"fas fa-map-marker-alt\"></i> ${dest.location}\r\n                        </div>\r\n                        <p>${dest.description.substring(0, 100)}...</p>\r\n                        <button class=\"btn btn-primary book-now\" \r\n                                data-type=\"destination\" \r\n                                data-id=\"${dest._id}\"\r\n                                data-name=\"${dest.name}\">\r\n                            Book Now\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n            `).join('');\r\n        }\r\n        \r\n        // Load featured blog posts\r\n        const blogGrid = document.querySelector('.blog-grid');\r\n        if (blogGrid) {\r\n            const result = await apiRequest(config.endpoints.blog);\r\n            const featuredBlogs = result.data?.slice(0, 3) || mockData.blog.slice(0, 3);\r\n            \r\n            blogGrid.innerHTML = featuredBlogs.map(blog => `\r\n                <div class=\"blog-card\">\r\n                    <div class=\"blog-image\">\r\n                        <img src=\"${blog.image}\" alt=\"${blog.title}\" loading=\"lazy\">\r\n                        <span class=\"blog-category\">${blog.category}</span>\r\n                    </div>\r\n                    <div class=\"blog-content\">\r\n                        <div class=\"blog-meta\">\r\n                            <span class=\"blog-date\">\r\n                                <i class=\"far fa-calendar\"></i> ${blog.date}\r\n                            </span>\r\n                            <span class=\"blog-read-time\">${blog.readTime}</span>\r\n                        </div>\r\n                        <h3>${blog.title}</h3>\r\n                        <p>${blog.excerpt.substring(0, 120)}...</p>\r\n                        <a href=\"#\" class=\"read-more-link\" data-page=\"blog\">Read More <i class=\"fas fa-arrow-right\"></i></a>\r\n                    </div>\r\n                </div>\r\n            `).join('');\r\n        }\r\n        \r\n        // Update plan trip button\r\n        const planTripBtn = document.querySelector('.plan-trip-btn');\r\n        if (planTripBtn) {\r\n            planTripBtn.addEventListener('click', (e) => {\r\n                e.preventDefault();\r\n                showTripPlanModal();\r\n            });\r\n        }\r\n    }\r\n\r\n    async function loadDestinations() {\r\n        console.log('Loading destinations...');\r\n        const grid = document.querySelector('.destinations-grid-full');\r\n        if (!grid) return;\r\n        \r\n        const result = await apiRequest(config.endpoints.destinations);\r\n        const destinations = result.data || mockData.destinations;\r\n        \r\n        grid.innerHTML = destinations.map(dest => `\r\n            <div class=\"destination-card\">\r\n                <div class=\"destination-image\">\r\n                    <img src=\"${dest.image}\" alt=\"${dest.name}\" loading=\"lazy\">\r\n                    <div class=\"destination-rating\">\r\n                        <i class=\"fas fa-star\"></i> ${dest.rating}\r\n                    </div>\r\n                </div>\r\n                <div class=\"destination-content\">\r\n                    <h3>${dest.name}</h3>\r\n                    <div class=\"destination-location\">\r\n                        <i class=\"fas fa-map-marker-alt\"></i> ${dest.location}\r\n                    </div>\r\n                    <p>${dest.description}</p>\r\n                    <div class=\"features\">\r\n                        ${dest.features.map(f => `<span class=\"feature-tag\">${f}</span>`).join('')}\r\n                    </div>\r\n                    <div class=\"price-tag\">${dest.price}</div>\r\n                    <button class=\"btn btn-primary book-now\" \r\n                            data-type=\"destination\" \r\n                            data-id=\"${dest._id}\"\r\n                            data-name=\"${dest.name}\">\r\n                        Book Tour\r\n                    </button>\r\n                </div>\r\n            </div>\r\n        `).join('');\r\n    }\r\n\r\n    async function loadGuides() {\r\n        console.log('Loading guides...');\r\n        const grid = document.querySelector('.guides-grid-full');\r\n        if (!grid) return;\r\n        \r\n        const result = await apiRequest(config.endpoints.guides);\r\n        const guides = result.data || mockData.guides;\r\n        \r\n        grid.innerHTML = guides.map(guide => `\r\n            <div class=\"guide-card\">\r\n                <div class=\"guide-avatar\">\r\n                    <img src=\"${guide.image}\" alt=\"${guide.name}\" loading=\"lazy\">\r\n                </div>\r\n                \r\n                <div class=\"guide-info\">\r\n                    <h3>${guide.name}</h3>\r\n                    \r\n                    <p class=\"specialty\">${guide.specialty}</p>\r\n                    \r\n                    <div class=\"languages-section\">\r\n                        <div class=\"languages-header\">\r\n                            <i class=\"fas fa-language\"></i>\r\n                            <strong>Languages:</strong>\r\n                        </div>\r\n                        <div class=\"languages-list\">\r\n                            ${guide.languages.map(lang => `\r\n                                <span class=\"language-tag\">\r\n                                    ${lang}\r\n                                </span>\r\n                            `).join('')}\r\n                        </div>\r\n                    </div>\r\n                    \r\n                    <p class=\"experience\">\r\n                        <i class=\"fas fa-briefcase\"></i> ${guide.experience}\r\n                    </p>\r\n                    \r\n                    <div class=\"rating\">\r\n                        ${'â˜…'.repeat(Math.floor(guide.rating))}${guide.rating % 1 ? 'Â½' : ''}\r\n                        <span>${guide.rating}</span>\r\n                    </div>\r\n                    \r\n                    <div class=\"price\">${guide.price}</div>\r\n                    \r\n                    <button class=\"btn btn-primary book-now\" \r\n                            data-type=\"guide\" \r\n                            data-id=\"${guide._id}\"\r\n                            data-name=\"${guide.name}\">\r\n                        Hire Now\r\n                    </button>\r\n                </div>\r\n            </div>\r\n        `).join('');\r\n    }\r\n\r\n    async function loadTranslators() {\r\n        console.log('Loading translators...');\r\n        const grid = document.querySelector('.translators-grid-full');\r\n        if (!grid) return;\r\n        \r\n        const result = await apiRequest(config.endpoints.translators);\r\n        const translators = result.data || mockData.translators;\r\n        \r\n        grid.innerHTML = translators.map(translator => `\r\n            <div class=\"translator-card\">\r\n                <div class=\"guide-avatar\">\r\n                    <img src=\"${translator.image}\" alt=\"${translator.name}\" loading=\"lazy\">\r\n                </div>\r\n                \r\n                <div class=\"guide-info\">\r\n                    <h3>${translator.name}</h3>\r\n                    \r\n                    <p class=\"specialty\">${translator.specialty}</p>\r\n                    \r\n                    <div class=\"languages-section\">\r\n                        <div class=\"languages-header\">\r\n                            <i class=\"fas fa-language\"></i>\r\n                            <strong>Languages:</strong>\r\n                        </div>\r\n                        <div class=\"languages-list\">\r\n                            ${translator.languages.map(lang => `\r\n                                <span class=\"language-tag\">\r\n                                    ${lang}\r\n                                </span>\r\n                            `).join('')}\r\n                        </div>\r\n                    </div>\r\n                    \r\n                    <p class=\"experience\">\r\n                        <i class=\"fas fa-briefcase\"></i> ${translator.experience}\r\n                    </p>\r\n                    \r\n                    <div class=\"rating\">\r\n                        ${'â˜…'.repeat(Math.floor(translator.rating))}${translator.rating % 1 ? 'Â½' : ''}\r\n                        <span>${translator.rating}</span>\r\n                    </div>\r\n                    \r\n                    <div class=\"price\">${translator.price}</div>\r\n                    \r\n                    <button class=\"btn btn-primary book-now\" \r\n                            data-type=\"translator\" \r\n                            data-id=\"${translator._id}\"\r\n                            data-name=\"${translator.name}\">\r\n                        Hire Now\r\n                    </button>\r\n                </div>\r\n            </div>\r\n        `).join('');\r\n    }\r\n\r\n    async function loadAccommodations() {\r\n        console.log('Loading accommodations...');\r\n        const grid = document.querySelector('.accommodations-grid-full');\r\n        if (!grid) return;\r\n        \r\n        const result = await apiRequest(config.endpoints.accommodations);\r\n        const accommodations = result.data || mockData.accommodations;\r\n        \r\n        grid.innerHTML = accommodations.map(acc => `\r\n            <div class=\"accommodation-card\">\r\n                <div class=\"accommodation-image\">\r\n                    <img src=\"${acc.image}\" alt=\"${acc.name}\" loading=\"lazy\">\r\n                </div>\r\n                <div class=\"accommodation-content\">\r\n                    <span class=\"type\">${acc.type}</span>\r\n                    <h3>${acc.name}</h3>\r\n                    <div class=\"location\">\r\n                        <i class=\"fas fa-map-marker-alt\"></i> ${acc.location}\r\n                    </div>\r\n                    <p>${acc.description.substring(0, 120)}...</p>\r\n                    <div class=\"features\">\r\n                        ${acc.features.slice(0, 3).map(f => `<span class=\"feature-tag\">${f}</span>`).join('')}\r\n                    </div>\r\n                    <div class=\"price-tag\">${acc.price}</div>\r\n                    <button class=\"btn btn-primary book-now\" \r\n                            data-type=\"accommodation\" \r\n                            data-id=\"${acc._id}\"\r\n                            data-name=\"${acc.name}\">\r\n                        Book Now\r\n                    </button>\r\n                </div>\r\n            </div>\r\n        `).join('');\r\n    }\r\n\r\n    async function loadBlog() {\r\n        console.log('Loading blog...');\r\n        const grid = document.querySelector('.blog-grid-full');\r\n        if (!grid) return;\r\n        \r\n        const result = await apiRequest(config.endpoints.blog);\r\n        const blogs = result.data || mockData.blog;\r\n        \r\n        grid.innerHTML = blogs.map(blog => `\r\n            <div class=\"blog-card\">\r\n                <div class=\"blog-image\">\r\n                    <img src=\"${blog.image}\" alt=\"${blog.title}\" loading=\"lazy\">\r\n                    <span class=\"blog-category\">${blog.category}</span>\r\n                </div>\r\n                <div class=\"blog-content\">\r\n                    <div class=\"blog-meta\">\r\n                        <span class=\"blog-date\">\r\n                            <i class=\"fas fa-calendar\"></i> ${blog.date}\r\n                        </span>\r\n                        <span class=\"blog-read-time\">${blog.readTime}</span>\r\n                    </div>\r\n                    <h3>${blog.title}</h3>\r\n                    <p>${blog.excerpt}</p>\r\n                    <p class=\"author\"><i class=\"fas fa-user\"></i> ${blog.author}</p>\r\n                    <a href=\"#\" class=\"read-more-link\">Read Full Article</a>\r\n                </div>\r\n            </div>\r\n        `).join('');\r\n    }\r\n\r\n    // ===============================\r\n    // UI COMPONENTS\r\n    // ===============================\r\n    \r\n    function showNotification(message, type = 'info', duration = 5000) {\r\n        // Remove existing notifications\r\n        const existing = document.querySelectorAll('.notification-toast');\r\n        existing.forEach(n => n.remove());\r\n        \r\n        const notification = document.createElement('div');\r\n        notification.className = `notification-toast ${type}`;\r\n        notification.innerHTML = `\r\n            <div class=\"notification-content\">\r\n                <span class=\"notification-message\">${message}</span>\r\n                <button class=\"notification-close\">&times;</button>\r\n            </div>\r\n        `;\r\n        \r\n        document.body.appendChild(notification);\r\n        \r\n        // Show with animation\r\n        setTimeout(() => notification.classList.add('show'), 10);\r\n        \r\n        // Auto remove\r\n        const removeTimer = setTimeout(() => {\r\n            notification.classList.remove('show');\r\n            setTimeout(() => notification.remove(), 300);\r\n        }, duration);\r\n        \r\n        // Close button\r\n        notification.querySelector('.notification-close').addEventListener('click', () => {\r\n            clearTimeout(removeTimer);\r\n            notification.classList.remove('show');\r\n            setTimeout(() => notification.remove(), 300);\r\n        });\r\n    }\r\n\r\n    function updateAuthUI(isLoggedIn = false, user = null) {\r\n        console.log('Updating auth UI:', isLoggedIn ? 'Logged in' : 'Logged out');\r\n        const authToggle = document.getElementById('auth-toggle');\r\n        const authDropdown = document.getElementById('auth-dropdown-menu');\r\n        \r\n        if (!authToggle || !authDropdown) return;\r\n        \r\n        if (isLoggedIn && user) {\r\n            authToggle.innerHTML = `\r\n                <i class=\"fas fa-user\"></i>\r\n                <span>${user.name.split(' ')[0]}</span>\r\n                <i class=\"fas fa-chevron-down\"></i>\r\n            `;\r\n            \r\n            authDropdown.innerHTML = `\r\n                <div class=\"user-info\">\r\n                    <div class=\"user-avatar\">\r\n                        <i class=\"fas fa-user-circle\"></i>\r\n                    </div>\r\n                    <div class=\"user-details\">\r\n                        <strong>${user.name}</strong>\r\n                        <small>${user.email}</small>\r\n                    </div>\r\n                </div>\r\n                \r\n                <a href=\"#\" class=\"auth-option\" data-page=\"dashboard\">\r\n                    <i class=\"fas fa-tachometer-alt\"></i> Dashboard\r\n                </a>\r\n                \r\n                ${user.role === 'admin' ? `\r\n                    <a href=\"#\" class=\"auth-option\" data-page=\"admin\">\r\n                        <i class=\"fas fa-crown\"></i> Admin Panel\r\n                    </a>\r\n                ` : ''}\r\n                \r\n                <a href=\"#\" class=\"auth-option\" id=\"logout-btn\">\r\n                    <i class=\"fas fa-sign-out-alt\"></i> Logout\r\n                </a>\r\n                \r\n                <div class=\"auth-divider\"></div>\r\n                \r\n                <div class=\"auth-option demo-mode-info\">\r\n                    <i class=\"fas fa-info-circle\"></i> ${useMockData ? 'Demo Mode' : 'Connected'}\r\n                </div>\r\n            `;\r\n            \r\n            document.getElementById('logout-btn').addEventListener('click', (e) => {\r\n                e.preventDefault();\r\n                e.stopPropagation();\r\n                logout();\r\n            });\r\n        } else {\r\n            authToggle.innerHTML = `\r\n                <i class=\"fas fa-user\"></i>\r\n                <span>Account</span>\r\n                <i class=\"fas fa-chevron-down\"></i>\r\n            `;\r\n            \r\n            authDropdown.innerHTML = `\r\n                <a href=\"#\" class=\"auth-option sign-in-btn\">\r\n                    <i class=\"fas fa-sign-in-alt\"></i> Sign In\r\n                </a>\r\n                \r\n                <a href=\"#\" class=\"auth-option signup-btn\">\r\n                    <i class=\"fas fa-user-plus\"></i> Sign Up\r\n                </a>\r\n                \r\n                <div class=\"auth-divider\"></div>\r\n                \r\n                <a href=\"#\" class=\"auth-option demo-login-btn\">\r\n                    <i class=\"fas fa-rocket\"></i> Quick Demo\r\n                </a>\r\n                \r\n                <div class=\"auth-option demo-mode-info\">\r\n                    <i class=\"fas fa-info-circle\"></i> ${useMockData ? 'Demo Mode' : 'Connected'}\r\n                </div>\r\n            `;\r\n            \r\n            // Add event listeners for new buttons\r\n            const signInBtn = authDropdown.querySelector('.sign-in-btn');\r\n            const signUpBtn = authDropdown.querySelector('.signup-btn');\r\n            const demoLoginBtn = authDropdown.querySelector('.demo-login-btn');\r\n            \r\n            if (signInBtn) {\r\n                signInBtn.addEventListener('click', (e) => {\r\n                    e.preventDefault();\r\n                    e.stopPropagation();\r\n                    showAuthModal('login');\r\n                });\r\n            }\r\n            \r\n            if (signUpBtn) {\r\n                signUpBtn.addEventListener('click', (e) => {\r\n                    e.preventDefault();\r\n                    e.stopPropagation();\r\n                    showAuthModal('register');\r\n                });\r\n            }\r\n            \r\n            if (demoLoginBtn) {\r\n                demoLoginBtn.addEventListener('click', (e) => {\r\n                    e.preventDefault();\r\n                    e.stopPropagation();\r\n                    quickDemoLogin();\r\n                });\r\n            }\r\n        }\r\n    }\r\n\r\n    function quickDemoLogin() {\r\n        const demoUser = {\r\n            _id: Date.now(),\r\n            name: 'Demo User',\r\n            email: 'demo@example.com',\r\n            role: 'user',\r\n            phone: '+250 788 123 456',\r\n            country: 'Rwanda',\r\n            token: 'demo-jwt-token-' + Date.now()\r\n        };\r\n        \r\n        isAuthenticated = true;\r\n        currentUser = demoUser;\r\n        saveUserData(demoUser);\r\n        updateAuthUI(true, demoUser);\r\n        \r\n        showNotification('âœ… Demo login successful! Welcome!', 'success');\r\n        \r\n        setTimeout(() => {\r\n            showPage('dashboard');\r\n        }, 1000);\r\n    }\r\n\r\n    // ===============================\r\n    // MODAL SYSTEM\r\n    // ===============================\r\n    \r\n    function showAuthModal(type = 'login') {\r\n        console.log('Showing auth modal:', type);\r\n        const modal = createModal();\r\n        const isLogin = type === 'login';\r\n        \r\n        modal.innerHTML = `\r\n            <div class=\"modal-header\">\r\n                <h2>${isLogin ? 'Sign In' : 'Create Account'}</h2>\r\n                <button class=\"modal-close\">&times;</button>\r\n            </div>\r\n            \r\n            <div class=\"modal-body\">\r\n                <form id=\"auth-form\">\r\n                    ${!isLogin ? `\r\n                        <div class=\"form-group\">\r\n                            <label>Full Name *</label>\r\n                            <input type=\"text\" name=\"name\" required>\r\n                        </div>\r\n                    ` : ''}\r\n                    \r\n                    <div class=\"form-group\">\r\n                        <label>Email *</label>\r\n                        <input type=\"email\" name=\"email\" required>\r\n                    </div>\r\n                    \r\n                    <div class=\"form-group\">\r\n                        <label>Password *</label>\r\n                        <input type=\"password\" name=\"password\" required>\r\n                        ${!isLogin ? '<small>Minimum 6 characters</small>' : ''}\r\n                    </div>\r\n                    \r\n                    ${!isLogin ? `\r\n                        <div class=\"form-group\">\r\n                            <label>Phone</label>\r\n                            <input type=\"tel\" name=\"phone\">\r\n                        </div>\r\n                        \r\n                        <div class=\"form-group\">\r\n                            <label>Country</label>\r\n                            <input type=\"text\" name=\"country\">\r\n                        </div>\r\n                        \r\n                        <div class=\"form-group\">\r\n                            <label class=\"checkbox\">\r\n                                <input type=\"checkbox\" name=\"newsletter\" checked>\r\n                                Subscribe to newsletter\r\n                            </label>\r\n                        </div>\r\n                    ` : ''}\r\n                    \r\n                    <button type=\"submit\" class=\"btn btn-primary btn-block\">\r\n                        ${isLogin ? 'Sign In' : 'Create Account'}\r\n                    </button>\r\n                    \r\n                    <div class=\"auth-switch\">\r\n                        ${isLogin ? 'Don\\'t have an account?' : 'Already have an account?'}\r\n                        <a href=\"#\" class=\"switch-link\">${isLogin ? 'Sign Up' : 'Sign In'}</a>\r\n                    </div>\r\n                </form>\r\n            </div>\r\n        `;\r\n        \r\n        const form = modal.querySelector('#auth-form');\r\n        form.addEventListener('submit', async (e) => {\r\n            e.preventDefault();\r\n            const formData = new FormData(form);\r\n            const data = Object.fromEntries(formData.entries());\r\n            \r\n            if (isLogin) {\r\n                await login(data.email, data.password);\r\n                if (isAuthenticated) closeModal();\r\n            } else {\r\n                await register(data);\r\n                if (isAuthenticated) closeModal();\r\n            }\r\n        });\r\n        \r\n        // Switch between login/register\r\n        modal.querySelector('.switch-link').addEventListener('click', (e) => {\r\n            e.preventDefault();\r\n            closeModal();\r\n            showAuthModal(isLogin ? 'register' : 'login');\r\n        });\r\n    }\r\n\r\n    function showServiceSelectionModal() {\r\n        const modal = createModal();\r\n        \r\n        modal.innerHTML = `\r\n            <div class=\"modal-header\">\r\n                <h2><i class=\"fas fa-plus-circle\"></i> Book a Service</h2>\r\n                <button class=\"modal-close\">&times;</button>\r\n            </div>\r\n            \r\n            <div class=\"modal-body\">\r\n                <div class=\"service-selection\">\r\n                    <h3>Select Service Type</h3>\r\n                    <p>Choose what you'd like to book for your Rwanda adventure</p>\r\n                    \r\n                    <div class=\"service-options\">\r\n                        <div class=\"service-option\" data-type=\"destination\">\r\n                            <div class=\"service-option-icon\">\r\n                                <i class=\"fas fa-map-marked-alt\"></i>\r\n                            </div>\r\n                            <div class=\"service-option-content\">\r\n                                <h4>Destination</h4>\r\n                                <p>Book tours and experiences at Rwanda's top destinations</p>\r\n                            </div>\r\n                            <i class=\"fas fa-chevron-right\"></i>\r\n                        </div>\r\n                        \r\n                        <div class=\"service-option\" data-type=\"guide\">\r\n                            <div class=\"service-option-icon\">\r\n                                <i class=\"fas fa-user-tie\"></i>\r\n                            </div>\r\n                            <div class=\"service-option-content\">\r\n                                <h4>Tour Guide</h4>\r\n                                <p>Hire an expert local guide for your journey</p>\r\n                            </div>\r\n                            <i class=\"fas fa-chevron-right\"></i>\r\n                        </div>\r\n                        \r\n                        <div class=\"service-option\" data-type=\"translator\">\r\n                            <div class=\"service-option-icon\">\r\n                                <i class=\"fas fa-language\"></i>\r\n                            </div>\r\n                            <div class=\"service-option-content\">\r\n                                <h4>Translator</h4>\r\n                                <p>Get language assistance from professional translators</p>\r\n                            </div>\r\n                            <i class=\"fas fa-chevron-right\"></i>\r\n                        </div>\r\n                        \r\n                        <div class=\"service-option\" data-type=\"accommodation\">\r\n                            <div class=\"service-option-icon\">\r\n                                <i class=\"fas fa-hotel\"></i>\r\n                            </div>\r\n                            <div class=\"service-option-content\">\r\n                                <h4>Accommodation</h4>\r\n                                <p>Book hotels, lodges, and guesthouses</p>\r\n                            </div>\r\n                            <i class=\"fas fa-chevron-right\"></i>\r\n                        </div>\r\n                        \r\n                        <div class=\"service-option\" data-type=\"package\">\r\n                            <div class=\"service-option-icon\">\r\n                                <i class=\"fas fa-suitcase-rolling\"></i>\r\n                            </div>\r\n                            <div class=\"service-option-content\">\r\n                                <h4>Complete Package</h4>\r\n                                <p>Get a customized all-inclusive travel package</p>\r\n                            </div>\r\n                            <i class=\"fas fa-chevron-right\"></i>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        `;\r\n        \r\n        // Add click handlers for service options\r\n        modal.querySelectorAll('.service-option').forEach(option => {\r\n            option.addEventListener('click', () => {\r\n                const serviceType = option.dataset.type;\r\n                closeModal();\r\n                \r\n                if (serviceType === 'package') {\r\n                    showTripPlanModal();\r\n                } else {\r\n                    showEnhancedBookingModal(serviceType);\r\n                }\r\n            });\r\n        });\r\n    }\r\n\r\n    function showEnhancedBookingModal(serviceType, serviceId = null, serviceName = null) {\r\n        const modal = createModal();\r\n        \r\n        // Get service details if ID is provided\r\n        let serviceDetails = null;\r\n        if (serviceId) {\r\n            // Find the service in mock data\r\n            let allServices = [];\r\n            if (serviceType === 'guide') allServices = mockData.guides;\r\n            else if (serviceType === 'translator') allServices = mockData.translators;\r\n            else if (serviceType === 'accommodation') allServices = mockData.accommodations;\r\n            else if (serviceType === 'destination') allServices = mockData.destinations;\r\n            \r\n            serviceDetails = allServices.find(s => s._id == serviceId);\r\n        }\r\n        \r\n        modal.innerHTML = `\r\n            <div class=\"modal-header\">\r\n                <h2><i class=\"fas fa-calendar-plus\"></i> Book ${serviceType.charAt(0).toUpperCase() + serviceType.slice(1)}</h2>\r\n                <button class=\"modal-close\">&times;</button>\r\n            </div>\r\n            \r\n            <div class=\"modal-body\">\r\n                <form id=\"enhanced-booking-form\">\r\n                    <input type=\"hidden\" name=\"service_type\" value=\"${serviceType}\">\r\n                    <input type=\"hidden\" name=\"service_id\" value=\"${serviceId || ''}\">\r\n                    <input type=\"hidden\" name=\"service_name\" value=\"${serviceDetails?.name || serviceName || ''}\">\r\n                    \r\n                    ${serviceDetails ? `\r\n                        <div class=\"booking-service-preview\">\r\n                            <h4>${serviceDetails.name}</h4>\r\n                            <p><strong>Price:</strong> ${serviceDetails.price}</p>\r\n                            ${serviceDetails.description ? `<p>${serviceDetails.description.substring(0, 100)}...</p>` : ''}\r\n                        </div>\r\n                    ` : ''}\r\n                    \r\n                    <div class=\"form-section\">\r\n                        <h4><i class=\"fas fa-user\"></i> Personal Information</h4>\r\n                        <div class=\"form-row\">\r\n                            <div class=\"form-group\">\r\n                                <label>Full Name *</label>\r\n                                <input type=\"text\" name=\"name\" value=\"${currentUser?.name || ''}\" required>\r\n                            </div>\r\n                            <div class=\"form-group\">\r\n                                <label>Email *</label>\r\n                                <input type=\"email\" name=\"email\" value=\"${currentUser?.email || ''}\" required>\r\n                            </div>\r\n                        </div>\r\n                        <div class=\"form-row\">\r\n                            <div class=\"form-group\">\r\n                                <label>Phone *</label>\r\n                                <input type=\"tel\" name=\"phone\" value=\"${currentUser?.phone || ''}\" required>\r\n                            </div>\r\n                            <div class=\"form-group\">\r\n                                <label>Nationality</label>\r\n                                <input type=\"text\" name=\"nationality\" value=\"${currentUser?.country || ''}\">\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    \r\n                    <div class=\"form-section\">\r\n                        <h4><i class=\"fas fa-calendar-alt\"></i> Booking Details</h4>\r\n                        <div class=\"form-row\">\r\n                            <div class=\"form-group\">\r\n                                <label>Start Date *</label>\r\n                                <input type=\"date\" name=\"date\" required min=\"${new Date().toISOString().split('T')[0]}\">\r\n                            </div>\r\n                            <div class=\"form-group\">\r\n                                <label>Duration (days) *</label>\r\n                                <select name=\"duration\" required>\r\n                                    <option value=\"1\">1 day</option>\r\n                                    <option value=\"2\">2 days</option>\r\n                                    <option value=\"3\">3 days</option>\r\n                                    <option value=\"4\">4 days</option>\r\n                                    <option value=\"5\">5 days</option>\r\n                                    <option value=\"6\">6 days</option>\r\n                                    <option value=\"7\">7 days</option>\r\n                                    <option value=\"8\">8+ days</option>\r\n                                </select>\r\n                            </div>\r\n                        </div>\r\n                        <div class=\"form-row\">\r\n                            <div class=\"form-group\">\r\n                                <label>Number of Travelers *</label>\r\n                                <div class=\"travelers-input\">\r\n                                    <button type=\"button\" class=\"btn-counter\" data-action=\"decrease\">-</button>\r\n                                    <input type=\"number\" name=\"travelers\" value=\"1\" min=\"1\" max=\"20\" readonly>\r\n                                    <button type=\"button\" class=\"btn-counter\" data-action=\"increase\">+</button>\r\n                                </div>\r\n                            </div>\r\n                            <div class=\"form-group\">\r\n                                <label>Total Amount ($)</label>\r\n                                <input type=\"number\" name=\"total_amount\" placeholder=\"Estimated total\" min=\"0\" \r\n                                       value=\"${serviceDetails?.dailyRate ? serviceDetails.dailyRate : serviceDetails?.basePrice ? serviceDetails.basePrice : ''}\">\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    \r\n                    <div class=\"form-section\">\r\n                        <h4><i class=\"fas fa-comment-dots\"></i> Additional Information</h4>\r\n                        <div class=\"form-group\">\r\n                            <label>Special Requirements</label>\r\n                            <textarea name=\"notes\" rows=\"3\" placeholder=\"Any dietary restrictions, accessibility needs, or special requests...\"></textarea>\r\n                        </div>\r\n                    </div>\r\n                    \r\n                    <div class=\"form-section\">\r\n                        <h4><i class=\"fas fa-file-invoice-dollar\"></i> Payment Method</h4>\r\n                        <div class=\"payment-options\">\r\n                            <label class=\"payment-option\">\r\n                                <input type=\"radio\" name=\"payment_method\" value=\"pay_now\" checked>\r\n                                <div class=\"payment-content\">\r\n                                    <i class=\"fas fa-credit-card\"></i>\r\n                                    <div>\r\n                                        <strong>Pay Now</strong>\r\n                                        <small>Secure online payment</small>\r\n                                    </div>\r\n                                </div>\r\n                            </label>\r\n                            <label class=\"payment-option\">\r\n                                <input type=\"radio\" name=\"payment_method\" value=\"pay_later\">\r\n                                <div class=\"payment-content\">\r\n                                    <i class=\"fas fa-clock\"></i>\r\n                                    <div>\r\n                                        <strong>Pay Later</strong>\r\n                                        <small>Pay upon arrival</small>\r\n                                    </div>\r\n                                </div>\r\n                            </label>\r\n                        </div>\r\n                    </div>\r\n                    \r\n                    <div class=\"form-actions\">\r\n                        <button type=\"submit\" class=\"btn btn-primary btn-lg\">\r\n                            <i class=\"fas fa-check-circle\"></i> Confirm Booking\r\n                        </button>\r\n                        <button type=\"button\" class=\"btn btn-outline\" onclick=\"closeModal()\">\r\n                            Cancel\r\n                        </button>\r\n                    </div>\r\n                </form>\r\n            </div>\r\n        `;\r\n        \r\n        // Set default date to tomorrow\r\n        const dateInput = modal.querySelector('input[name=\"date\"]');\r\n        if (dateInput) {\r\n            const tomorrow = new Date();\r\n            tomorrow.setDate(tomorrow.getDate() + 1);\r\n            dateInput.value = tomorrow.toISOString().split('T')[0];\r\n        }\r\n        \r\n        // Travelers counter functionality\r\n        modal.querySelectorAll('.btn-counter').forEach(button => {\r\n            button.addEventListener('click', function() {\r\n                const action = this.dataset.action;\r\n                const input = this.parentElement.querySelector('input[name=\"travelers\"]');\r\n                let value = parseInt(input.value);\r\n                \r\n                if (action === 'increase' && value < 20) {\r\n                    value++;\r\n                } else if (action === 'decrease' && value > 1) {\r\n                    value--;\r\n                }\r\n                \r\n                input.value = value;\r\n                \r\n                // Update total amount if service has daily rate\r\n                if (serviceDetails?.dailyRate) {\r\n                    const duration = parseInt(modal.querySelector('select[name=\"duration\"]').value);\r\n                    const totalAmount = serviceDetails.dailyRate * duration * value;\r\n                    modal.querySelector('input[name=\"total_amount\"]').value = totalAmount;\r\n                } else if (serviceDetails?.basePrice) {\r\n                    const totalAmount = serviceDetails.basePrice * value;\r\n                    modal.querySelector('input[name=\"total_amount\"]').value = totalAmount;\r\n                }\r\n            });\r\n        });\r\n        \r\n        // Update amount when duration changes\r\n        const durationSelect = modal.querySelector('select[name=\"duration\"]');\r\n        if (durationSelect && (serviceDetails?.dailyRate || serviceDetails?.basePrice)) {\r\n            durationSelect.addEventListener('change', function() {\r\n                const travelers = parseInt(modal.querySelector('input[name=\"travelers\"]').value);\r\n                const duration = parseInt(this.value);\r\n                \r\n                if (serviceDetails.dailyRate) {\r\n                    const totalAmount = serviceDetails.dailyRate * duration * travelers;\r\n                    modal.querySelector('input[name=\"total_amount\"]').value = totalAmount;\r\n                } else if (serviceDetails.basePrice) {\r\n                    const totalAmount = serviceDetails.basePrice * travelers;\r\n                    modal.querySelector('input[name=\"total_amount\"]').value = totalAmount;\r\n                }\r\n            });\r\n        }\r\n        \r\n        // Form submission\r\n        const form = modal.querySelector('#enhanced-booking-form');\r\n        form.addEventListener('submit', async function(e) {\r\n            e.preventDefault();\r\n            \r\n            const formData = new FormData(this);\r\n            const data = Object.fromEntries(formData.entries());\r\n            \r\n            // Add user ID and calculate end date\r\n            data.userId = currentUser._id;\r\n            data.userName = currentUser.name;\r\n            data.userEmail = currentUser.email;\r\n            \r\n            const startDate = new Date(data.date);\r\n            const endDate = new Date(startDate);\r\n            endDate.setDate(endDate.getDate() + parseInt(data.duration));\r\n            data.endDate = endDate.toISOString();\r\n            \r\n            try {\r\n                const booking = userManager.createBooking(data);\r\n                \r\n                // Show success message and generate invoice\r\n                showNotification(`âœ… Booking created successfully! Reference: ${booking._id}`, 'success');\r\n                closeModal();\r\n                \r\n                // Refresh dashboard to show new booking\r\n                setTimeout(() => {\r\n                    if (currentUser.role === 'user') {\r\n                        loadDashboard();\r\n                    } else if (currentUser.role === 'admin') {\r\n                        loadAdminDashboard();\r\n                    }\r\n                }, 500);\r\n                \r\n            } catch (error) {\r\n                showNotification(`âŒ Error creating booking: ${error.message}`, 'error');\r\n            }\r\n        });\r\n    }\r\n\r\n    function createModal() {\r\n        // Remove existing modal\r\n        const existing = document.getElementById('modal-container');\r\n        if (existing) existing.remove();\r\n        \r\n        // Create modal container\r\n        const modalContainer = document.createElement('div');\r\n        modalContainer.id = 'modal-container';\r\n        modalContainer.innerHTML = `\r\n            <div class=\"modal-overlay\"></div>\r\n            <div class=\"modal-content\"></div>\r\n        `;\r\n        \r\n        document.body.appendChild(modalContainer);\r\n        modalContainer.style.display = 'block';\r\n        \r\n        // Add close handlers\r\n        const overlay = modalContainer.querySelector('.modal-overlay');\r\n        overlay.addEventListener('click', closeModal);\r\n        \r\n        // Close on Escape key\r\n        const escapeHandler = (e) => {\r\n            if (e.key === 'Escape') {\r\n                closeModal();\r\n                document.removeEventListener('keydown', escapeHandler);\r\n            }\r\n        };\r\n        document.addEventListener('keydown', escapeHandler);\r\n        \r\n        return modalContainer.querySelector('.modal-content');\r\n    }\r\n\r\n    function closeModal() {\r\n        const modal = document.getElementById('modal-container');\r\n        if (modal) {\r\n            modal.remove();\r\n        }\r\n    }\r\n\r\n    function showTripPlanModal() {\r\n        console.log('Showing trip plan modal');\r\n        const modal = createModal();\r\n        \r\n        modal.innerHTML = `\r\n            <div class=\"modal-header\">\r\n                <h2><i class=\"fas fa-route\"></i> Plan Your Trip</h2>\r\n                <button class=\"modal-close\">&times;</button>\r\n            </div>\r\n            \r\n            <div class=\"modal-body\">\r\n                <form id=\"trip-plan-form\">\r\n                    <div class=\"form-group\">\r\n                        <label>Full Name *</label>\r\n                        <input type=\"text\" name=\"name\" value=\"${currentUser?.name || ''}\" required>\r\n                    </div>\r\n                    \r\n                    <div class=\"form-group\">\r\n                        <label>Email *</label>\r\n                        <input type=\"email\" name=\"email\" value=\"${currentUser?.email || ''}\" required>\r\n                    </div>\r\n                    \r\n                    <div class=\"form-row\">\r\n                        <div class=\"form-group\">\r\n                            <label>Start Date *</label>\r\n                            <input type=\"date\" name=\"start_date\" required>\r\n                        </div>\r\n                        \r\n                        <div class=\"form-group\">\r\n                            <label>Duration *</label>\r\n                            <select name=\"duration\" required>\r\n                                <option value=\"3-5\">3-5 days</option>\r\n                                <option value=\"6-8\">6-8 days</option>\r\n                                <option value=\"9-12\">9-12 days</option>\r\n                                <option value=\"13+\">13+ days</option>\r\n                            </select>\r\n                        </div>\r\n                    </div>\r\n                    \r\n                    <div class=\"form-row\">\r\n                        <div class=\"form-group\">\r\n                            <label>Travelers *</label>\r\n                            <input type=\"number\" name=\"travelers\" min=\"1\" required>\r\n                        </div>\r\n                        \r\n                        <div class=\"form-group\">\r\n                            <label>Budget *</label>\r\n                            <select name=\"budget\" required>\r\n                                <option value=\"budget\">Budget ($500-$1000)</option>\r\n                                <option value=\"midrange\">Mid-range ($1000-$2500)</option>\r\n                                <option value=\"luxury\">Luxury ($2500+)</option>\r\n                            </select>\r\n                        </div>\r\n                    </div>\r\n                    \r\n                    <div class=\"form-group\">\r\n                        <label>Interests</label>\r\n                        <div class=\"checkbox-group\">\r\n                            <label class=\"checkbox\">\r\n                                <input type=\"checkbox\" name=\"interests\" value=\"gorilla\">\r\n                                Gorilla Trekking\r\n                            </label>\r\n                            <label class=\"checkbox\">\r\n                                <input type=\"checkbox\" name=\"interests\" value=\"culture\">\r\n                                Cultural Tours\r\n                            </label>\r\n                            <label class=\"checkbox\">\r\n                                <input type=\"checkbox\" name=\"interests\" value=\"hiking\">\r\n                                Hiking\r\n                            </label>\r\n                            <label class=\"checkbox\">\r\n                                <input type=\"checkbox\" name=\"interests\" value=\"wildlife\">\r\n                                Wildlife Safari\r\n                            </label>\r\n                        </div>\r\n                    </div>\r\n                    \r\n                    <div class=\"form-group\">\r\n                        <label>Additional Information</label>\r\n                        <textarea name=\"message\" rows=\"4\" placeholder=\"Tell us about your dream trip...\"></textarea>\r\n                    </div>\r\n                    \r\n                    <button type=\"submit\" class=\"btn btn-primary btn-block\">Submit Trip Plan</button>\r\n                </form>\r\n            </div>\r\n        `;\r\n        \r\n        // Set default date\r\n        const dateInput = modal.querySelector('input[name=\"start_date\"]');\r\n        if (dateInput) {\r\n            const nextMonth = new Date();\r\n            nextMonth.setMonth(nextMonth.getMonth() + 1);\r\n            dateInput.value = nextMonth.toISOString().split('T')[0];\r\n            dateInput.min = new Date().toISOString().split('T')[0];\r\n        }\r\n        \r\n        // Set default travelers\r\n        modal.querySelector('input[name=\"travelers\"]').value = currentUser?.travelers || 2;\r\n        \r\n        const form = modal.querySelector('#trip-plan-form');\r\n        form.addEventListener('submit', async (e) => {\r\n            e.preventDefault();\r\n            const formData = new FormData(form);\r\n            const data = Object.fromEntries(formData.entries());\r\n            \r\n            // Get interests\r\n            const interests = Array.from(form.querySelectorAll('input[name=\"interests\"]:checked'))\r\n                .map(input => input.value);\r\n            data.interests = interests;\r\n            \r\n            // Add user information\r\n            data.userId = currentUser._id;\r\n            data.userName = currentUser.name;\r\n            data.userEmail = currentUser.email;\r\n            data.status = 'review';\r\n            \r\n            try {\r\n                const tripPlan = userManager.createTripPlan(data);\r\n                \r\n                showNotification(`âœ… Trip plan submitted! Our team will review it and get back to you within 24 hours. Reference: ${tripPlan._id}`, 'success');\r\n                closeModal();\r\n                \r\n                // Refresh dashboard to show new trip plan\r\n                setTimeout(() => {\r\n                    if (currentUser.role === 'user') {\r\n                        loadDashboard();\r\n                    }\r\n                }, 500);\r\n                \r\n            } catch (error) {\r\n                showNotification(`âŒ Error: ${error.message}`, 'error');\r\n            }\r\n        });\r\n        \r\n        modal.querySelector('.modal-close').addEventListener('click', closeModal);\r\n    }\r\n\r\n    function showAddUserModal() {\r\n        const modal = createModal();\r\n        \r\n        modal.innerHTML = `\r\n            <div class=\"modal-header\">\r\n                <h2><i class=\"fas fa-user-plus\"></i> Add New User</h2>\r\n                <button class=\"modal-close\">&times;</button>\r\n            </div>\r\n            \r\n            <div class=\"modal-body\">\r\n                <form id=\"add-user-form\">\r\n                    <div class=\"form-section\">\r\n                        <h4>Basic Information</h4>\r\n                        <div class=\"form-row\">\r\n                            <div class=\"form-group\">\r\n                                <label>Full Name *</label>\r\n                                <input type=\"text\" name=\"name\" required>\r\n                            </div>\r\n                            <div class=\"form-group\">\r\n                                <label>Email *</label>\r\n                                <input type=\"email\" name=\"email\" required>\r\n                            </div>\r\n                        </div>\r\n                        \r\n                        <div class=\"form-row\">\r\n                            <div class=\"form-group\">\r\n                                <label>Password *</label>\r\n                                <input type=\"password\" name=\"password\" required minlength=\"6\">\r\n                            </div>\r\n                            <div class=\"form-group\">\r\n                                <label>Confirm Password *</label>\r\n                                <input type=\"password\" name=\"confirm_password\" required minlength=\"6\">\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    \r\n                    <div class=\"form-section\">\r\n                        <h4>Role & Permissions</h4>\r\n                        <div class=\"form-row\">\r\n                            <div class=\"form-group\">\r\n                                <label>User Role *</label>\r\n                                <select name=\"role\" required>\r\n                                    <option value=\"user\">User (Customer)</option>\r\n                                    <option value=\"admin\">Administrator</option>\r\n                                    <option value=\"agent\">Travel Agent</option>\r\n                                    <option value=\"guide\">Tour Guide</option>\r\n                                </select>\r\n                            </div>\r\n                            <div class=\"form-group\">\r\n                                <label>Status</label>\r\n                                <select name=\"status\">\r\n                                    <option value=\"active\">Active</option>\r\n                                    <option value=\"inactive\">Inactive</option>\r\n                                    <option value=\"pending\">Pending</option>\r\n                                </select>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    \r\n                    <div class=\"form-section\">\r\n                        <h4>Contact Information</h4>\r\n                        <div class=\"form-row\">\r\n                            <div class=\"form-group\">\r\n                                <label>Phone Number</label>\r\n                                <input type=\"tel\" name=\"phone\">\r\n                            </div>\r\n                            <div class=\"form-group\">\r\n                                <label>Country</label>\r\n                                <input type=\"text\" name=\"country\">\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    \r\n                    <div class=\"form-actions\">\r\n                        <button type=\"submit\" class=\"btn btn-success\">\r\n                            <i class=\"fas fa-save\"></i> Create User\r\n                        </button>\r\n                        <button type=\"button\" class=\"btn btn-outline\" onclick=\"closeModal()\">\r\n                            Cancel\r\n                        </button>\r\n                    </div>\r\n                </form>\r\n            </div>\r\n        `;\r\n        \r\n        const form = modal.querySelector('#add-user-form');\r\n        form.addEventListener('submit', function(e) {\r\n            e.preventDefault();\r\n            \r\n            const formData = new FormData(this);\r\n            const data = Object.fromEntries(formData.entries());\r\n            \r\n            // Validate passwords match\r\n            if (data.password !== data.confirm_password) {\r\n                showNotification('âŒ Passwords do not match', 'error');\r\n                return;\r\n            }\r\n            \r\n            try {\r\n                const newUser = userManager.registerUser(data);\r\n                showNotification(`âœ… User ${newUser.name} created successfully!`, 'success');\r\n                closeModal();\r\n                \r\n                // Refresh admin dashboard\r\n                setTimeout(() => {\r\n                    loadAdminDashboard();\r\n                }, 500);\r\n                \r\n            } catch (error) {\r\n                showNotification(`âŒ Error creating user: ${error.message}`, 'error');\r\n            }\r\n        });\r\n    }\r\n\r\n    // ===============================\r\n    // FORM HANDLERS\r\n    // ===============================\r\n    \r\n    function setupForms() {\r\n        console.log('Setting up forms...');\r\n        \r\n        // Newsletter form\r\n        const newsletterForm = document.getElementById('newsletter-form');\r\n        if (newsletterForm) {\r\n            newsletterForm.addEventListener('submit', async (e) => {\r\n                e.preventDefault();\r\n                const email = newsletterForm.querySelector('input[type=\"email\"]').value;\r\n                \r\n                if (!validateEmail(email)) {\r\n                    showNotification('Please enter a valid email', 'error');\r\n                    return;\r\n                }\r\n                \r\n                try {\r\n                    const result = await apiRequest(config.endpoints.newsletter, {\r\n                        method: 'POST',\r\n                        body: JSON.stringify({ email })\r\n                    });\r\n                    \r\n                    if (result.success) {\r\n                        showNotification('âœ… Subscribed to newsletter!', 'success');\r\n                        newsletterForm.reset();\r\n                    }\r\n                } catch (error) {\r\n                    showNotification('Subscription failed', 'error');\r\n                }\r\n            });\r\n        }\r\n        \r\n        // Contact form\r\n        const contactForm = document.getElementById('contact-form');\r\n        if (contactForm) {\r\n            contactForm.addEventListener('submit', async (e) => {\r\n                e.preventDefault();\r\n                const formData = new FormData(contactForm);\r\n                const data = Object.fromEntries(formData.entries());\r\n                \r\n                try {\r\n                    const result = await apiRequest(config.endpoints.contact, {\r\n                        method: 'POST',\r\n                        body: JSON.stringify(data)\r\n                    });\r\n                    \r\n                    if (result.success) {\r\n                        showNotification('âœ… Message sent!', 'success');\r\n                        contactForm.reset();\r\n                    }\r\n                } catch (error) {\r\n                    showNotification('Failed to send message', 'error');\r\n                }\r\n            });\r\n        }\r\n        \r\n        // Footer newsletter form\r\n        const footerNewsletterForm = document.querySelector('.footer-newsletter-form');\r\n        if (footerNewsletterForm) {\r\n            footerNewsletterForm.addEventListener('submit', async (e) => {\r\n                e.preventDefault();\r\n                const email = footerNewsletterForm.querySelector('input[type=\"email\"]').value;\r\n                \r\n                if (!validateEmail(email)) {\r\n                    showNotification('Please enter a valid email', 'error');\r\n                    return;\r\n                }\r\n                \r\n                try {\r\n                    const result = await apiRequest(config.endpoints.newsletter, {\r\n                        method: 'POST',\r\n                        body: JSON.stringify({ email })\r\n                    });\r\n                    \r\n                    if (result.success) {\r\n                        showNotification('âœ… Subscribed to newsletter!', 'success');\r\n                        footerNewsletterForm.reset();\r\n                    }\r\n                } catch (error) {\r\n                    showNotification('Subscription failed', 'error');\r\n                }\r\n            });\r\n        }\r\n    }\r\n\r\n    // ===============================\r\n    // EVENT HANDLERS\r\n    // ===============================\r\n    \r\n    function setupEventListeners() {\r\n        console.log('Setting up event listeners...');\r\n        \r\n        // Main navigation links\r\n        document.addEventListener('click', (e) => {\r\n            // Handle navbar links\r\n            if (e.target.matches('.nav-link[data-page]') || e.target.closest('.nav-link[data-page]')) {\r\n                e.preventDefault();\r\n                const link = e.target.matches('.nav-link[data-page]') ? e.target : e.target.closest('.nav-link[data-page]');\r\n                const pageId = link.dataset.page;\r\n                handlePageNavigation(pageId);\r\n            }\r\n            \r\n            // Handle footer links\r\n            if (e.target.matches('footer a[data-page]') || e.target.closest('footer a[data-page]')) {\r\n                e.preventDefault();\r\n                const link = e.target.matches('footer a[data-page]') ? e.target : e.target.closest('footer a[data-page]');\r\n                const pageId = link.dataset.page;\r\n                handlePageNavigation(pageId);\r\n            }\r\n            \r\n            // Handle read more links\r\n            if (e.target.matches('.read-more-link[data-page]') || e.target.closest('.read-more-link[data-page]')) {\r\n                e.preventDefault();\r\n                const link = e.target.matches('.read-more-link[data-page]') ? e.target : e.target.closest('.read-more-link[data-page]');\r\n                const pageId = link.dataset.page;\r\n                handlePageNavigation(pageId);\r\n            }\r\n            \r\n            // Handle booking buttons\r\n            if (e.target.matches('.book-now') || e.target.closest('.book-now')) {\r\n                e.preventDefault();\r\n                const button = e.target.matches('.book-now') ? e.target : e.target.closest('.book-now');\r\n                const type = button.dataset.type;\r\n                const id = button.dataset.id;\r\n                const name = button.dataset.name;\r\n                \r\n                if (isAuthenticated) {\r\n                    showEnhancedBookingModal(type, id, name);\r\n                } else {\r\n                    showNotification('Please login to book services', 'info');\r\n                    showAuthModal('login');\r\n                }\r\n            }\r\n            \r\n            // Handle plan trip buttons\r\n            if (e.target.matches('.plan-trip-btn') || e.target.closest('.plan-trip-btn')) {\r\n                e.preventDefault();\r\n                if (isAuthenticated) {\r\n                    showTripPlanModal();\r\n                } else {\r\n                    showNotification('Please login to plan a trip', 'info');\r\n                    showAuthModal('login');\r\n                }\r\n            }\r\n            \r\n            // Handle view all links in dashboard\r\n            if (e.target.matches('.view-all[data-tab]') || e.target.closest('.view-all[data-tab]')) {\r\n                e.preventDefault();\r\n                const link = e.target.matches('.view-all[data-tab]') ? e.target : e.target.closest('.view-all[data-tab]');\r\n                const tab = link.dataset.tab;\r\n                \r\n                // Switch to the specified tab\r\n                const dashboard = document.getElementById('dashboard');\r\n                if (dashboard) {\r\n                    document.querySelectorAll('.dashboard-tab-link').forEach(l => l.classList.remove('active'));\r\n                    document.querySelectorAll('.dashboard-tab-container').forEach(c => c.classList.remove('active'));\r\n                    \r\n                    document.querySelector(`.dashboard-tab-link[data-tab=\"${tab}\"]`).classList.add('active');\r\n                    document.getElementById(`dashboard-${tab}`).classList.add('active');\r\n                }\r\n            }\r\n        });\r\n        \r\n        // Auth dropdown\r\n        const authToggle = document.getElementById('auth-toggle');\r\n        const authDropdown = document.getElementById('auth-dropdown-menu');\r\n        \r\n        if (authToggle && authDropdown) {\r\n            authToggle.addEventListener('click', (e) => {\r\n                e.stopPropagation();\r\n                authDropdown.classList.toggle('show');\r\n            });\r\n            \r\n            document.addEventListener('click', (e) => {\r\n                if (!authToggle.contains(e.target) && !authDropdown.contains(e.target)) {\r\n                    authDropdown.classList.remove('show');\r\n                }\r\n            });\r\n        }\r\n        \r\n        // Mobile menu\r\n        const mobileMenuBtn = document.querySelector('.mobile-menu-btn');\r\n        const navLinks = document.getElementById('nav-links');\r\n        \r\n        if (mobileMenuBtn && navLinks) {\r\n            mobileMenuBtn.addEventListener('click', () => {\r\n                navLinks.classList.toggle('active');\r\n                mobileMenuBtn.classList.toggle('active');\r\n            });\r\n            \r\n            // Close mobile menu when clicking outside\r\n            document.addEventListener('click', (e) => {\r\n                if (!mobileMenuBtn.contains(e.target) && !navLinks.contains(e.target)) {\r\n                    navLinks.classList.remove('active');\r\n                    mobileMenuBtn.classList.remove('active');\r\n                }\r\n            });\r\n            \r\n            // Close mobile menu when clicking a link\r\n            navLinks.addEventListener('click', (e) => {\r\n                if (e.target.tagName === 'A') {\r\n                    navLinks.classList.remove('active');\r\n                    mobileMenuBtn.classList.remove('active');\r\n                }\r\n            });\r\n        }\r\n        \r\n        // Handle browser back/forward\r\n        window.addEventListener('popstate', () => {\r\n            const hash = window.location.hash.replace('#', '') || 'home';\r\n            showPage(hash, false);\r\n        });\r\n        \r\n        // Handle initial hash\r\n        if (window.location.hash) {\r\n            const hash = window.location.hash.replace('#', '');\r\n            if (hash) {\r\n                setTimeout(() => {\r\n                    showPage(hash, false);\r\n                }, 100);\r\n            }\r\n        }\r\n    }\r\n\r\n    function handlePageNavigation(pageId) {\r\n        console.log('Navigating to:', pageId);\r\n        \r\n        // Authentication checks\r\n        if ((pageId === 'dashboard' || pageId === 'admin') && !isAuthenticated) {\r\n            showNotification('Please login to access this page', 'warning');\r\n            showAuthModal('login');\r\n            return;\r\n        }\r\n        \r\n        if (pageId === 'admin' && currentUser?.role !== 'admin') {\r\n            showNotification('Admin access required', 'error');\r\n            return;\r\n        }\r\n        \r\n        showPage(pageId);\r\n    }\r\n\r\n    // ===============================\r\n    // ADMIN FUNCTIONS\r\n    // ===============================\r\n\r\n    function viewUserDetails(userId) {\r\n        const user = userManager.users.find(u => u._id === userId);\r\n        if (!user) {\r\n            showNotification('User not found', 'error');\r\n            return;\r\n        }\r\n        \r\n        const modal = createModal();\r\n        modal.innerHTML = `\r\n            <div class=\"modal-header\">\r\n                <h2><i class=\"fas fa-user-circle\"></i> User Details</h2>\r\n                <button class=\"modal-close\">&times;</button>\r\n            </div>\r\n            \r\n            <div class=\"modal-body\">\r\n                <div class=\"user-details\">\r\n                    <div class=\"user-header\">\r\n                        <div class=\"user-avatar-large\">\r\n                            <i class=\"fas fa-user-circle\"></i>\r\n                        </div>\r\n                        <div class=\"user-info\">\r\n                            <h3>${user.name}</h3>\r\n                            <p>${user.email}</p>\r\n                            <div class=\"user-badges\">\r\n                                <span class=\"badge badge-${user.role === 'admin' ? 'danger' : 'primary'}\">\r\n                                    ${user.role.toUpperCase()}\r\n                                </span>\r\n                                <span class=\"badge badge-${user.status === 'active' ? 'success' : 'secondary'}\">\r\n                                    ${user.status.toUpperCase()}\r\n                                </span>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    \r\n                    <div class=\"user-details-grid\">\r\n                        <div class=\"detail-item\">\r\n                            <label><i class=\"fas fa-phone\"></i> Phone</label>\r\n                            <p>${user.phone || 'Not provided'}</p>\r\n                        </div>\r\n                        <div class=\"detail-item\">\r\n                            <label><i class=\"fas fa-globe\"></i> Country</label>\r\n                            <p>${user.country || 'Not provided'}</p>\r\n                        </div>\r\n                        <div class=\"detail-item\">\r\n                            <label><i class=\"fas fa-calendar-plus\"></i> Joined</label>\r\n                            <p>${new Date(user.createdAt).toLocaleDateString()}</p>\r\n                        </div>\r\n                        <div class=\"detail-item\">\r\n                            <label><i class=\"fas fa-sign-in-alt\"></i> Last Login</label>\r\n                            <p>${user.lastLogin ? new Date(user.lastLogin).toLocaleDateString() : 'Never'}</p>\r\n                        </div>\r\n                    </div>\r\n                    \r\n                    <div class=\"user-stats\">\r\n                        <h4><i class=\"fas fa-chart-bar\"></i> User Statistics</h4>\r\n                        <div class=\"stats-grid\">\r\n                            <div class=\"stat-card\">\r\n                                <div class=\"stat-number\">\r\n                                    ${userManager.getUserBookings(user._id).length}\r\n                                </div>\r\n                                <div class=\"stat-label\">Total Bookings</div>\r\n                            </div>\r\n                            <div class=\"stat-card\">\r\n                                <div class=\"stat-number\">\r\n                                    $${userManager.getUserBookings(user._id)\r\n                                        .filter(b => b.status === 'confirmed')\r\n                                        .reduce((sum, b) => sum + (b.totalAmount || 0), 0)}\r\n                                </div>\r\n                                <div class=\"stat-label\">Total Spent</div>\r\n                            </div>\r\n                            <div class=\"stat-card\">\r\n                                <div class=\"stat-number\">\r\n                                    ${userManager.tripPlans.filter(t => t.userId === user._id).length}\r\n                                </div>\r\n                                <div class=\"stat-label\">Trip Plans</div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    \r\n                    <div class=\"user-actions\">\r\n                        <button class=\"btn btn-primary\" onclick=\"editUser(${user._id})\">\r\n                            <i class=\"fas fa-edit\"></i> Edit User\r\n                        </button>\r\n                        ${user.role !== 'admin' ? `\r\n                            <button class=\"btn btn-danger\" onclick=\"deleteUserConfirm(${user._id})\">\r\n                                <i class=\"fas fa-trash\"></i> Delete User\r\n                            </button>\r\n                        ` : ''}\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        `;\r\n    }\r\n\r\n    function editUser(userId) {\r\n        const user = userManager.users.find(u => u._id === userId);\r\n        if (!user) {\r\n            showNotification('User not found', 'error');\r\n            return;\r\n        }\r\n        \r\n        const modal = createModal();\r\n        modal.innerHTML = `\r\n            <div class=\"modal-header\">\r\n                <h2><i class=\"fas fa-edit\"></i> Edit User</h2>\r\n                <button class=\"modal-close\">&times;</button>\r\n            </div>\r\n            \r\n            <div class=\"modal-body\">\r\n                <form id=\"edit-user-form\">\r\n                    <input type=\"hidden\" name=\"user_id\" value=\"${user._id}\">\r\n                    \r\n                    <div class=\"form-section\">\r\n                        <h4>Basic Information</h4>\r\n                        <div class=\"form-row\">\r\n                            <div class=\"form-group\">\r\n                                <label>Full Name *</label>\r\n                                <input type=\"text\" name=\"name\" value=\"${user.name}\" required>\r\n                            </div>\r\n                            <div class=\"form-group\">\r\n                                <label>Email *</label>\r\n                                <input type=\"email\" name=\"email\" value=\"${user.email}\" required>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    \r\n                    <div class=\"form-section\">\r\n                        <h4>Role & Status</h4>\r\n                        <div class=\"form-row\">\r\n                            <div class=\"form-group\">\r\n                                <label>User Role *</label>\r\n                                <select name=\"role\" required>\r\n                                    <option value=\"user\" ${user.role === 'user' ? 'selected' : ''}>User (Customer)</option>\r\n                                    <option value=\"admin\" ${user.role === 'admin' ? 'selected' : ''}>Administrator</option>\r\n                                    <option value=\"agent\" ${user.role === 'agent' ? 'selected' : ''}>Travel Agent</option>\r\n                                    <option value=\"guide\" ${user.role === 'guide' ? 'selected' : ''}>Tour Guide</option>\r\n                                </select>\r\n                            </div>\r\n                            <div class=\"form-group\">\r\n                                <label>Status</label>\r\n                                <select name=\"status\">\r\n                                    <option value=\"active\" ${user.status === 'active' ? 'selected' : ''}>Active</option>\r\n                                    <option value=\"inactive\" ${user.status === 'inactive' ? 'selected' : ''}>Inactive</option>\r\n                                    <option value=\"pending\" ${user.status === 'pending' ? 'selected' : ''}>Pending</option>\r\n                                </select>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    \r\n                    <div class=\"form-section\">\r\n                        <h4>Contact Information</h4>\r\n                        <div class=\"form-row\">\r\n                            <div class=\"form-group\">\r\n                                <label>Phone Number</label>\r\n                                <input type=\"tel\" name=\"phone\" value=\"${user.phone || ''}\">\r\n                            </div>\r\n                            <div class=\"form-group\">\r\n                                <label>Country</label>\r\n                                <input type=\"text\" name=\"country\" value=\"${user.country || ''}\">\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    \r\n                    <div class=\"form-section\">\r\n                        <h4>Change Password (Optional)</h4>\r\n                        <div class=\"form-row\">\r\n                            <div class=\"form-group\">\r\n                                <label>New Password</label>\r\n                                <input type=\"password\" name=\"new_password\" minlength=\"6\">\r\n                            </div>\r\n                            <div class=\"form-group\">\r\n                                <label>Confirm Password</label>\r\n                                <input type=\"password\" name=\"confirm_password\" minlength=\"6\">\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    \r\n                    <div class=\"form-actions\">\r\n                        <button type=\"submit\" class=\"btn btn-primary\">\r\n                            <i class=\"fas fa-save\"></i> Save Changes\r\n                        </button>\r\n                        <button type=\"button\" class=\"btn btn-outline\" onclick=\"closeModal()\">\r\n                            Cancel\r\n                        </button>\r\n                    </div>\r\n                </form>\r\n            </div>\r\n        `;\r\n        \r\n        const form = modal.querySelector('#edit-user-form');\r\n        form.addEventListener('submit', function(e) {\r\n            e.preventDefault();\r\n            \r\n            const formData = new FormData(this);\r\n            const data = Object.fromEntries(formData.entries());\r\n            \r\n            // Validate passwords if provided\r\n            if (data.new_password && data.new_password !== data.confirm_password) {\r\n                showNotification('âŒ Passwords do not match', 'error');\r\n                return;\r\n            }\r\n            \r\n            // Prepare update data\r\n            const updateData = {\r\n                name: data.name,\r\n                email: data.email,\r\n                role: data.role,\r\n                status: data.status,\r\n                phone: data.phone,\r\n                country: data.country\r\n            };\r\n            \r\n            // Add password if changed\r\n            if (data.new_password) {\r\n                updateData.password = data.new_password;\r\n            }\r\n            \r\n            try {\r\n                const updatedUser = userManager.updateUser(parseInt(data.user_id), updateData);\r\n                showNotification(`âœ… User ${updatedUser.name} updated successfully!`, 'success');\r\n                closeModal();\r\n                \r\n                // Refresh admin dashboard\r\n                setTimeout(() => {\r\n                    loadAdminDashboard();\r\n                }, 500);\r\n                \r\n            } catch (error) {\r\n                showNotification(`âŒ Error updating user: ${error.message}`, 'error');\r\n            }\r\n        });\r\n    }\r\n\r\n    function deleteUserConfirm(userId) {\r\n        if (!confirm('Are you sure you want to delete this user? This action cannot be undone.')) {\r\n            return;\r\n        }\r\n        \r\n        try {\r\n            const user = userManager.users.find(u => u._id === userId);\r\n            if (!user) {\r\n                showNotification('User not found', 'error');\r\n                return;\r\n            }\r\n            \r\n            if (user.role === 'admin') {\r\n                showNotification('Cannot delete admin users', 'error');\r\n                return;\r\n            }\r\n            \r\n            const success = userManager.deleteUser(userId);\r\n            if (success) {\r\n                showNotification('âœ… User deleted successfully!', 'success');\r\n                closeModal();\r\n                \r\n                // Refresh admin dashboard\r\n                setTimeout(() => {\r\n                    loadAdminDashboard();\r\n                }, 500);\r\n            }\r\n        } catch (error) {\r\n            showNotification(`âŒ Error deleting user: ${error.message}`, 'error');\r\n        }\r\n    }\r\n\r\n    function confirmBooking(bookingId) {\r\n        try {\r\n            const booking = userManager.confirmBooking(bookingId);\r\n            showNotification(`âœ… Booking ${bookingId} confirmed!`, 'success');\r\n            \r\n            // Refresh admin dashboard\r\n            setTimeout(() => {\r\n                loadAdminDashboard();\r\n            }, 500);\r\n        } catch (error) {\r\n            showNotification(`âŒ Error confirming booking: ${error.message}`, 'error');\r\n        }\r\n    }\r\n\r\n    function viewBookingDetails(bookingId) {\r\n        const booking = userManager.bookings.find(b => b._id === bookingId);\r\n        if (!booking) {\r\n            showNotification('Booking not found', 'error');\r\n            return;\r\n        }\r\n        \r\n        const modal = createModal();\r\n        modal.innerHTML = `\r\n            <div class=\"modal-header\">\r\n                <h2><i class=\"fas fa-calendar-check\"></i> Booking Details</h2>\r\n                <button class=\"modal-close\">&times;</button>\r\n            </div>\r\n            \r\n            <div class=\"modal-body\">\r\n                <div class=\"booking-details\">\r\n                    <div class=\"booking-header\">\r\n                        <div class=\"booking-id\">\r\n                            <h3>${booking._id}</h3>\r\n                            <span class=\"badge badge-${booking.status}\">${booking.status.toUpperCase()}</span>\r\n                        </div>\r\n                        <div class=\"booking-date\">\r\n                            <small>Created: ${new Date(booking.createdAt).toLocaleDateString()}</small>\r\n                        </div>\r\n                    </div>\r\n                    \r\n                    <div class=\"booking-info-grid\">\r\n                        <div class=\"info-section\">\r\n                            <h4><i class=\"fas fa-info-circle\"></i> Service Details</h4>\r\n                            <div class=\"info-item\">\r\n                                <label>Service Type</label>\r\n                                <p>${booking.serviceType}</p>\r\n                            </div>\r\n                            <div class=\"info-item\">\r\n                                <label>Service Name</label>\r\n                                <p>${booking.serviceName}</p>\r\n                            </div>\r\n                            <div class=\"info-item\">\r\n                                <label>Service ID</label>\r\n                                <p>${booking.serviceId || 'N/A'}</p>\r\n                            </div>\r\n                        </div>\r\n                        \r\n                        <div class=\"info-section\">\r\n                            <h4><i class=\"fas fa-user\"></i> Customer Details</h4>\r\n                            <div class=\"info-item\">\r\n                                <label>Customer Name</label>\r\n                                <p>${booking.userName}</p>\r\n                            </div>\r\n                            <div class=\"info-item\">\r\n                                <label>Email</label>\r\n                                <p>${booking.userEmail}</p>\r\n                            </div>\r\n                            <div class=\"info-item\">\r\n                                <label>Phone</label>\r\n                                <p>${booking.phone || 'N/A'}</p>\r\n                            </div>\r\n                        </div>\r\n                        \r\n                        <div class=\"info-section\">\r\n                            <h4><i class=\"fas fa-calendar-alt\"></i> Booking Dates</h4>\r\n                            <div class=\"info-item\">\r\n                                <label>Start Date</label>\r\n                                <p>${new Date(booking.date).toLocaleDateString()}</p>\r\n                            </div>\r\n                            <div class=\"info-item\">\r\n                                <label>Duration</label>\r\n                                <p>${booking.duration || 1} days</p>\r\n                            </div>\r\n                            <div class=\"info-item\">\r\n                                <label>End Date</label>\r\n                                <p>${booking.endDate ? new Date(booking.endDate).toLocaleDateString() : 'N/A'}</p>\r\n                            </div>\r\n                        </div>\r\n                        \r\n                        <div class=\"info-section\">\r\n                            <h4><i class=\"fas fa-file-invoice-dollar\"></i> Payment Details</h4>\r\n                            <div class=\"info-item\">\r\n                                <label>Total Amount</label>\r\n                                <p class=\"amount\">$${booking.totalAmount || '0'}</p>\r\n                            </div>\r\n                            <div class=\"info-item\">\r\n                                <label>Payment Method</label>\r\n                                <p>${booking.payment_method || 'Not specified'}</p>\r\n                            </div>\r\n                            <div class=\"info-item\">\r\n                                <label>Travelers</label>\r\n                                <p>${booking.travelers || 1} person(s)</p>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    \r\n                    ${booking.notes ? `\r\n                        <div class=\"info-section\">\r\n                            <h4><i class=\"fas fa-comment\"></i> Special Requirements</h4>\r\n                            <div class=\"notes-container\">\r\n                                <p>${booking.notes}</p>\r\n                            </div>\r\n                        </div>\r\n                    ` : ''}\r\n                    \r\n                    <div class=\"booking-actions\">\r\n                        <button class=\"btn btn-primary\" onclick=\"downloadBookingInvoice('${booking._id}')\">\r\n                            <i class=\"fas fa-download\"></i> Download Invoice\r\n                        </button>\r\n                        ${currentUser.role === 'admin' && booking.status === 'pending' ? `\r\n                            <button class=\"btn btn-success\" onclick=\"confirmBooking('${booking._id}')\">\r\n                                <i class=\"fas fa-check\"></i> Confirm Booking\r\n                            </button>\r\n                            <button class=\"btn btn-danger\" onclick=\"cancelBookingAdmin('${booking._id}')\">\r\n                                <i class=\"fas fa-times\"></i> Cancel Booking\r\n                            </button>\r\n                        ` : ''}\r\n                        ${currentUser.role === 'user' && booking.status === 'pending' ? `\r\n                            <button class=\"btn btn-danger\" onclick=\"cancelBooking('${booking._id}')\">\r\n                                <i class=\"fas fa-times\"></i> Cancel Booking\r\n                            </button>\r\n                        ` : ''}\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        `;\r\n    }\r\n\r\n    function downloadBookingInvoice(bookingId) {\r\n        const booking = userManager.bookings.find(b => b._id === bookingId);\r\n        if (!booking) {\r\n            showNotification('Booking not found', 'error');\r\n            return;\r\n        }\r\n        \r\n        // Create invoice HTML\r\n        const invoiceHTML = `\r\n            <!DOCTYPE html>\r\n            <html>\r\n            <head>\r\n                <title>Invoice ${booking._id}</title>\r\n                <style>\r\n                    body { font-family: Arial, sans-serif; margin: 40px; }\r\n                    .invoice-header { border-bottom: 2px solid #333; padding-bottom: 20px; margin-bottom: 30px; }\r\n                    .invoice-details { margin: 20px 0; }\r\n                    .invoice-table { width: 100%; border-collapse: collapse; margin: 20px 0; }\r\n                    .invoice-table th, .invoice-table td { border: 1px solid #ddd; padding: 10px; text-align: left; }\r\n                    .invoice-total { text-align: right; margin-top: 20px; }\r\n                    .footer { margin-top: 50px; font-size: 12px; color: #666; }\r\n                </style>\r\n            </head>\r\n            <body>\r\n                <div class=\"invoice-header\">\r\n                    <h1>GO TRIP RWANDA</h1>\r\n                    <h2>INVOICE</h2>\r\n                    <p><strong>Invoice #:</strong> ${booking._id}</p>\r\n                    <p><strong>Date:</strong> ${new Date().toLocaleDateString()}</p>\r\n                </div>\r\n                \r\n                <div class=\"invoice-details\">\r\n                    <h3>Bill To:</h3>\r\n                    <p>${booking.userName}<br>\r\n                    ${booking.userEmail}<br>\r\n                    ${booking.phone || ''}</p>\r\n                </div>\r\n                \r\n                <table class=\"invoice-table\">\r\n                    <thead>\r\n                        <tr>\r\n                            <th>Description</th>\r\n                            <th>Date</th>\r\n                            <th>Travelers</th>\r\n                            <th>Amount</th>\r\n                        </tr>\r\n                    </thead>\r\n                    <tbody>\r\n                        <tr>\r\n                            <td>${booking.serviceName} (${booking.serviceType})</td>\r\n                            <td>${new Date(booking.date).toLocaleDateString()}</td>\r\n                            <td>${booking.travelers || 1}</td>\r\n                            <td>$${booking.totalAmount || '0'}</td>\r\n                        </tr>\r\n                    </tbody>\r\n                </table>\r\n                \r\n                <div class=\"invoice-total\">\r\n                    <h3>Total Amount: $${booking.totalAmount || '0'}</h3>\r\n                </div>\r\n                \r\n                <div class=\"footer\">\r\n                    <p>Thank you for choosing Go Trip Rwanda!</p>\r\n                    <p>For any queries, contact: info@gotrip.africa | +250 787 407 051</p>\r\n                </div>\r\n            </body>\r\n            </html>\r\n        `;\r\n        \r\n        // Create and download the invoice\r\n        const blob = new Blob([invoiceHTML], { type: 'text/html' });\r\n        const url = URL.createObjectURL(blob);\r\n        const a = document.createElement('a');\r\n        a.href = url;\r\n        a.download = `invoice-${booking._id}.html`;\r\n        document.body.appendChild(a);\r\n        a.click();\r\n        document.body.removeChild(a);\r\n        URL.revokeObjectURL(url);\r\n        \r\n        showNotification('âœ… Invoice downloaded successfully!', 'success');\r\n    }\r\n\r\n    function cancelBooking(bookingId) {\r\n        if (!confirm('Are you sure you want to cancel this booking?')) return;\r\n        \r\n        try {\r\n            const booking = userManager.cancelBooking(bookingId);\r\n            showNotification('âœ… Booking cancelled successfully!', 'success');\r\n            \r\n            // Refresh dashboard\r\n            setTimeout(() => {\r\n                loadDashboard();\r\n            }, 500);\r\n        } catch (error) {\r\n            showNotification('âŒ Error cancelling booking', 'error');\r\n        }\r\n    }\r\n\r\n    function cancelBookingAdmin(bookingId) {\r\n        if (!confirm('Are you sure you want to cancel this booking?')) {\r\n            return;\r\n        }\r\n        \r\n        try {\r\n            const booking = userManager.cancelBooking(bookingId);\r\n            showNotification(`âœ… Booking ${bookingId} cancelled!`, 'success');\r\n            \r\n            // Refresh dashboard\r\n            setTimeout(() => {\r\n                if (currentUser.role === 'admin') {\r\n                    loadAdminDashboard();\r\n                } else {\r\n                    loadDashboard();\r\n                }\r\n            }, 500);\r\n        } catch (error) {\r\n            showNotification(`âŒ Error cancelling booking: ${error.message}`, 'error');\r\n        }\r\n    }\r\n\r\n    function viewTripPlanAdmin(tripId) {\r\n        const trip = userManager.tripPlans.find(t => t._id === tripId);\r\n        if (!trip) {\r\n            showNotification('Trip plan not found', 'error');\r\n            return;\r\n        }\r\n        \r\n        const modal = createModal();\r\n        modal.innerHTML = `\r\n            <div class=\"modal-header\">\r\n                <h2><i class=\"fas fa-route\"></i> Trip Plan Details</h2>\r\n                <button class=\"modal-close\">&times;</button>\r\n            </div>\r\n            \r\n            <div class=\"modal-body\">\r\n                <div class=\"trip-plan-details-admin\">\r\n                    <div class=\"trip-header\">\r\n                        <div class=\"trip-id\">\r\n                            <h3>${trip._id}</h3>\r\n                            <span class=\"badge badge-${trip.status}\">${trip.status.toUpperCase()}</span>\r\n                        </div>\r\n                        <div class=\"trip-date\">\r\n                            <small>Requested: ${new Date(trip.createdAt).toLocaleDateString()}</small>\r\n                        </div>\r\n                    </div>\r\n                    \r\n                    <div class=\"trip-info-grid\">\r\n                        <div class=\"info-section\">\r\n                            <h4><i class=\"fas fa-user\"></i> Customer Information</h4>\r\n                            <div class=\"info-item\">\r\n                                <label>Name</label>\r\n                                <p>${trip.userName}</p>\r\n                            </div>\r\n                            <div class=\"info-item\">\r\n                                <label>Email</label>\r\n                                <p>${trip.userEmail}</p>\r\n                            </div>\r\n                            <div class=\"info-item\">\r\n                                <label>Travelers</label>\r\n                                <p>${trip.travelers} people</p>\r\n                            </div>\r\n                        </div>\r\n                        \r\n                        <div class=\"info-section\">\r\n                            <h4><i class=\"fas fa-calendar-alt\"></i> Trip Details</h4>\r\n                            <div class=\"info-item\">\r\n                                <label>Start Date</label>\r\n                                <p>${new Date(trip.startDate).toLocaleDateString()}</p>\r\n                            </div>\r\n                            <div class=\"info-item\">\r\n                                <label>Duration</label>\r\n                                <p>${trip.duration}</p>\r\n                            </div>\r\n                            <div class=\"info-item\">\r\n                                <label>Budget</label>\r\n                                <p>${trip.budget}</p>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    \r\n                    ${trip.interests && trip.interests.length > 0 ? `\r\n                        <div class=\"info-section\">\r\n                            <h4><i class=\"fas fa-heart\"></i> Interests</h4>\r\n                            <div class=\"interests-container\">\r\n                                ${trip.interests.map(interest => `\r\n                                    <span class=\"interest-tag\">${interest}</span>\r\n                                `).join('')}\r\n                            </div>\r\n                        </div>\r\n                    ` : ''}\r\n                    \r\n                    ${trip.message ? `\r\n                        <div class=\"info-section\">\r\n                            <h4><i class=\"fas fa-comment\"></i> Customer Message</h4>\r\n                            <div class=\"message-container\">\r\n                                <p>${trip.message}</p>\r\n                            </div>\r\n                        </div>\r\n                    ` : ''}\r\n                    \r\n                    <div class=\"trip-actions-admin\">\r\n                        ${trip.status === 'review' ? `\r\n                            <button class=\"btn btn-success\" onclick=\"processTripPlan('${trip._id}')\">\r\n                                <i class=\"fas fa-cogs\"></i> Process Trip Plan\r\n                            </button>\r\n                        ` : ''}\r\n                        <button class=\"btn btn-outline\" onclick=\"downloadTripPlan('${trip._id}')\">\r\n                            <i class=\"fas fa-download\"></i> Export\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        `;\r\n    }\r\n\r\n    function processTripPlan(tripId) {\r\n        const trip = userManager.updateTripPlan(tripId, { \r\n            status: 'processing',\r\n            assignedTo: currentUser.name,\r\n            assignedAt: new Date().toISOString()\r\n        });\r\n        \r\n        showNotification(`âœ… Trip plan ${tripId} is now being processed!`, 'success');\r\n        closeModal();\r\n        \r\n        // Refresh admin dashboard\r\n        setTimeout(() => {\r\n            loadAdminDashboard();\r\n        }, 500);\r\n    }\r\n\r\n    function viewTripPlan(tripId) {\r\n        const trip = userManager.tripPlans.find(t => t._id === tripId);\r\n        if (!trip) {\r\n            showNotification('Trip plan not found', 'error');\r\n            return;\r\n        }\r\n        \r\n        const modal = createModal();\r\n        modal.innerHTML = `\r\n            <div class=\"modal-header\">\r\n                <h2><i class=\"fas fa-route\"></i> Trip Plan Details</h2>\r\n                <button class=\"modal-close\">&times;</button>\r\n            </div>\r\n            \r\n            <div class=\"modal-body\">\r\n                <div class=\"trip-plan-details-admin\">\r\n                    <div class=\"trip-header\">\r\n                        <div class=\"trip-id\">\r\n                            <h3>${trip._id}</h3>\r\n                            <span class=\"badge badge-${trip.status}\">${trip.status.toUpperCase()}</span>\r\n                        </div>\r\n                        <div class=\"trip-date\">\r\n                            <small>Requested: ${new Date(trip.createdAt).toLocaleDateString()}</small>\r\n                        </div>\r\n                    </div>\r\n                    \r\n                    <div class=\"trip-info-grid\">\r\n                        <div class=\"info-section\">\r\n                            <h4><i class=\"fas fa-user\"></i> Your Information</h4>\r\n                            <div class=\"info-item\">\r\n                                <label>Name</label>\r\n                                <p>${trip.userName}</p>\r\n                            </div>\r\n                            <div class=\"info-item\">\r\n                                <label>Email</label>\r\n                                <p>${trip.userEmail}</p>\r\n                            </div>\r\n                            <div class=\"info-item\">\r\n                                <label>Travelers</label>\r\n                                <p>${trip.travelers} people</p>\r\n                            </div>\r\n                        </div>\r\n                        \r\n                        <div class=\"info-section\">\r\n                            <h4><i class=\"fas fa-calendar-alt\"></i> Trip Details</h4>\r\n                            <div class=\"info-item\">\r\n                                <label>Start Date</label>\r\n                                <p>${new Date(trip.startDate).toLocaleDateString()}</p>\r\n                            </div>\r\n                            <div class=\"info-item\">\r\n                                <label>Duration</label>\r\n                                <p>${trip.duration}</p>\r\n                            </div>\r\n                            <div class=\"info-item\">\r\n                                <label>Budget</label>\r\n                                <p>${trip.budget}</p>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    \r\n                    ${trip.interests && trip.interests.length > 0 ? `\r\n                        <div class=\"info-section\">\r\n                            <h4><i class=\"fas fa-heart\"></i> Your Interests</h4>\r\n                            <div class=\"interests-container\">\r\n                                ${trip.interests.map(interest => `\r\n                                    <span class=\"interest-tag\">${interest}</span>\r\n                                `).join('')}\r\n                            </div>\r\n                        </div>\r\n                    ` : ''}\r\n                    \r\n                    ${trip.message ? `\r\n                        <div class=\"info-section\">\r\n                            <h4><i class=\"fas fa-comment\"></i> Your Message</h4>\r\n                            <div class=\"message-container\">\r\n                                <p>${trip.message}</p>\r\n                            </div>\r\n                        </div>\r\n                    ` : ''}\r\n                    \r\n                    ${trip.assignedTo ? `\r\n                        <div class=\"info-section\">\r\n                            <h4><i class=\"fas fa-user-tie\"></i> Assigned To</h4>\r\n                            <div class=\"assigned-info\">\r\n                                <p><strong>${trip.assignedTo}</strong></p>\r\n                                <small>Assigned on: ${new Date(trip.assignedAt).toLocaleDateString()}</small>\r\n                            </div>\r\n                        </div>\r\n                    ` : ''}\r\n                    \r\n                    <div class=\"trip-status-info\">\r\n                        <div class=\"status-message\">\r\n                            ${trip.status === 'review' ? `\r\n                                <i class=\"fas fa-clock text-warning\"></i>\r\n                                <div>\r\n                                    <h5>Under Review</h5>\r\n                                    <p>Our team is reviewing your trip plan. We'll contact you within 24 hours.</p>\r\n                                </div>\r\n                            ` : trip.status === 'processing' ? `\r\n                                <i class=\"fas fa-cogs text-info\"></i>\r\n                                <div>\r\n                                    <h5>Processing</h5>\r\n                                    <p>Our travel experts are creating your customized itinerary.</p>\r\n                                </div>\r\n                            ` : trip.status === 'completed' ? `\r\n                                <i class=\"fas fa-check-circle text-success\"></i>\r\n                                <div>\r\n                                    <h5>Completed</h5>\r\n                                    <p>Your trip plan is ready! Check your email for the complete itinerary.</p>\r\n                                </div>\r\n                            ` : ''}\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        `;\r\n    }\r\n\r\n    function editTripPlan(tripId) {\r\n        const trip = userManager.tripPlans.find(t => t._id === tripId);\r\n        if (!trip) {\r\n            showNotification('Trip plan not found', 'error');\r\n            return;\r\n        }\r\n        \r\n        showTripPlanModal();\r\n        // Note: For simplicity, we're just showing the trip plan modal again\r\n        // In a real application, you would populate the form with existing data\r\n    }\r\n\r\n    function cancelTripPlan(tripId) {\r\n        if (!confirm('Are you sure you want to cancel this trip plan?')) return;\r\n        \r\n        try {\r\n            const trip = userManager.updateTripPlan(tripId, { status: 'cancelled' });\r\n            showNotification('âœ… Trip plan cancelled successfully!', 'success');\r\n            \r\n            // Refresh dashboard\r\n            setTimeout(() => {\r\n                loadDashboard();\r\n            }, 500);\r\n        } catch (error) {\r\n            showNotification('âŒ Error cancelling trip plan', 'error');\r\n        }\r\n    }\r\n\r\n    function downloadItinerary(tripId) {\r\n        const trip = userManager.tripPlans.find(t => t._id === tripId);\r\n        if (!trip || !trip.itinerary) {\r\n            showNotification('Itinerary not available yet', 'warning');\r\n            return;\r\n        }\r\n        \r\n        // Create itinerary HTML\r\n        const itineraryHTML = `\r\n            <!DOCTYPE html>\r\n            <html>\r\n            <head>\r\n                <title>Itinerary ${trip._id}</title>\r\n                <style>\r\n                    body { font-family: Arial, sans-serif; margin: 40px; }\r\n                    .header { border-bottom: 2px solid #333; padding-bottom: 20px; margin-bottom: 30px; }\r\n                    .day-section { margin: 30px 0; border-left: 4px solid #4CAF50; padding-left: 20px; }\r\n                    .activity { margin: 15px 0; padding: 10px; background: #f5f5f5; border-radius: 5px; }\r\n                    .footer { margin-top: 50px; font-size: 12px; color: #666; }\r\n                </style>\r\n            </head>\r\n            <body>\r\n                <div class=\"header\">\r\n                    <h1>GO TRIP RWANDA</h1>\r\n                    <h2>TRIP ITINERARY</h2>\r\n                    <p><strong>Trip ID:</strong> ${trip._id}</p>\r\n                    <p><strong>Customer:</strong> ${trip.userName}</p>\r\n                    <p><strong>Duration:</strong> ${trip.duration}</p>\r\n                    <p><strong>Budget:</strong> ${trip.budget}</p>\r\n                </div>\r\n                \r\n                ${trip.itinerary.days.map(day => `\r\n                    <div class=\"day-section\">\r\n                        <h3>Day ${day.day}: ${day.title}</h3>\r\n                        ${day.activities.map(activity => `\r\n                            <div class=\"activity\">\r\n                                <h4>${activity.time}</h4>\r\n                                <p><strong>${activity.description}</strong></p>\r\n                                ${activity.location ? `<p><i>Location:</i> ${activity.location}</p>` : ''}\r\n                            </div>\r\n                        `).join('')}\r\n                    </div>\r\n                `).join('')}\r\n                \r\n                ${trip.itinerary.total_cost ? `\r\n                    <div class=\"cost-summary\">\r\n                        <h3>Cost Summary</h3>\r\n                        <p><strong>Total Cost:</strong> $${trip.itinerary.total_cost.total || 'N/A'}</p>\r\n                    </div>\r\n                ` : ''}\r\n                \r\n                <div class=\"footer\">\r\n                    <p>Thank you for choosing Go Trip Rwanda!</p>\r\n                    <p>For any queries, contact: info@gotrip.africa | +250 787 407 051</p>\r\n                </div>\r\n            </body>\r\n            </html>\r\n        `;\r\n        \r\n        // Create and download the itinerary\r\n        const blob = new Blob([itineraryHTML], { type: 'text/html' });\r\n        const url = URL.createObjectURL(blob);\r\n        const a = document.createElement('a');\r\n        a.href = url;\r\n        a.download = `itinerary-${trip._id}.html`;\r\n        document.body.appendChild(a);\r\n        a.click();\r\n        document.body.removeChild(a);\r\n        URL.revokeObjectURL(url);\r\n        \r\n        showNotification('âœ… Itinerary downloaded successfully!', 'success');\r\n    }\r\n\r\n    function generateReport(type) {\r\n        let reportData;\r\n        let reportTitle;\r\n        \r\n        switch(type) {\r\n            case 'revenue':\r\n                reportData = userManager.getMonthlyRevenue();\r\n                reportTitle = 'Monthly Revenue Report';\r\n                break;\r\n            case 'users':\r\n                reportData = {\r\n                    total: userManager.users.length,\r\n                    byRole: userManager.users.reduce((acc, user) => {\r\n                        acc[user.role] = (acc[user.role] || 0) + 1;\r\n                        return acc;\r\n                    }, {}),\r\n                    active: userManager.users.filter(u => u.status === 'active').length\r\n                };\r\n                reportTitle = 'User Statistics Report';\r\n                break;\r\n            case 'bookings':\r\n                reportData = {\r\n                    total: userManager.bookings.length,\r\n                    byStatus: userManager.bookings.reduce((acc, booking) => {\r\n                        acc[booking.status] = (acc[booking.status] || 0) + 1;\r\n                        return acc;\r\n                    }, {}),\r\n                    byType: userManager.bookings.reduce((acc, booking) => {\r\n                        acc[booking.serviceType] = (acc[booking.serviceType] || 0) + 1;\r\n                        return acc;\r\n                    }, {})\r\n                };\r\n                reportTitle = 'Bookings Analysis Report';\r\n                break;\r\n            case 'full':\r\n                reportData = {\r\n                    stats: userManager.getStats(),\r\n                    monthlyRevenue: userManager.getMonthlyRevenue(),\r\n                    recentActivity: userManager.getRecentActivity(),\r\n                    topUsers: userManager.users.slice(0, 5),\r\n                    topBookings: userManager.bookings.slice(0, 5)\r\n                };\r\n                reportTitle = 'Comprehensive System Report';\r\n                break;\r\n            default:\r\n                reportData = {};\r\n                reportTitle = 'Custom Report';\r\n        }\r\n        \r\n        // Create report HTML\r\n        const reportHTML = `\r\n            <!DOCTYPE html>\r\n            <html>\r\n            <head>\r\n                <title>${reportTitle} - Go Trip</title>\r\n                <style>\r\n                    body { font-family: Arial, sans-serif; margin: 40px; }\r\n                    .report-header { border-bottom: 2px solid #333; padding-bottom: 20px; margin-bottom: 30px; }\r\n                    .report-section { margin: 30px 0; }\r\n                    .report-table { width: 100%; border-collapse: collapse; margin: 20px 0; }\r\n                    .report-table th, .report-table td { border: 1px solid #ddd; padding: 10px; text-align: left; }\r\n                    .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; }\r\n                    .stat-card { background: #f8f9fa; padding: 20px; border-radius: 5px; text-align: center; }\r\n                    .footer { margin-top: 50px; font-size: 12px; color: #666; }\r\n                </style>\r\n            </head>\r\n            <body>\r\n                <div class=\"report-header\">\r\n                    <h1>GO TRIP RWANDA</h1>\r\n                    <h2>${reportTitle}</h2>\r\n                    <p><strong>Generated:</strong> ${new Date().toLocaleString()}</p>\r\n                    <p><strong>Generated by:</strong> ${currentUser.name}</p>\r\n                </div>\r\n                \r\n                ${renderReportContent(type, reportData)}\r\n                \r\n                <div class=\"footer\">\r\n                    <p>This report was generated automatically by the Go Trip system.</p>\r\n                    <p>Â© ${new Date().getFullYear()} Go Trip Rwanda. All rights reserved.</p>\r\n                </div>\r\n            </body>\r\n            </html>\r\n        `;\r\n        \r\n        // Download the report\r\n        const blob = new Blob([reportHTML], { type: 'text/html' });\r\n        const url = URL.createObjectURL(blob);\r\n        const a = document.createElement('a');\r\n        a.href = url;\r\n        a.download = `report-${type}-${Date.now()}.html`;\r\n        document.body.appendChild(a);\r\n        a.click();\r\n        document.body.removeChild(a);\r\n        URL.revokeObjectURL(url);\r\n        \r\n        showNotification(`âœ… ${reportTitle} downloaded successfully!`, 'success');\r\n    }\r\n\r\n    function renderReportContent(type, data) {\r\n        switch(type) {\r\n            case 'revenue':\r\n                return `\r\n                    <div class=\"report-section\">\r\n                        <h3>Revenue Overview</h3>\r\n                        <table class=\"report-table\">\r\n                            <thead>\r\n                                <tr>\r\n                                    <th>Month</th>\r\n                                    <th>Revenue</th>\r\n                                    <th>Change</th>\r\n                                </tr>\r\n                            </thead>\r\n                            <tbody>\r\n                                ${data.map((item, index) => `\r\n                                    <tr>\r\n                                        <td>${item.month}</td>\r\n                                        <td>$${item.revenue.toLocaleString()}</td>\r\n                                        <td>${index > 0 ? \r\n                                            (((item.revenue - data[index-1].revenue) / data[index-1].revenue * 100).toFixed(1) + '%') : \r\n                                            'N/A'}\r\n                                        </td>\r\n                                    </tr>\r\n                                `).join('')}\r\n                            </tbody>\r\n                        </table>\r\n                    </div>\r\n                `;\r\n                \r\n            case 'users':\r\n                return `\r\n                    <div class=\"report-section\">\r\n                        <h3>User Statistics</h3>\r\n                        <div class=\"stats-grid\">\r\n                            <div class=\"stat-card\">\r\n                                <h4>Total Users</h4>\r\n                                <p class=\"stat-number\">${data.total}</p>\r\n                            </div>\r\n                            <div class=\"stat-card\">\r\n                                <h4>Active Users</h4>\r\n                                <p class=\"stat-number\">${data.active}</p>\r\n                            </div>\r\n                            <div class=\"stat-card\">\r\n                                <h4>Inactive Users</h4>\r\n                                <p class=\"stat-number\">${data.total - data.active}</p>\r\n                            </div>\r\n                        </div>\r\n                        \r\n                        <h4>Users by Role</h4>\r\n                        <table class=\"report-table\">\r\n                            <thead>\r\n                                <tr>\r\n                                    <th>Role</th>\r\n                                    <th>Count</th>\r\n                                    <th>Percentage</th>\r\n                                </tr>\r\n                            </thead>\r\n                            <tbody>\r\n                                ${Object.entries(data.byRole).map(([role, count]) => `\r\n                                    <tr>\r\n                                        <td>${role}</td>\r\n                                        <td>${count}</td>\r\n                                        <td>${((count / data.total) * 100).toFixed(1)}%</td>\r\n                                    </tr>\r\n                                `).join('')}\r\n                            </tbody>\r\n                        </table>\r\n                    </div>\r\n                `;\r\n                \r\n            case 'bookings':\r\n                return `\r\n                    <div class=\"report-section\">\r\n                        <h3>Booking Statistics</h3>\r\n                        <div class=\"stats-grid\">\r\n                            <div class=\"stat-card\">\r\n                                <h4>Total Bookings</h4>\r\n                                <p class=\"stat-number\">${data.total}</p>\r\n                            </div>\r\n                        </div>\r\n                        \r\n                        <h4>Bookings by Status</h4>\r\n                        <table class=\"report-table\">\r\n                            <thead>\r\n                                <tr>\r\n                                    <th>Status</th>\r\n                                    <th>Count</th>\r\n                                    <th>Percentage</th>\r\n                                </tr>\r\n                            </thead>\r\n                            <tbody>\r\n                                ${Object.entries(data.byStatus).map(([status, count]) => `\r\n                                    <tr>\r\n                                        <td>${status}</td>\r\n                                        <td>${count}</td>\r\n                                        <td>${((count / data.total) * 100).toFixed(1)}%</td>\r\n                                    </tr>\r\n                                `).join('')}\r\n                            </tbody>\r\n                        </table>\r\n                        \r\n                        <h4>Bookings by Service Type</h4>\r\n                        <table class=\"report-table\">\r\n                            <thead>\r\n                                <tr>\r\n                                    <th>Service Type</th>\r\n                                    <th>Count</th>\r\n                                    <th>Percentage</th>\r\n                                </tr>\r\n                            </thead>\r\n                            <tbody>\r\n                                ${Object.entries(data.byType).map(([type, count]) => `\r\n                                    <tr>\r\n                                        <td>${type}</td>\r\n                                        <td>${count}</td>\r\n                                        <td>${((count / data.total) * 100).toFixed(1)}%</td>\r\n                                    </tr>\r\n                                `).join('')}\r\n                            </tbody>\r\n                        </table>\r\n                    </div>\r\n                `;\r\n                \r\n            case 'full':\r\n                return `\r\n                    <div class=\"report-section\">\r\n                        <h3>System Overview</h3>\r\n                        <div class=\"stats-grid\">\r\n                            <div class=\"stat-card\">\r\n                                <h4>Total Users</h4>\r\n                                <p class=\"stat-number\">${data.stats.totalUsers}</p>\r\n                            </div>\r\n                            <div class=\"stat-card\">\r\n                                <h4>Total Bookings</h4>\r\n                                <p class=\"stat-number\">${data.stats.totalBookings}</p>\r\n                            </div>\r\n                            <div class=\"stat-card\">\r\n                                <h4>Total Revenue</h4>\r\n                                <p class=\"stat-number\">$${data.stats.totalRevenue.toLocaleString()}</p>\r\n                            </div>\r\n                            <div class=\"stat-card\">\r\n                                <h4>Active Bookings</h4>\r\n                                <p class=\"stat-number\">${data.stats.activeBookings}</p>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    \r\n                    <div class=\"report-section\">\r\n                        <h3>Recent Activity</h3>\r\n                        <table class=\"report-table\">\r\n                            <thead>\r\n                                <tr>\r\n                                    <th>Type</th>\r\n                                    <th>User</th>\r\n                                    <th>Action</th>\r\n                                    <th>Time</th>\r\n                                </tr>\r\n                            </thead>\r\n                            <tbody>\r\n                                ${data.recentActivity.slice(0, 10).map(activity => `\r\n                                    <tr>\r\n                                        <td>${activity.type}</td>\r\n                                        <td>${activity.name}</td>\r\n                                        <td>${activity.action}</td>\r\n                                        <td>${formatTimeAgo(activity.timestamp)}</td>\r\n                                    </tr>\r\n                                `).join('')}\r\n                            </tbody>\r\n                        </table>\r\n                    </div>\r\n                    \r\n                    <div class=\"report-section\">\r\n                        <h3>Top Users by Activity</h3>\r\n                        <table class=\"report-table\">\r\n                            <thead>\r\n                                <tr>\r\n                                    <th>User</th>\r\n                                    <th>Role</th>\r\n                                    <th>Status</th>\r\n                                    <th>Joined</th>\r\n                                </tr>\r\n                            </thead>\r\n                            <tbody>\r\n                                ${data.topUsers.map(user => `\r\n                                    <tr>\r\n                                        <td>${user.name}</td>\r\n                                        <td>${user.role}</td>\r\n                                        <td>${user.status}</td>\r\n                                        <td>${new Date(user.createdAt).toLocaleDateString()}</td>\r\n                                    </tr>\r\n                                `).join('')}\r\n                            </tbody>\r\n                        </table>\r\n                    </div>\r\n                `;\r\n                \r\n            default:\r\n                return '<p>No data available for this report type.</p>';\r\n        }\r\n    }\r\n\r\n    function showCustomReportModal() {\r\n        const modal = createModal();\r\n        \r\n        modal.innerHTML = `\r\n            <div class=\"modal-header\">\r\n                <h2><i class=\"fas fa-chart-pie\"></i> Custom Report</h2>\r\n                <button class=\"modal-close\">&times;</button>\r\n            </div>\r\n            \r\n            <div class=\"modal-body\">\r\n                <form id=\"custom-report-form\">\r\n                    <div class=\"form-section\">\r\n                        <h4>Report Parameters</h4>\r\n                        <div class=\"form-row\">\r\n                            <div class=\"form-group\">\r\n                                <label>Report Type</label>\r\n                                <select name=\"report_type\" required>\r\n                                    <option value=\"custom_booking\">Booking Analysis</option>\r\n                                    <option value=\"custom_user\">User Analysis</option>\r\n                                    <option value=\"custom_revenue\">Revenue Analysis</option>\r\n                                </select>\r\n                            </div>\r\n                            <div class=\"form-group\">\r\n                                <label>Date Range</label>\r\n                                <select name=\"date_range\" required>\r\n                                    <option value=\"last_week\">Last Week</option>\r\n                                    <option value=\"last_month\">Last Month</option>\r\n                                    <option value=\"last_quarter\">Last Quarter</option>\r\n                                    <option value=\"last_year\">Last Year</option>\r\n                                    <option value=\"all_time\">All Time</option>\r\n                                </select>\r\n                            </div>\r\n                        </div>\r\n                        \r\n                        <div class=\"form-group\">\r\n                            <label>Include Charts</label>\r\n                            <div class=\"checkbox-group\">\r\n                                <label class=\"checkbox\">\r\n                                    <input type=\"checkbox\" name=\"include_charts\" checked>\r\n                                    Include Charts\r\n                                </label>\r\n                                <label class=\"checkbox\">\r\n                                    <input type=\"checkbox\" name=\"include_tables\" checked>\r\n                                    Include Detailed Tables\r\n                                </label>\r\n                                <label class=\"checkbox\">\r\n                                    <input type=\"checkbox\" name=\"include_summary\">\r\n                                    Include Executive Summary\r\n                                </label>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    \r\n                    <div class=\"form-actions\">\r\n                        <button type=\"submit\" class=\"btn btn-primary\">\r\n                            <i class=\"fas fa-file-export\"></i> Generate Report\r\n                        </button>\r\n                        <button type=\"button\" class=\"btn btn-outline\" onclick=\"closeModal()\">\r\n                            Cancel\r\n                        </button>\r\n                    </div>\r\n                </form>\r\n            </div>\r\n        `;\r\n        \r\n        const form = modal.querySelector('#custom-report-form');\r\n        form.addEventListener('submit', function(e) {\r\n            e.preventDefault();\r\n            const formData = new FormData(this);\r\n            const data = Object.fromEntries(formData.entries());\r\n            \r\n            showNotification('âœ… Custom report generated!', 'success');\r\n            closeModal();\r\n            generateReport('full');\r\n        });\r\n    }\r\n\r\n    function showChangePasswordModal() {\r\n        const modal = createModal();\r\n        \r\n        modal.innerHTML = `\r\n            <div class=\"modal-header\">\r\n                <h2><i class=\"fas fa-key\"></i> Change Password</h2>\r\n                <button class=\"modal-close\">&times;</button>\r\n            </div>\r\n            \r\n            <div class=\"modal-body\">\r\n                <form id=\"change-password-form\">\r\n                    <div class=\"form-group\">\r\n                        <label>Current Password</label>\r\n                        <input type=\"password\" name=\"current_password\" required>\r\n                    </div>\r\n                    \r\n                    <div class=\"form-group\">\r\n                        <label>New Password</label>\r\n                        <input type=\"password\" name=\"new_password\" required minlength=\"6\">\r\n                    </div>\r\n                    \r\n                    <div class=\"form-group\">\r\n                        <label>Confirm New Password</label>\r\n                        <input type=\"password\" name=\"confirm_password\" required minlength=\"6\">\r\n                    </div>\r\n                    \r\n                    <div class=\"form-actions\">\r\n                        <button type=\"submit\" class=\"btn btn-primary\">\r\n                            <i class=\"fas fa-save\"></i> Change Password\r\n                        </button>\r\n                        <button type=\"button\" class=\"btn btn-outline\" onclick=\"closeModal()\">\r\n                            Cancel\r\n                        </button>\r\n                    </div>\r\n                </form>\r\n            </div>\r\n        `;\r\n        \r\n        const form = modal.querySelector('#change-password-form');\r\n        form.addEventListener('submit', function(e) {\r\n            e.preventDefault();\r\n            const formData = new FormData(this);\r\n            const data = Object.fromEntries(formData.entries());\r\n            \r\n            if (data.new_password !== data.confirm_password) {\r\n                showNotification('âŒ New passwords do not match', 'error');\r\n                return;\r\n            }\r\n            \r\n            // In a real app, you would verify current password first\r\n            // For demo, we'll just update it\r\n            try {\r\n                const updatedUser = userManager.updateUser(currentUser._id, { password: data.new_password });\r\n                showNotification('âœ… Password changed successfully!', 'success');\r\n                closeModal();\r\n            } catch (error) {\r\n                showNotification('âŒ Error changing password', 'error');\r\n            }\r\n        });\r\n    }\r\n\r\n    function showUploadDocumentModal() {\r\n        const modal = createModal();\r\n        \r\n        modal.innerHTML = `\r\n            <div class=\"modal-header\">\r\n                <h2><i class=\"fas fa-upload\"></i> Upload Document</h2>\r\n                <button class=\"modal-close\">&times;</button>\r\n            </div>\r\n            \r\n            <div class=\"modal-body\">\r\n                <form id=\"upload-document-form\">\r\n                    <div class=\"form-group\">\r\n                        <label>Document Type</label>\r\n                        <select name=\"document_type\" required>\r\n                            <option value=\"\">Select Document Type</option>\r\n                            <option value=\"passport\">Passport</option>\r\n                            <option value=\"visa\">Visa</option>\r\n                            <option value=\"flight_tickets\">Flight Tickets</option>\r\n                            <option value=\"insurance\">Travel Insurance</option>\r\n                            <option value=\"medical\">Medical Certificate</option>\r\n                            <option value=\"other\">Other</option>\r\n                        </select>\r\n                    </div>\r\n                    \r\n                    <div class=\"form-group\">\r\n                        <label>Document Name</label>\r\n                        <input type=\"text\" name=\"document_name\" placeholder=\"e.g., Passport Copy\" required>\r\n                    </div>\r\n                    \r\n                    <div class=\"form-group\">\r\n                        <label>Expiry Date (if applicable)</label>\r\n                        <input type=\"date\" name=\"expiry_date\">\r\n                    </div>\r\n                    \r\n                    <div class=\"form-group\">\r\n                        <label>Upload File</label>\r\n                        <div class=\"file-upload\">\r\n                            <input type=\"file\" name=\"document_file\" accept=\".pdf,.jpg,.jpeg,.png,.doc,.docx\" required>\r\n                            <div class=\"file-upload-label\">\r\n                                <i class=\"fas fa-cloud-upload-alt\"></i>\r\n                                <span>Click to upload or drag and drop</span>\r\n                                <small>PDF, JPG, PNG, DOC up to 10MB</small>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    \r\n                    <div class=\"form-group\">\r\n                        <label>Notes</label>\r\n                        <textarea name=\"notes\" rows=\"3\" placeholder=\"Any additional notes about this document...\"></textarea>\r\n                    </div>\r\n                    \r\n                    <div class=\"form-actions\">\r\n                        <button type=\"submit\" class=\"btn btn-primary\">\r\n                            <i class=\"fas fa-upload\"></i> Upload Document\r\n                        </button>\r\n                        <button type=\"button\" class=\"btn btn-outline\" onclick=\"closeModal()\">\r\n                            Cancel\r\n                        </button>\r\n                    </div>\r\n                </form>\r\n            </div>\r\n        `;\r\n        \r\n        // File upload styling\r\n        const fileInput = modal.querySelector('input[type=\"file\"]');\r\n        const fileLabel = modal.querySelector('.file-upload-label');\r\n        \r\n        fileInput.addEventListener('change', function() {\r\n            if (this.files.length > 0) {\r\n                fileLabel.innerHTML = `\r\n                    <i class=\"fas fa-file\"></i>\r\n                    <span>${this.files[0].name}</span>\r\n                    <small>${(this.files[0].size / 1024 / 1024).toFixed(2)} MB</small>\r\n                `;\r\n            }\r\n        });\r\n        \r\n        // Form submission\r\n        const form = modal.querySelector('#upload-document-form');\r\n        form.addEventListener('submit', function(e) {\r\n            e.preventDefault();\r\n            // In a real app, you would upload the file to a server\r\n            // For demo, we'll just show a success message\r\n            showNotification('âœ… Document uploaded successfully!', 'success');\r\n            closeModal();\r\n        });\r\n    }\r\n\r\n    function filterBookings(status) {\r\n        const bookings = userManager.getUserBookings(currentUser._id);\r\n        const filteredBookings = status ? \r\n            bookings.filter(b => b.status === status) : \r\n            bookings;\r\n        \r\n        const tableBody = document.getElementById('dashboard-bookings-list');\r\n        if (tableBody) {\r\n            tableBody.innerHTML = renderBookingsTable(filteredBookings);\r\n        }\r\n    }\r\n\r\n    function filterAdminBookings(type) {\r\n        const filteredBookings = type ? \r\n            userManager.bookings.filter(b => b.serviceType === type) : \r\n            userManager.bookings;\r\n        \r\n        const tableBody = document.getElementById('bookings-table-body');\r\n        if (tableBody) {\r\n            tableBody.innerHTML = renderAdminBookingsTable(filteredBookings);\r\n        }\r\n    }\r\n\r\n    function filterAdminTrips(status) {\r\n        const filteredTrips = status ? \r\n            userManager.tripPlans.filter(t => t.status === status) : \r\n            userManager.tripPlans;\r\n        \r\n        const tableBody = document.getElementById('trips-table-body');\r\n        if (tableBody) {\r\n            tableBody.innerHTML = renderAdminTripsTable(filteredTrips);\r\n        }\r\n    }\r\n\r\n    function searchAdminContent(query) {\r\n        if (!query.trim()) {\r\n            // Reset all tables to show all data\r\n            const usersTable = document.getElementById('users-table-body');\r\n            const bookingsTable = document.getElementById('bookings-table-body');\r\n            const tripsTable = document.getElementById('trips-table-body');\r\n            \r\n            if (usersTable) usersTable.innerHTML = renderUsersTable(userManager.users);\r\n            if (bookingsTable) bookingsTable.innerHTML = renderAdminBookingsTable(userManager.bookings);\r\n            if (tripsTable) tripsTable.innerHTML = renderAdminTripsTable(userManager.tripPlans);\r\n            return;\r\n        }\r\n        \r\n        const lowerQuery = query.toLowerCase();\r\n        \r\n        // Search users\r\n        const filteredUsers = userManager.users.filter(user => \r\n            user.name.toLowerCase().includes(lowerQuery) ||\r\n            user.email.toLowerCase().includes(lowerQuery) ||\r\n            user.role.toLowerCase().includes(lowerQuery) ||\r\n            user.country?.toLowerCase().includes(lowerQuery)\r\n        );\r\n        const usersTable = document.getElementById('users-table-body');\r\n        if (usersTable) usersTable.innerHTML = renderUsersTable(filteredUsers);\r\n        \r\n        // Search bookings\r\n        const filteredBookings = userManager.bookings.filter(booking => \r\n            booking._id.toLowerCase().includes(lowerQuery) ||\r\n            booking.userName.toLowerCase().includes(lowerQuery) ||\r\n            booking.userEmail.toLowerCase().includes(lowerQuery) ||\r\n            booking.serviceName.toLowerCase().includes(lowerQuery) ||\r\n            booking.serviceType.toLowerCase().includes(lowerQuery)\r\n        );\r\n        const bookingsTable = document.getElementById('bookings-table-body');\r\n        if (bookingsTable) bookingsTable.innerHTML = renderAdminBookingsTable(filteredBookings);\r\n        \r\n        // Search trip plans\r\n        const filteredTrips = userManager.tripPlans.filter(trip => \r\n            trip._id.toLowerCase().includes(lowerQuery) ||\r\n            trip.userName.toLowerCase().includes(lowerQuery) ||\r\n            trip.userEmail.toLowerCase().includes(lowerQuery) ||\r\n            trip.duration.toLowerCase().includes(lowerQuery) ||\r\n            trip.budget.toLowerCase().includes(lowerQuery)\r\n        );\r\n        const tripsTable = document.getElementById('trips-table-body');\r\n        if (tripsTable) tripsTable.innerHTML = renderAdminTripsTable(filteredTrips);\r\n    }\r\n\r\n    // ===============================\r\n    // INITIALIZATION\r\n    // ===============================\r\n    \r\n    async function init() {\r\n        console.log('Initializing Go Trip Professional System...');\r\n        \r\n        // Hide loading overlay immediately\r\n        const loadingOverlay = document.getElementById('loading-overlay');\r\n        if (loadingOverlay) {\r\n            loadingOverlay.style.opacity = '0';\r\n            setTimeout(() => {\r\n                loadingOverlay.style.display = 'none';\r\n            }, 500);\r\n        }\r\n        \r\n        // Set current year in footer\r\n        const yearElement = document.getElementById('current-year');\r\n        if (yearElement) {\r\n            yearElement.textContent = new Date().getFullYear();\r\n        }\r\n        \r\n        // Check authentication\r\n        await checkAuth();\r\n        \r\n        // Setup event listeners\r\n        setupEventListeners();\r\n        setupForms();\r\n        \r\n        // Load initial page\r\n        const initialPage = window.location.hash ? window.location.hash.replace('#', '') : 'home';\r\n        showPage(initialPage, false);\r\n        \r\n        // Show welcome notification\r\n        setTimeout(() => {\r\n            if (currentUser) {\r\n                showNotification(`Welcome back, ${currentUser.name}!`, 'info');\r\n            } else {\r\n                showNotification('Welcome to Go Trip!', 'info');\r\n            }\r\n        }, 1000);\r\n        \r\n        console.log('Go Trip Professional System initialized successfully');\r\n    }\r\n\r\n    // ===============================\r\n    // EXPORT TO GLOBAL SCOPE\r\n    // ===============================\r\n    \r\n    // Make functions globally available\r\n    window.showPage = showPage;\r\n    window.closeModal = closeModal;\r\n    window.showAuthModal = showAuthModal;\r\n    window.showNotification = showNotification;\r\n    window.logout = logout;\r\n    window.apiRequest = apiRequest;\r\n    window.config = config;\r\n    window.currentUser = () => currentUser;\r\n    window.isAuthenticated = () => isAuthenticated;\r\n    window.showServiceSelectionModal = showServiceSelectionModal;\r\n    window.showEnhancedBookingModal = showEnhancedBookingModal;\r\n    window.showTripPlanModal = showTripPlanModal;\r\n    window.showAddUserModal = showAddUserModal;\r\n    window.viewUserDetails = viewUserDetails;\r\n    window.editUser = editUser;\r\n    window.deleteUserConfirm = deleteUserConfirm;\r\n    window.confirmBooking = confirmBooking;\r\n    window.viewBookingDetails = viewBookingDetails;\r\n    window.downloadBookingInvoice = downloadBookingInvoice;\r\n    window.cancelBooking = cancelBooking;\r\n    window.cancelBookingAdmin = cancelBookingAdmin;\r\n    window.viewTripPlan = viewTripPlan;\r\n    window.viewTripPlanAdmin = viewTripPlanAdmin;\r\n    window.processTripPlan = processTripPlan;\r\n    window.editTripPlan = editTripPlan;\r\n    window.cancelTripPlan = cancelTripPlan;\r\n    window.downloadItinerary = downloadItinerary;\r\n    window.generateReport = generateReport;\r\n    window.showCustomReportModal = showCustomReportModal;\r\n    window.showChangePasswordModal = showChangePasswordModal;\r\n    window.showUploadDocumentModal = showUploadDocumentModal;\r\n    window.userManager = userManager;\r\n\r\n    // Initialize when DOM is ready\r\n    domReady(() => {\r\n        setTimeout(init, 100);\r\n    });\r\n})();"],"mappings":"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CA;AACA;AACA,mFAAmFC,aAAa;AAChG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mFAAmFwF,gBAAgB;AACnG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mFAAmFC,iBAAiB;AACpG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oFAAoFC,UAAU;AAC9F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8CAA8C0C,oBAAoB,CAAC3P,YAAY,CAACwG,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;AAC5F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8CAA8CoJ,qBAAqB,CAAC9C,aAAa,CAACtG,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;AAC9F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sDAAsDqJ,mBAAmB,CAAC7P,YAAY,CAAC;AACvF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8CAA8C8P,eAAe,CAAChD,aAAa,CAAC;AAC5E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wFAAwFzD,WAAW,CAACxI,IAAI;AACxG;AACA;AACA;AACA;AACA,6EAA6EwI,WAAW,CAAC9F,KAAK;AAC9F;AACA;AACA;AACA;AACA;AACA,wFAAwF8F,WAAW,CAAC3F,KAAK,IAAI,EAAE;AAC/G;AACA;AACA;AACA;AACA,2FAA2F2F,WAAW,CAAC1F,OAAO,IAAI,EAAE;AACpH;AACA;AACA;AACA;AACA,oFAAoF0F,WAAW,CAAC0G,OAAO,IAAI,EAAE;AAC7G;AACA;AACA;AACA;AACA,uFAAuF1G,WAAW,CAAC2G,GAAG,IAAI,EAAE;AAC5G;AACA;AACA;AACA;AACA,4FAA4F3G,WAAW,CAAC4G,QAAQ,IAAI,EAAE;AACtH;AACA;AACA;AACA;AACA,0KAA0K5G,WAAW,CAAC6G,WAAW,IAAI,EAAE;AACvM;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;;MAED;MACAC,+BAA+B,CAAC,CAAC;IAErC,CAAC,CAAC,OAAO5E,KAAK,EAAE;MACZG,OAAO,CAACH,KAAK,CAAC,0BAA0B,EAAEA,KAAK,CAAC;MAChDzL,SAAS,CAAC2P,SAAS,GAAG;AAClC;AACA;AACA;AACA;AACA,6BAA6BlE,KAAK,CAAC1G,OAAO;AAC1C;AACA;AACA;AACA;AACA;AACA,aAAa;IACL;EACJ;EAEA,SAAS8K,oBAAoBA,CAACrQ,QAAQ,EAAE;IACpC,IAAIA,QAAQ,CAACgI,MAAM,KAAK,CAAC,EAAE;MACvB,OAAO;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;IACL;IAEA,OAAOhI,QAAQ,CAACmJ,GAAG,CAAChC,OAAO,IAAI;AACvC;AACA;AACA;AACA,6DAA6DA,OAAO,CAACxC,WAAW;AAChF,8BAA8BwC,OAAO,CAACxC,WAAW;AACjD;AACA;AACA,6EAA6EwC,OAAO,CAAC3C,MAAM;AAC3F,0BAA0B2C,OAAO,CAAC3C,MAAM,CAAC4L,WAAW,CAAC,CAAC;AACtD;AACA;AACA;AACA,sDAAsDjJ,OAAO,CAAC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A;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uEAAuEhD,KAAK,CAACpF,UAAU;AACvF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uEAAuEoF,KAAK,CAAClF,aAAa;AAC1F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wEAAwEkF,KAAK,CAAC/E,YAAY,CAACgL,cAAc,CAAC,CAAC;AAC3G;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uEAAuEjG,KAAK,CAACjF,cAAc;AAC3F;AACA,0CAA0CiF,KAAK,CAAC5E,gBAAgB;AAChE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8CAA8C8K,kBAAkB,CAAC5K,cAAc,CAAC;AAChF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8CAA8C6K,oBAAoB,CAAClG,cAAc,CAAC;AAClF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8CAA8CmG,iBAAiB,CAAClG,WAAW,CAAC;AAC5E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8CAA8CmG,yBAAyB,CAACjG,cAAc,CAAC;AACvF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sDAAsDkG,gBAAgB,CAAC5J,WAAW,CAACtG,KAAK,CAAC;AACzF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sDAAsDmQ,wBAAwB,CAAC7J,WAAW,CAAC7J,QAAQ,CAAC;AACpG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sDAAsD2T,qBAAqB,CAAC9J,WAAW,CAACnG,SAAS,CAAC;AAClG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8DAA8DrC,QAAQ,CAAClB,MAAM,CAACgJ,GAAG,CAACyK,KAAK,IAAI;AAC3F;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0FAA0FA,KAAK,CAACrS,IAAI;AACpG,yFAAyFqS,KAAK,CAAClS,UAAU;AACzG;AACA;AACA;AACA,0EAA0EkS,KAAK,CAACpS,SAAS;AACzF,0EAA0EoS,KAAK,CAACnS,SAAS,CAACyF,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC6J,IAAI,CAAC,IAAI,CAAC,GAAG6C,KAAK,CAACnS,SAAS,CAACuG,MAAM,GAAG,CAAC,GAAG,KAAK,GAAG,EAAE;AAC1J,0EAA0E4L,KAAK,CAAChS,KAAK;AACrF;AACA,mGAAmGgS,KAAK,CAAC1R,SAAS,GAAG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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}